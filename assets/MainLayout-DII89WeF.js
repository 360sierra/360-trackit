import{l as tn,m as Nt,n as gt,p as _i,q as sn,t as St,u as Yt,v as ho,x as Bt,y as nn,z as Ft,A as Ri,B as bt,C as nr,D as Zi,E as or,g as wt,G as Vi,H as cs,a as Fi,I as ct,J as _s,r as he,c as w,K as ar,L as rr,w as He,M as lr,N as ds,O as rt,o as Lo,P as ys,Q as bi,h as E,R as qi,S as Xt,U as on,V as ur,W as hr,X as pi,Y as an,Z as rn,_ as ot,$ as Co,a0 as ln,a1 as Gs,a2 as cr,a3 as ls,b as dr,a4 as fr,a5 as wi,a6 as mr,a7 as js,a8 as pr,a9 as Ks,aa as vr,ab as gr,ac as _r,ad as Mo,ae as yr,af as br,ag as wr,ah as kr,ai as Pr,aj as So,ak as Tr,al as Lr,am as xo,an as kt,d as Pt,ao as ae,ap as N,aq as P,ar as ve,f as S,as as je,at as X,au as Io,av as Do,aw as yt,ax as vi,ay as fs,az as ft,aA as Pe,aB as De,aC as Be,aD as ze,aE as Qt,aF as it,aG as Xe,aH as Oe,aI as Je,aJ as _t,aK as Re,F as Ut,aL as ni,aM as Ao,aN as Oo,aO as Hi,aP as Cr,aQ as Mr,aR as Sr,aS as xr,aT as zo,aU as Ir,aV as ms,aW as ps,aX as Rt,k as Dr,aY as Ar,aZ as Or,a_ as zr,a$ as Er,b0 as $r}from"./index-eEZSfwHt.js";import{p as Br}from"./package-DztaWvgK.js";function Rr(t,n){for(var a=0;a<n.length;a++){const u=n[a];if(typeof u!="string"&&!Array.isArray(u)){for(const r in u)if(r!=="default"&&!(r in t)){const h=Object.getOwnPropertyDescriptor(u,r);h&&Object.defineProperty(t,r,h.get?h:{enumerable:!0,get:()=>u[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}const un={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},Fr=Object.keys(un);un.all=!0;function vs(t){const n={};for(const a of Fr)t[a]===!0&&(n[a]=!0);return Object.keys(n).length===0?un:(n.horizontal===!0?n.left=n.right=!0:n.left===!0&&n.right===!0&&(n.horizontal=!0),n.vertical===!0?n.up=n.down=!0:n.up===!0&&n.down===!0&&(n.vertical=!0),n.horizontal===!0&&n.vertical===!0&&(n.all=!0),n)}const qr=["INPUT","TEXTAREA"];function gs(t,n){return n.event===void 0&&t.target!==void 0&&t.target.draggable!==!0&&typeof n.handler=="function"&&qr.includes(t.target.nodeName.toUpperCase())===!1&&(t.qClonedBy===void 0||t.qClonedBy.indexOf(n.uid)===-1)}function Qs(t,n,a){const u=Yt(t);let r,h=u.left-n.event.x,c=u.top-n.event.y,f=Math.abs(h),d=Math.abs(c);const p=n.direction;p.horizontal===!0&&p.vertical!==!0?r=h<0?"left":"right":p.horizontal!==!0&&p.vertical===!0?r=c<0?"up":"down":p.up===!0&&c<0?(r="up",f>d&&(p.left===!0&&h<0?r="left":p.right===!0&&h>0&&(r="right"))):p.down===!0&&c>0?(r="down",f>d&&(p.left===!0&&h<0?r="left":p.right===!0&&h>0&&(r="right"))):p.left===!0&&h<0?(r="left",f<d&&(p.up===!0&&c<0?r="up":p.down===!0&&c>0&&(r="down"))):p.right===!0&&h>0&&(r="right",f<d&&(p.up===!0&&c<0?r="up":p.down===!0&&c>0&&(r="down")));let g=!1;if(r===void 0&&a===!1){if(n.event.isFirst===!0||n.event.lastDir===void 0)return{};r=n.event.lastDir,g=!0,r==="left"||r==="right"?(u.left-=h,f=0,h=0):(u.top-=c,d=0,c=0)}return{synthetic:g,payload:{evt:t,touch:n.event.mouse!==!0,mouse:n.event.mouse===!0,position:u,direction:r,isFirst:n.event.isFirst,isFinal:a===!0,duration:Date.now()-n.event.time,distance:{x:f,y:d},offset:{x:h,y:c},delta:{x:u.left-n.event.lastX,y:u.top-n.event.lastY}}}}let Hr=0;const yi=tn({name:"touch-pan",beforeMount(t,{value:n,modifiers:a}){if(a.mouse!==!0&&gt.has.touch!==!0)return;function u(h,c){a.mouse===!0&&c===!0?Ft(h):(a.stop===!0&&Bt(h),a.prevent===!0&&ho(h))}const r={uid:"qvtp_"+Hr++,handler:n,modifiers:a,direction:vs(a),noop:sn,mouseStart(h){gs(h,r)&&nn(h)&&(St(r,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),r.start(h,!0))},touchStart(h){if(gs(h,r)){const c=h.target;St(r,"temp",[[c,"touchmove","move","notPassiveCapture"],[c,"touchcancel","end","passiveCapture"],[c,"touchend","end","passiveCapture"]]),r.start(h)}},start(h,c){if(gt.is.firefox===!0&&_i(t,!0),r.lastEvt=h,c===!0||a.stop===!0){if(r.direction.all!==!0&&(c!==!0||r.modifiers.mouseAllDir!==!0&&r.modifiers.mousealldir!==!0)){const p=h.type.indexOf("mouse")!==-1?new MouseEvent(h.type,h):new TouchEvent(h.type,h);h.defaultPrevented===!0&&ho(p),h.cancelBubble===!0&&Bt(p),Object.assign(p,{qKeyEvent:h.qKeyEvent,qClickOutside:h.qClickOutside,qAnchorHandled:h.qAnchorHandled,qClonedBy:h.qClonedBy===void 0?[r.uid]:h.qClonedBy.concat(r.uid)}),r.initialEvent={target:h.target,event:p}}Bt(h)}const{left:f,top:d}=Yt(h);r.event={x:f,y:d,time:Date.now(),mouse:c===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:f,lastY:d}},move(h){if(r.event===void 0)return;const c=Yt(h),f=c.left-r.event.x,d=c.top-r.event.y;if(f===0&&d===0)return;r.lastEvt=h;const p=r.event.mouse===!0,g=()=>{u(h,p);let k;a.preserveCursor!==!0&&a.preservecursor!==!0&&(k=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),p===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Ri(),r.styleCleanup=C=>{if(r.styleCleanup=void 0,k!==void 0&&(document.documentElement.style.cursor=k),document.body.classList.remove("non-selectable"),p===!0){const I=()=>{document.body.classList.remove("no-pointer-events--children")};C!==void 0?setTimeout(()=>{I(),C()},50):I()}else C!==void 0&&C()}};if(r.event.detected===!0){r.event.isFirst!==!0&&u(h,r.event.mouse);const{payload:k,synthetic:C}=Qs(h,r,!1);k!==void 0&&(r.handler(k)===!1?r.end(h):(r.styleCleanup===void 0&&r.event.isFirst===!0&&g(),r.event.lastX=k.position.left,r.event.lastY=k.position.top,r.event.lastDir=C===!0?void 0:k.direction,r.event.isFirst=!1));return}if(r.direction.all===!0||p===!0&&(r.modifiers.mouseAllDir===!0||r.modifiers.mousealldir===!0)){g(),r.event.detected=!0,r.move(h);return}const y=Math.abs(f),v=Math.abs(d);y!==v&&(r.direction.horizontal===!0&&y>v||r.direction.vertical===!0&&y<v||r.direction.up===!0&&y<v&&d<0||r.direction.down===!0&&y<v&&d>0||r.direction.left===!0&&y>v&&f<0||r.direction.right===!0&&y>v&&f>0?(r.event.detected=!0,r.move(h)):r.end(h,!0))},end(h,c){if(r.event!==void 0){if(Nt(r,"temp"),gt.is.firefox===!0&&_i(t,!1),c===!0)r.styleCleanup?.(),r.event.detected!==!0&&r.initialEvent!==void 0&&r.initialEvent.target.dispatchEvent(r.initialEvent.event);else if(r.event.detected===!0){r.event.isFirst===!0&&r.handler(Qs(h===void 0?r.lastEvt:h,r).payload);const{payload:f}=Qs(h===void 0?r.lastEvt:h,r,!0),d=()=>{r.handler(f)};r.styleCleanup!==void 0?r.styleCleanup(d):d()}r.event=void 0,r.initialEvent=void 0,r.lastEvt=void 0}}};if(t.__qtouchpan=r,a.mouse===!0){const h=a.mouseCapture===!0||a.mousecapture===!0?"Capture":"";St(r,"main",[[t,"mousedown","mouseStart",`passive${h}`]])}gt.has.touch===!0&&St(r,"main",[[t,"touchstart","touchStart",`passive${a.capture===!0?"Capture":""}`],[t,"touchmove","noop","notPassiveCapture"]])},updated(t,n){const a=t.__qtouchpan;a!==void 0&&(n.oldValue!==n.value&&(typeof value!="function"&&a.end(),a.handler=n.value),a.direction=vs(n.modifiers))},beforeUnmount(t){const n=t.__qtouchpan;n!==void 0&&(n.event!==void 0&&n.end(),Nt(n,"main"),Nt(n,"temp"),gt.is.firefox===!0&&_i(t,!1),n.styleCleanup?.(),delete t.__qtouchpan)}}),co=150,fo=bt({name:"QDrawer",inheritAttrs:!1,props:{...or,...Zi,side:{type:String,default:"left",validator:t=>["left","right"].includes(t)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:t=>["default","desktop","mobile"].includes(t),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...nr,"onLayout","miniState"],setup(t,{slots:n,emit:a,attrs:u}){const r=wt(),{proxy:{$q:h}}=r,c=Vi(t,h),{preventBodyScroll:f}=lr(),{registerTimeout:d,removeTimeout:p}=cs(),g=Fi(_s,ct);if(g===ct)return console.error("QDrawer needs to be child of QLayout"),ct;let y,v=null,k;const C=he(t.behavior==="mobile"||t.behavior!=="desktop"&&g.totalWidth.value<=t.breakpoint),I=w(()=>t.mini===!0&&C.value!==!0),D=w(()=>I.value===!0?t.miniWidth:t.width),A=he(t.showIfAbove===!0&&C.value===!1?!0:t.modelValue===!0),q=w(()=>t.persistent!==!0&&(C.value===!0||Y.value===!0));function z(M,V){if(re(),M!==!1&&g.animate(),j(0),C.value===!0){const me=g.instances[W.value];me?.belowBreakpoint===!0&&me.hide(!1),ie(1),g.isContainer.value!==!0&&f(!0)}else ie(0),M!==!1&&ce(!1);d(()=>{M!==!1&&ce(!0),V!==!0&&a("show",M)},co)}function B(M,V){fe(),M!==!1&&g.animate(),ie(0),j(le.value*D.value),Ee(),V!==!0?d(()=>{a("hide",M)},co):p()}const{show:G,hide:ee}=ar({showing:A,hideOnRouteChange:q,handleShow:z,handleHide:B}),{addToHistory:re,removeFromHistory:fe}=rr(A,ee,q),Le={belowBreakpoint:C,hide:ee},xe=w(()=>t.side==="right"),le=w(()=>(h.lang.rtl===!0?-1:1)*(xe.value===!0?1:-1)),F=he(0),K=he(!1),H=he(!1),J=he(D.value*le.value),W=w(()=>xe.value===!0?"left":"right"),Se=w(()=>A.value===!0&&C.value===!1&&t.overlay===!1?t.miniToOverlay===!0?t.miniWidth:D.value:0),Z=w(()=>t.overlay===!0||t.miniToOverlay===!0||g.view.value.indexOf(xe.value?"R":"L")!==-1||h.platform.is.ios===!0&&g.isContainer.value===!0),Ze=w(()=>t.overlay===!1&&A.value===!0&&C.value===!1),Y=w(()=>t.overlay===!0&&A.value===!0&&C.value===!1),be=w(()=>"fullscreen q-drawer__backdrop"+(A.value===!1&&K.value===!1?" hidden":"")),Ae=w(()=>({backgroundColor:`rgba(0,0,0,${F.value*.4})`})),Fe=w(()=>xe.value===!0?g.rows.value.top[2]==="r":g.rows.value.top[0]==="l"),Ie=w(()=>xe.value===!0?g.rows.value.bottom[2]==="r":g.rows.value.bottom[0]==="l"),_e=w(()=>{const M={};return g.header.space===!0&&Fe.value===!1&&(Z.value===!0?M.top=`${g.header.offset}px`:g.header.space===!0&&(M.top=`${g.header.size}px`)),g.footer.space===!0&&Ie.value===!1&&(Z.value===!0?M.bottom=`${g.footer.offset}px`:g.footer.space===!0&&(M.bottom=`${g.footer.size}px`)),M}),se=w(()=>{const M={width:`${D.value}px`,transform:`translateX(${J.value}px)`};return C.value===!0?M:Object.assign(M,_e.value)}),st=w(()=>"q-drawer__content fit "+(g.isContainer.value!==!0?"scroll":"overflow-auto")),at=w(()=>`q-drawer q-drawer--${t.side}`+(H.value===!0?" q-drawer--mini-animate":"")+(t.bordered===!0?" q-drawer--bordered":"")+(c.value===!0?" q-drawer--dark q-dark":"")+(K.value===!0?" no-transition":A.value===!0?"":" q-layout--prevent-focus")+(C.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${I.value===!0?"mini":"standard"}`+(Z.value===!0||Ze.value!==!0?" fixed":"")+(t.overlay===!0||t.miniToOverlay===!0?" q-drawer--on-top":"")+(Fe.value===!0?" q-drawer--top-padding":""))),xt=w(()=>{const M=h.lang.rtl===!0?t.side:W.value;return[[yi,ue,void 0,{[M]:!0,mouse:!0}]]}),Tt=w(()=>{const M=h.lang.rtl===!0?W.value:t.side;return[[yi,Ve,void 0,{[M]:!0,mouse:!0}]]}),vt=w(()=>{const M=h.lang.rtl===!0?W.value:t.side;return[[yi,Ve,void 0,{[M]:!0,mouse:!0,mouseAllDir:!0}]]});function x(){lt(C,t.behavior==="mobile"||t.behavior!=="desktop"&&g.totalWidth.value<=t.breakpoint)}He(C,M=>{M===!0?(y=A.value,A.value===!0&&ee(!1)):t.overlay===!1&&t.behavior!=="mobile"&&y!==!1&&(A.value===!0?(j(0),ie(0),Ee()):G(!1))}),He(()=>t.side,(M,V)=>{g.instances[V]===Le&&(g.instances[V]=void 0,g[V].space=!1,g[V].offset=0),g.instances[M]=Le,g[M].size=D.value,g[M].space=Ze.value,g[M].offset=Se.value}),He(g.totalWidth,()=>{(g.isContainer.value===!0||document.qScrollPrevented!==!0)&&x()}),He(()=>t.behavior+t.breakpoint,x),He(g.isContainer,M=>{A.value===!0&&f(M!==!0),M===!0&&x()}),He(g.scrollbarWidth,()=>{j(A.value===!0?0:void 0)}),He(Se,M=>{Ue("offset",M)}),He(Ze,M=>{a("onLayout",M),Ue("space",M)}),He(xe,()=>{j()}),He(D,M=>{j(),R(t.miniToOverlay,M)}),He(()=>t.miniToOverlay,M=>{R(M,D.value)}),He(()=>h.lang.rtl,()=>{j()}),He(()=>t.mini,()=>{t.noMiniAnimation||t.modelValue===!0&&(Ne(),g.animate())}),He(I,M=>{a("miniState",M)});function j(M){M===void 0?ds(()=>{M=A.value===!0?0:D.value,j(le.value*M)}):(g.isContainer.value===!0&&xe.value===!0&&(C.value===!0||Math.abs(M)===D.value)&&(M+=le.value*g.scrollbarWidth.value),J.value=M)}function ie(M){F.value=M}function ce(M){const V=M===!0?"remove":g.isContainer.value!==!0?"add":"";V!==""&&document.body.classList[V]("q-body--drawer-toggle")}function Ne(){v!==null&&clearTimeout(v),r.proxy&&r.proxy.$el&&r.proxy.$el.classList.add("q-drawer--mini-animate"),H.value=!0,v=setTimeout(()=>{v=null,H.value=!1,r?.proxy?.$el?.classList.remove("q-drawer--mini-animate")},150)}function ue(M){if(A.value!==!1)return;const V=D.value,me=rt(M.distance.x,0,V);if(M.isFinal===!0){me>=Math.min(75,V)===!0?G():(g.animate(),ie(0),j(le.value*V)),K.value=!1;return}j((h.lang.rtl===!0?xe.value!==!0:xe.value)?Math.max(V-me,0):Math.min(0,me-V)),ie(rt(me/V,0,1)),M.isFirst===!0&&(K.value=!0)}function Ve(M){if(A.value!==!0)return;const V=D.value,me=M.direction===t.side,Ce=(h.lang.rtl===!0?me!==!0:me)?rt(M.distance.x,0,V):0;if(M.isFinal===!0){Math.abs(Ce)<Math.min(75,V)===!0?(g.animate(),ie(1),j(0)):ee(),K.value=!1;return}j(le.value*Ce),ie(rt(1-Ce/V,0,1)),M.isFirst===!0&&(K.value=!0)}function Ee(){f(!1),ce(!0)}function Ue(M,V){g.update(t.side,M,V)}function lt(M,V){M.value!==V&&(M.value=V)}function R(M,V){Ue("size",M===!0?t.miniWidth:V)}return g.instances[t.side]=Le,R(t.miniToOverlay,D.value),Ue("space",Ze.value),Ue("offset",Se.value),t.showIfAbove===!0&&t.modelValue!==!0&&A.value===!0&&t["onUpdate:modelValue"]!==void 0&&a("update:modelValue",!0),Lo(()=>{a("onLayout",Ze.value),a("miniState",I.value),y=t.showIfAbove===!0;const M=()=>{(A.value===!0?z:B)(!1,!0)};if(g.totalWidth.value!==0){ds(M);return}k=He(g.totalWidth,()=>{k(),k=void 0,A.value===!1&&t.showIfAbove===!0&&C.value===!1?G(!1):M()})}),ys(()=>{k?.(),v!==null&&(clearTimeout(v),v=null),A.value===!0&&Ee(),g.instances[t.side]===Le&&(g.instances[t.side]=void 0,Ue("size",0),Ue("offset",0),Ue("space",!1))}),()=>{const M=[];C.value===!0&&(t.noSwipeOpen===!1&&M.push(bi(E("div",{key:"open",class:`q-drawer__opener fixed-${t.side}`,"aria-hidden":"true"}),xt.value)),M.push(qi("div",{ref:"backdrop",class:be.value,style:Ae.value,"aria-hidden":"true",onClick:ee},void 0,"backdrop",t.noSwipeBackdrop!==!0&&A.value===!0,()=>vt.value)));const V=I.value===!0&&n.mini!==void 0,me=[E("div",{...u,key:""+V,class:[st.value,u.class]},V===!0?n.mini():Xt(n.default))];return t.elevated===!0&&A.value===!0&&me.push(E("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),M.push(qi("aside",{ref:"content",class:at.value,style:se.value},me,"contentclose",t.noSwipeClose!==!0&&C.value===!0,()=>Tt.value)),E("div",{class:"q-drawer-container"},M)}}});function Zr(t,n){const a=he(null),u=w(()=>t.disable===!0?null:E("span",{ref:a,class:"no-outline",tabindex:-1}));function r(h){const c=n.value;h?.qAvoidFocus!==!0&&(h?.type.indexOf("key")===0?document.activeElement!==c&&c?.contains(document.activeElement)===!0&&c.focus():a.value!==null&&(h===void 0||c?.contains(h.target)===!0)&&a.value.focus())}return{refocusTargetEl:u,refocusTarget:r}}const Vr={xs:30,sm:35,md:40,lg:50,xl:60},Nr={...Zi,...ur,...on,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:t=>t==="tf"||t==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},Ur=["update:modelValue"];function Wr(t,n){const{props:a,slots:u,emit:r,proxy:h}=wt(),{$q:c}=h,f=Vi(a,c),d=he(null),{refocusTargetEl:p,refocusTarget:g}=Zr(a,d),y=hr(a,Vr),v=w(()=>a.val!==void 0&&Array.isArray(a.modelValue)),k=w(()=>{const F=pi(a.val);return v.value===!0?a.modelValue.findIndex(K=>pi(K)===F):-1}),C=w(()=>v.value===!0?k.value!==-1:pi(a.modelValue)===pi(a.trueValue)),I=w(()=>v.value===!0?k.value===-1:pi(a.modelValue)===pi(a.falseValue)),D=w(()=>C.value===!1&&I.value===!1),A=w(()=>a.disable===!0?-1:a.tabindex||0),q=w(()=>`q-${t} cursor-pointer no-outline row inline no-wrap items-center`+(a.disable===!0?" disabled":"")+(f.value===!0?` q-${t}--dark`:"")+(a.dense===!0?` q-${t}--dense`:"")+(a.leftLabel===!0?" reverse":"")),z=w(()=>{const F=C.value===!0?"truthy":I.value===!0?"falsy":"indet",K=a.color!==void 0&&(a.keepColor===!0||C.value===!0)?` text-${a.color}`:"";return`q-${t}__inner relative-position non-selectable q-${t}__inner--${F}${K}`}),B=w(()=>{const F={type:"checkbox"};return a.name!==void 0&&Object.assign(F,{".checked":C.value,"^checked":C.value===!0?"checked":void 0,name:a.name,value:v.value===!0?a.val:a.trueValue}),F}),G=an(B),ee=w(()=>{const F={tabindex:A.value,role:"switch","aria-label":a.label,"aria-checked":D.value===!0?"mixed":C.value===!0?"true":"false"};return a.disable===!0&&(F["aria-disabled"]="true"),F});function re(F){F!==void 0&&(Ft(F),g(F)),a.disable!==!0&&r("update:modelValue",fe(),F)}function fe(){if(v.value===!0){if(C.value===!0){const F=a.modelValue.slice();return F.splice(k.value,1),F}return a.modelValue.concat([a.val])}if(C.value===!0){if(a.toggleOrder!=="ft"||a.toggleIndeterminate===!1)return a.falseValue}else if(I.value===!0){if(a.toggleOrder==="ft"||a.toggleIndeterminate===!1)return a.trueValue}else return a.toggleOrder!=="ft"?a.trueValue:a.falseValue;return a.indeterminateValue}function Le(F){(F.keyCode===13||F.keyCode===32)&&Ft(F)}function xe(F){(F.keyCode===13||F.keyCode===32)&&re(F)}const le=n(C,D);return Object.assign(h,{toggle:re}),()=>{const F=le();a.disable!==!0&&G(F,"unshift",` q-${t}__native absolute q-ma-none q-pa-none`);const K=[E("div",{class:z.value,style:y.value,"aria-hidden":"true"},F)];p.value!==null&&K.push(p.value);const H=a.label!==void 0?rn(u.default,[a.label]):Xt(u.default);return H!==void 0&&K.push(E("div",{class:`q-${t}__label q-anchor--skip`},H)),E("div",{ref:d,class:q.value,...ee.value,onClick:re,onKeydown:Le,onKeyup:xe},K)}}const us=bt({name:"QToggle",props:{...Nr,icon:String,iconColor:String},emits:Ur,setup(t){function n(a,u){const r=w(()=>(a.value===!0?t.checkedIcon:u.value===!0?t.indeterminateIcon:t.uncheckedIcon)||t.icon),h=w(()=>a.value===!0?t.iconColor:null);return()=>[E("div",{class:"q-toggle__track"}),E("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},r.value!==void 0?[E(ot,{name:r.value,color:h.value})]:void 0)]}return Wr("toggle",n)}}),Gr=bt({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(t,{slots:n}){const{proxy:{$q:a}}=wt(),u=Fi(_s,ct);if(u===ct)return console.error("QPage needs to be a deep child of QLayout"),ct;if(Fi(Co,ct)===ct)return console.error("QPage needs to be child of QPageContainer"),ct;const h=w(()=>{const f=(u.header.space===!0?u.header.size:0)+(u.footer.space===!0?u.footer.size:0);if(typeof t.styleFn=="function"){const d=u.isContainer.value===!0?u.containerHeight.value:a.screen.height;return t.styleFn(f,d)}return{minHeight:u.isContainer.value===!0?u.containerHeight.value-f+"px":a.screen.height===0?f!==0?`calc(100vh - ${f}px)`:"100vh":a.screen.height-f+"px"}}),c=w(()=>`q-page${t.padding===!0?" q-layout-padding":""}`);return()=>E("main",{class:c.value,style:h.value},Xt(n.default))}}),jr=bt({name:"QPageContainer",setup(t,{slots:n}){const{proxy:{$q:a}}=wt(),u=Fi(_s,ct);if(u===ct)return console.error("QPageContainer needs to be child of QLayout"),ct;ln(Co,!0);const r=w(()=>{const h={};return u.header.space===!0&&(h.paddingTop=`${u.header.size}px`),u.right.space===!0&&(h[`padding${a.lang.rtl===!0?"Left":"Right"}`]=`${u.right.size}px`),u.footer.space===!0&&(h.paddingBottom=`${u.footer.size}px`),u.left.space===!0&&(h[`padding${a.lang.rtl===!0?"Right":"Left"}`]=`${u.left.size}px`),h});return()=>E("div",{class:"q-page-container",style:r.value},Xt(n.default))}}),Kr=bt({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:t=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(t.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(t,{slots:n,emit:a}){const{proxy:{$q:u}}=wt(),r=he(null),h=he(u.screen.height),c=he(t.container===!0?0:u.screen.width),f=he({position:0,direction:"down",inflectionPoint:0}),d=he(0),p=he(cr.value===!0?0:Gs()),g=w(()=>"q-layout q-layout--"+(t.container===!0?"containerized":"standard")),y=w(()=>t.container===!1?{minHeight:u.screen.height+"px"}:null),v=w(()=>p.value!==0?{[u.lang.rtl===!0?"left":"right"]:`${p.value}px`}:null),k=w(()=>p.value!==0?{[u.lang.rtl===!0?"right":"left"]:0,[u.lang.rtl===!0?"left":"right"]:`-${p.value}px`,width:`calc(100% + ${p.value}px)`}:null);function C(B){if(t.container===!0||document.qScrollPrevented!==!0){const G={position:B.position.top,direction:B.direction,directionChanged:B.directionChanged,inflectionPoint:B.inflectionPoint.top,delta:B.delta.top};f.value=G,t.onScroll!==void 0&&a("scroll",G)}}function I(B){const{height:G,width:ee}=B;let re=!1;h.value!==G&&(re=!0,h.value=G,t.onScrollHeight!==void 0&&a("scrollHeight",G),A()),c.value!==ee&&(re=!0,c.value=ee),re===!0&&t.onResize!==void 0&&a("resize",B)}function D({height:B}){d.value!==B&&(d.value=B,A())}function A(){if(t.container===!0){const B=h.value>d.value?Gs():0;p.value!==B&&(p.value=B)}}let q=null;const z={instances:{},view:w(()=>t.view),isContainer:w(()=>t.container),rootRef:r,height:h,containerHeight:d,scrollbarWidth:p,totalWidth:w(()=>c.value+p.value),rows:w(()=>{const B=t.view.toLowerCase().split(" ");return{top:B[0].split(""),middle:B[1].split(""),bottom:B[2].split("")}}),header:ls({size:0,offset:0,space:!1}),right:ls({size:300,offset:0,space:!1}),footer:ls({size:0,offset:0,space:!1}),left:ls({size:300,offset:0,space:!1}),scroll:f,animate(){q!==null?clearTimeout(q):document.body.classList.add("q-body--layout-animate"),q=setTimeout(()=>{q=null,document.body.classList.remove("q-body--layout-animate")},155)},update(B,G,ee){z[B][G]=ee}};if(ln(_s,z),Gs()>0){let B=function(){re=null,fe.classList.remove("hide-scrollbar")},G=function(){if(re===null){if(fe.scrollHeight>u.screen.height)return;fe.classList.add("hide-scrollbar")}else clearTimeout(re);re=setTimeout(B,300)},ee=function(Le){re!==null&&Le==="remove"&&(clearTimeout(re),B()),window[`${Le}EventListener`]("resize",G)},re=null;const fe=document.body;He(()=>t.container!==!0?"add":"remove",ee),t.container!==!0&&ee("add"),dr(()=>{ee("remove")})}return()=>{const B=rn(n.default,[E(fr,{onScroll:C}),E(wi,{onResize:I})]),G=E("div",{class:g.value,style:y.value,ref:t.container===!0?void 0:r,tabindex:-1},B);return t.container===!0?E("div",{class:"q-layout-container overflow-hidden",ref:r},[E(wi,{onResize:D}),E("div",{class:"absolute-full",style:v.value},[E("div",{class:"scroll",style:k.value},[G])])]):G}}});function Qr(t){const n=[.06,6,50];return typeof t=="string"&&t.length&&t.split(":").forEach((a,u)=>{const r=parseFloat(a);r&&(n[u]=r)}),n}const Eo=tn({name:"touch-swipe",beforeMount(t,{value:n,arg:a,modifiers:u}){if(u.mouse!==!0&&gt.has.touch!==!0)return;const r=u.mouseCapture===!0?"Capture":"",h={handler:n,sensitivity:Qr(a),direction:vs(u),noop:sn,mouseStart(c){gs(c,h)&&nn(c)&&(St(h,"temp",[[document,"mousemove","move",`notPassive${r}`],[document,"mouseup","end","notPassiveCapture"]]),h.start(c,!0))},touchStart(c){if(gs(c,h)){const f=c.target;St(h,"temp",[[f,"touchmove","move","notPassiveCapture"],[f,"touchcancel","end","notPassiveCapture"],[f,"touchend","end","notPassiveCapture"]]),h.start(c)}},start(c,f){gt.is.firefox===!0&&_i(t,!0);const d=Yt(c);h.event={x:d.left,y:d.top,time:Date.now(),mouse:f===!0,dir:!1}},move(c){if(h.event===void 0)return;if(h.event.dir!==!1){Ft(c);return}const f=Date.now()-h.event.time;if(f===0)return;const d=Yt(c),p=d.left-h.event.x,g=Math.abs(p),y=d.top-h.event.y,v=Math.abs(y);if(h.event.mouse!==!0){if(g<h.sensitivity[1]&&v<h.sensitivity[1]){h.end(c);return}}else if(window.getSelection().toString()!==""){h.end(c);return}else if(g<h.sensitivity[2]&&v<h.sensitivity[2])return;const k=g/f,C=v/f;h.direction.vertical===!0&&g<v&&g<100&&C>h.sensitivity[0]&&(h.event.dir=y<0?"up":"down"),h.direction.horizontal===!0&&g>v&&v<100&&k>h.sensitivity[0]&&(h.event.dir=p<0?"left":"right"),h.direction.up===!0&&g<v&&y<0&&g<100&&C>h.sensitivity[0]&&(h.event.dir="up"),h.direction.down===!0&&g<v&&y>0&&g<100&&C>h.sensitivity[0]&&(h.event.dir="down"),h.direction.left===!0&&g>v&&p<0&&v<100&&k>h.sensitivity[0]&&(h.event.dir="left"),h.direction.right===!0&&g>v&&p>0&&v<100&&k>h.sensitivity[0]&&(h.event.dir="right"),h.event.dir!==!1?(Ft(c),h.event.mouse===!0&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Ri(),h.styleCleanup=I=>{h.styleCleanup=void 0,document.body.classList.remove("non-selectable");const D=()=>{document.body.classList.remove("no-pointer-events--children")};I===!0?setTimeout(D,50):D()}),h.handler({evt:c,touch:h.event.mouse!==!0,mouse:h.event.mouse,direction:h.event.dir,duration:f,distance:{x:g,y:v}})):h.end(c)},end(c){h.event!==void 0&&(Nt(h,"temp"),gt.is.firefox===!0&&_i(t,!1),h.styleCleanup?.(!0),c!==void 0&&h.event.dir!==!1&&Ft(c),h.event=void 0)}};if(t.__qtouchswipe=h,u.mouse===!0){const c=u.mouseCapture===!0||u.mousecapture===!0?"Capture":"";St(h,"main",[[t,"mousedown","mouseStart",`passive${c}`]])}gt.has.touch===!0&&St(h,"main",[[t,"touchstart","touchStart",`passive${u.capture===!0?"Capture":""}`],[t,"touchmove","noop","notPassiveCapture"]])},updated(t,n){const a=t.__qtouchswipe;a!==void 0&&(n.oldValue!==n.value&&(typeof n.value!="function"&&a.end(),a.handler=n.value),a.direction=vs(n.modifiers))},beforeUnmount(t){const n=t.__qtouchswipe;n!==void 0&&(Nt(n,"main"),Nt(n,"temp"),gt.is.firefox===!0&&_i(t,!1),n.styleCleanup?.(),delete t.__qtouchswipe)}}),mo="q-slider__marker-labels",Yr=t=>({value:t}),Xr=({marker:t})=>E("div",{key:t.value,style:t.style,class:t.classes},t.label),hn=[34,37,40,33,39,38],$o={...Zi,...on,min:{type:Number,default:0},max:{type:Number,default:100},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:t=>t>=0},snap:Boolean,vertical:Boolean,reverse:Boolean,color:String,markerLabelsClass:String,label:Boolean,labelColor:String,labelTextColor:String,labelAlways:Boolean,switchLabelSide:Boolean,markers:[Boolean,Number],markerLabels:[Boolean,Array,Object,Function],switchMarkerLabelsSide:Boolean,trackImg:String,trackColor:String,innerTrackImg:String,innerTrackColor:String,selectionColor:String,selectionImg:String,thumbSize:{type:String,default:"20px"},trackSize:{type:String,default:"4px"},disable:Boolean,readonly:Boolean,dense:Boolean,tabindex:[String,Number],thumbColor:String,thumbPath:{type:String,default:"M 4, 10 a 6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"}},Bo=["pan","update:modelValue","change"];function Ro({updateValue:t,updatePosition:n,getDragging:a,formAttrs:u}){const{props:r,emit:h,slots:c,proxy:{$q:f}}=wt(),d=Vi(r,f),p=an(u),g=he(!1),y=he(!1),v=he(!1),k=he(!1),C=w(()=>r.vertical===!0?"--v":"--h"),I=w(()=>"-"+(r.switchLabelSide===!0?"switched":"standard")),D=w(()=>r.vertical===!0?r.reverse===!0:r.reverse!==(f.lang.rtl===!0)),A=w(()=>isNaN(r.innerMin)===!0||r.innerMin<r.min?r.min:r.innerMin),q=w(()=>isNaN(r.innerMax)===!0||r.innerMax>r.max?r.max:r.innerMax),z=w(()=>r.disable!==!0&&r.readonly!==!0&&A.value<q.value),B=w(()=>{if(r.step===0)return oe=>oe;const $=(String(r.step).trim().split(".")[1]||"").length;return oe=>parseFloat(oe.toFixed($))}),G=w(()=>r.step===0?1:r.step),ee=w(()=>z.value===!0?r.tabindex||0:-1),re=w(()=>r.max-r.min),fe=w(()=>q.value-A.value),Le=w(()=>vt(A.value)),xe=w(()=>vt(q.value)),le=w(()=>r.vertical===!0?D.value===!0?"bottom":"top":D.value===!0?"right":"left"),F=w(()=>r.vertical===!0?"height":"width"),K=w(()=>r.vertical===!0?"width":"height"),H=w(()=>r.vertical===!0?"vertical":"horizontal"),J=w(()=>{const $={role:"slider","aria-valuemin":A.value,"aria-valuemax":q.value,"aria-orientation":H.value,"data-step":r.step};return r.disable===!0?$["aria-disabled"]="true":r.readonly===!0&&($["aria-readonly"]="true"),$}),W=w(()=>`q-slider q-slider${C.value} q-slider--${g.value===!0?"":"in"}active inline no-wrap `+(r.vertical===!0?"row":"column")+(r.disable===!0?" disabled":" q-slider--enabled"+(z.value===!0?" q-slider--editable":""))+(v.value==="both"?" q-slider--focus":"")+(r.label||r.labelAlways===!0?" q-slider--label":"")+(r.labelAlways===!0?" q-slider--label-always":"")+(d.value===!0?" q-slider--dark":"")+(r.dense===!0?" q-slider--dense q-slider--dense"+C.value:""));function Se($){const oe="q-slider__"+$;return`${oe} ${oe}${C.value} ${oe}${C.value}${I.value}`}function Z($){const oe="q-slider__"+$;return`${oe} ${oe}${C.value}`}const Ze=w(()=>{const $=r.selectionColor||r.color;return"q-slider__selection absolute"+($!==void 0?` text-${$}`:"")}),Y=w(()=>Z("markers")+" absolute overflow-hidden"),be=w(()=>Z("track-container")),Ae=w(()=>Se("pin")),Fe=w(()=>Se("label")),Ie=w(()=>Se("text-container")),_e=w(()=>Se("marker-labels-container")+(r.markerLabelsClass!==void 0?` ${r.markerLabelsClass}`:"")),se=w(()=>"q-slider__track relative-position no-outline"+(r.trackColor!==void 0?` bg-${r.trackColor}`:"")),st=w(()=>{const $={[K.value]:r.trackSize};return r.trackImg!==void 0&&($.backgroundImage=`url(${r.trackImg}) !important`),$}),at=w(()=>"q-slider__inner absolute"+(r.innerTrackColor!==void 0?` bg-${r.innerTrackColor}`:"")),xt=w(()=>{const $=xe.value-Le.value,oe={[le.value]:`${100*Le.value}%`,[F.value]:$===0?"2px":`${100*$}%`};return r.innerTrackImg!==void 0&&(oe.backgroundImage=`url(${r.innerTrackImg}) !important`),oe});function Tt($){const{min:oe,max:ye,step:qe}=r;let Ge=oe+$*(ye-oe);if(qe>0){const At=(Ge-A.value)%qe;Ge+=(Math.abs(At)>=qe/2?(At<0?-1:1)*qe:0)-At}return Ge=B.value(Ge),rt(Ge,A.value,q.value)}function vt($){return re.value===0?0:($-r.min)/re.value}function x($,oe){const ye=Yt($),qe=r.vertical===!0?rt((ye.top-oe.top)/oe.height,0,1):rt((ye.left-oe.left)/oe.width,0,1);return rt(D.value===!0?1-qe:qe,Le.value,xe.value)}const j=w(()=>mr(r.markers)===!0?r.markers:G.value),ie=w(()=>{const $=[],oe=j.value,ye=r.max;let qe=r.min;do $.push(qe),qe+=oe;while(qe<ye);return $.push(ye),$}),ce=w(()=>{const $=` ${mo}${C.value}-`;return mo+`${$}${r.switchMarkerLabelsSide===!0?"switched":"standard"}${$}${D.value===!0?"rtl":"ltr"}`}),Ne=w(()=>r.markerLabels===!1?null:Ee(r.markerLabels).map(($,oe)=>({index:oe,value:$.value,label:$.label||$.value,classes:ce.value+($.classes!==void 0?" "+$.classes:""),style:{...Ue($.value),...$.style||{}}}))),ue=w(()=>({markerList:Ne.value,markerMap:lt.value,classes:ce.value,getStyle:Ue})),Ve=w(()=>{const $=fe.value===0?"2px":100*j.value/fe.value;return{...xt.value,backgroundSize:r.vertical===!0?`2px ${$}%`:`${$}% 2px`}});function Ee($){if($===!1)return null;if($===!0)return ie.value.map(Yr);if(typeof $=="function")return ie.value.map(ye=>{const qe=$(ye);return js(qe)===!0?{...qe,value:ye}:{value:ye,label:qe}});const oe=({value:ye})=>ye>=r.min&&ye<=r.max;return Array.isArray($)===!0?$.map(ye=>js(ye)===!0?ye:{value:ye}).filter(oe):Object.keys($).map(ye=>{const qe=$[ye],Ge=Number(ye);return js(qe)===!0?{...qe,value:Ge}:{value:Ge,label:qe}}).filter(oe)}function Ue($){return{[le.value]:`${100*($-r.min)/re.value}%`}}const lt=w(()=>{if(r.markerLabels===!1)return null;const $={};return Ne.value.forEach(oe=>{$[oe.value]=oe}),$});function R(){if(c["marker-label-group"]!==void 0)return c["marker-label-group"](ue.value);const $=c["marker-label"]||Xr;return Ne.value.map(oe=>$({marker:oe,...ue.value}))}const M=w(()=>[[yi,V,void 0,{[H.value]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function V($){$.isFinal===!0?(k.value!==void 0&&(n($.evt),$.touch===!0&&t(!0),k.value=void 0,h("pan","end")),g.value=!1,v.value=!1):$.isFirst===!0?(k.value=a($.evt),n($.evt),t(),g.value=!0,h("pan","start")):(n($.evt),t())}function me(){v.value=!1}function Ce($){n($,a($)),t(),y.value=!0,g.value=!0,document.addEventListener("mouseup",we,!0)}function we(){y.value=!1,g.value=!1,t(!0),me(),document.removeEventListener("mouseup",we,!0)}function ke($){n($,a($)),t(!0)}function et($){hn.includes($.keyCode)&&t(!0)}function mt($){if(r.vertical===!0)return null;const oe=f.lang.rtl!==r.reverse?1-$:$;return{transform:`translateX(calc(${2*oe-1} * ${r.thumbSize} / 2 + ${50-100*oe}%))`}}function Wt($){const oe=w(()=>y.value===!1&&(v.value===$.focusValue||v.value==="both")?" q-slider--focus":""),ye=w(()=>`q-slider__thumb q-slider__thumb${C.value} q-slider__thumb${C.value}-${D.value===!0?"rtl":"ltr"} absolute non-selectable`+oe.value+($.thumbColor.value!==void 0?` text-${$.thumbColor.value}`:"")),qe=w(()=>({width:r.thumbSize,height:r.thumbSize,[le.value]:`${100*$.ratio.value}%`,zIndex:v.value===$.focusValue?2:void 0})),Ge=w(()=>$.labelColor.value!==void 0?` text-${$.labelColor.value}`:""),At=w(()=>mt($.ratio.value)),Pi=w(()=>"q-slider__text"+($.labelTextColor.value!==void 0?` text-${$.labelTextColor.value}`:""));return()=>{const oi=[E("svg",{class:"q-slider__thumb-shape absolute-full",viewBox:"0 0 20 20","aria-hidden":"true"},[E("path",{d:r.thumbPath})]),E("div",{class:"q-slider__focus-ring fit"})];return(r.label===!0||r.labelAlways===!0)&&(oi.push(E("div",{class:Ae.value+" absolute fit no-pointer-events"+Ge.value},[E("div",{class:Fe.value,style:{minWidth:r.thumbSize}},[E("div",{class:Ie.value,style:At.value},[E("span",{class:Pi.value},$.label.value)])])])),r.name!==void 0&&r.disable!==!0&&p(oi,"push")),E("div",{class:ye.value,style:qe.value,...$.getNodeData()},oi)}}function ki($,oe,ye,qe){const Ge=[];r.innerTrackColor!=="transparent"&&Ge.push(E("div",{key:"inner",class:at.value,style:xt.value})),r.selectionColor!=="transparent"&&Ge.push(E("div",{key:"selection",class:Ze.value,style:$.value})),r.markers!==!1&&Ge.push(E("div",{key:"marker",class:Y.value,style:Ve.value})),qe(Ge);const At=[qi("div",{key:"trackC",class:be.value,tabindex:oe.value,...ye.value},[E("div",{class:se.value,style:st.value},Ge)],"slide",z.value,()=>M.value)];if(r.markerLabels!==!1){const Pi=r.switchMarkerLabelsSide===!0?"unshift":"push";At[Pi](E("div",{key:"markerL",class:_e.value},R()))}return At}return ys(()=>{document.removeEventListener("mouseup",we,!0)}),{state:{active:g,focus:v,preventFocus:y,dragging:k,editable:z,classes:W,tabindex:ee,attributes:J,roundValueFn:B,keyStep:G,trackLen:re,innerMin:A,innerMinRatio:Le,innerMax:q,innerMaxRatio:xe,positionProp:le,sizeProp:F,isReversed:D},methods:{onActivate:Ce,onMobileClick:ke,onBlur:me,onKeyup:et,getContent:ki,getThumbRenderFn:Wt,convertRatioToModel:Tt,convertModelToRatio:vt,getDraggingRatio:x}}}const Jr=()=>({}),gi=bt({name:"QSlider",props:{...$o,modelValue:{required:!0,default:null,validator:t=>typeof t=="number"||t===null},labelValue:[String,Number]},emits:Bo,setup(t,{emit:n}){const{proxy:{$q:a}}=wt(),{state:u,methods:r}=Ro({updateValue:C,updatePosition:D,getDragging:I,formAttrs:pr(t)}),h=he(null),c=he(0),f=he(0);function d(){f.value=t.modelValue===null?u.innerMin.value:rt(t.modelValue,u.innerMin.value,u.innerMax.value)}He(()=>`${t.modelValue}|${u.innerMin.value}|${u.innerMax.value}`,d),d();const p=w(()=>r.convertModelToRatio(f.value)),g=w(()=>u.active.value===!0?c.value:p.value),y=w(()=>{const z={[u.positionProp.value]:`${100*u.innerMinRatio.value}%`,[u.sizeProp.value]:`${100*(g.value-u.innerMinRatio.value)}%`};return t.selectionImg!==void 0&&(z.backgroundImage=`url(${t.selectionImg}) !important`),z}),v=r.getThumbRenderFn({focusValue:!0,getNodeData:Jr,ratio:g,label:w(()=>t.labelValue!==void 0?t.labelValue:f.value),thumbColor:w(()=>t.thumbColor||t.color),labelColor:w(()=>t.labelColor),labelTextColor:w(()=>t.labelTextColor)}),k=w(()=>u.editable.value!==!0?{}:a.platform.is.mobile===!0?{onClick:r.onMobileClick}:{onMousedown:r.onActivate,onFocus:A,onBlur:r.onBlur,onKeydown:q,onKeyup:r.onKeyup});function C(z){f.value!==t.modelValue&&n("update:modelValue",f.value),z===!0&&n("change",f.value)}function I(){return h.value.getBoundingClientRect()}function D(z,B=u.dragging.value){const G=r.getDraggingRatio(z,B);f.value=r.convertRatioToModel(G),c.value=t.snap!==!0||t.step===0?G:r.convertModelToRatio(f.value)}function A(){u.focus.value=!0}function q(z){if(hn.includes(z.keyCode)===!1)return;Ft(z);const B=([34,33].includes(z.keyCode)?10:1)*u.keyStep.value,G=([34,37,40].includes(z.keyCode)?-1:1)*(u.isReversed.value===!0?-1:1)*(t.vertical===!0?-1:1)*B;f.value=rt(u.roundValueFn.value(f.value+G),u.innerMin.value,u.innerMax.value),C()}return()=>{const z=r.getContent(y,u.tabindex,k,B=>{B.push(v())});return E("div",{ref:h,class:u.classes.value+(t.modelValue===null?" q-slider--no-value":""),...u.attributes.value,"aria-valuenow":t.modelValue},z)}}});function el(t,n,a){const u=a===!0?["left","right"]:["top","bottom"];return`absolute-${n===!0?u[0]:u[1]}${t?` text-${t}`:""}`}const tl=["left","center","right","justify"],po=bt({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:t=>tl.includes(t)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(t,{slots:n,emit:a}){const{proxy:u}=wt(),{$q:r}=u,{registerTick:h}=Ks(),{registerTick:c}=Ks(),{registerTick:f}=Ks(),{registerTimeout:d,removeTimeout:p}=cs(),{registerTimeout:g,removeTimeout:y}=cs(),v=he(null),k=he(null),C=he(t.modelValue),I=he(!1),D=he(!0),A=he(!1),q=he(!1),z=[],B=he(0),G=he(!1);let ee=null,re=null,fe;const Le=w(()=>({activeClass:t.activeClass,activeColor:t.activeColor,activeBgColor:t.activeBgColor,indicatorClass:el(t.indicatorColor,t.switchIndicator,t.vertical),narrowIndicator:t.narrowIndicator,inlineLabel:t.inlineLabel,noCaps:t.noCaps})),xe=w(()=>{const R=B.value,M=C.value;for(let V=0;V<R;V++)if(z[V].name.value===M)return!0;return!1}),le=w(()=>`q-tabs__content--align-${I.value===!0?"left":q.value===!0?"justify":t.align}`),F=w(()=>`q-tabs row no-wrap items-center q-tabs--${I.value===!0?"":"not-"}scrollable q-tabs--${t.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${t.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${t.mobileArrows===!0?"":"out"}-arrows`+(t.dense===!0?" q-tabs--dense":"")+(t.shrink===!0?" col-shrink":"")+(t.stretch===!0?" self-stretch":"")),K=w(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+le.value+(t.contentClass!==void 0?` ${t.contentClass}`:"")),H=w(()=>t.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),J=w(()=>t.vertical!==!0&&r.lang.rtl===!0),W=w(()=>vr===!1&&J.value===!0);He(J,Ae),He(()=>t.modelValue,R=>{Se({name:R,setCurrent:!0,skipEmit:!0})}),He(()=>t.outsideArrows,Z);function Se({name:R,setCurrent:M,skipEmit:V}){C.value!==R&&(V!==!0&&t["onUpdate:modelValue"]!==void 0&&a("update:modelValue",R),(M===!0||t["onUpdate:modelValue"]===void 0)&&(Y(C.value,R),C.value=R))}function Z(){h(()=>{v.value&&Ze({width:v.value.offsetWidth,height:v.value.offsetHeight})})}function Ze(R){if(H.value===void 0||k.value===null)return;const M=R[H.value.container],V=Math.min(k.value[H.value.scroll],Array.prototype.reduce.call(k.value.children,(Ce,we)=>Ce+(we[H.value.content]||0),0)),me=M>0&&V>M;I.value=me,me===!0&&c(Ae),q.value=M<parseInt(t.breakpoint,10)}function Y(R,M){const V=R!=null&&R!==""?z.find(Ce=>Ce.name.value===R):null,me=M!=null&&M!==""?z.find(Ce=>Ce.name.value===M):null;if(lt===!0)lt=!1;else if(V&&me){const Ce=V.tabIndicatorRef.value,we=me.tabIndicatorRef.value;ee!==null&&(clearTimeout(ee),ee=null),Ce.style.transition="none",Ce.style.transform="none",we.style.transition="none",we.style.transform="none";const ke=Ce.getBoundingClientRect(),et=we.getBoundingClientRect();we.style.transform=t.vertical===!0?`translate3d(0,${ke.top-et.top}px,0) scale3d(1,${et.height?ke.height/et.height:1},1)`:`translate3d(${ke.left-et.left}px,0,0) scale3d(${et.width?ke.width/et.width:1},1,1)`,f(()=>{ee=setTimeout(()=>{ee=null,we.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",we.style.transform="none"},70)})}me&&I.value===!0&&be(me.rootRef.value)}function be(R){const{left:M,width:V,top:me,height:Ce}=k.value.getBoundingClientRect(),we=R.getBoundingClientRect();let ke=t.vertical===!0?we.top-me:we.left-M;if(ke<0){k.value[t.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(ke),Ae();return}ke+=t.vertical===!0?we.height-Ce:we.width-V,ke>0&&(k.value[t.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(ke),Ae())}function Ae(){const R=k.value;if(R===null)return;const M=R.getBoundingClientRect(),V=t.vertical===!0?R.scrollTop:Math.abs(R.scrollLeft);J.value===!0?(D.value=Math.ceil(V+M.width)<R.scrollWidth-1,A.value=V>0):(D.value=V>0,A.value=t.vertical===!0?Math.ceil(V+M.height)<R.scrollHeight:Math.ceil(V+M.width)<R.scrollWidth)}function Fe(R){re!==null&&clearInterval(re),re=setInterval(()=>{xt(R)===!0&&se()},5)}function Ie(){Fe(W.value===!0?Number.MAX_SAFE_INTEGER:0)}function _e(){Fe(W.value===!0?0:Number.MAX_SAFE_INTEGER)}function se(){re!==null&&(clearInterval(re),re=null)}function st(R,M){const V=Array.prototype.filter.call(k.value.children,et=>et===M||et.matches&&et.matches(".q-tab.q-focusable")===!0),me=V.length;if(me===0)return;if(R===36)return be(V[0]),V[0].focus(),!0;if(R===35)return be(V[me-1]),V[me-1].focus(),!0;const Ce=R===(t.vertical===!0?38:37),we=R===(t.vertical===!0?40:39),ke=Ce===!0?-1:we===!0?1:void 0;if(ke!==void 0){const et=J.value===!0?-1:1,mt=V.indexOf(M)+ke*et;return mt>=0&&mt<me&&(be(V[mt]),V[mt].focus({preventScroll:!0})),!0}}const at=w(()=>W.value===!0?{get:R=>Math.abs(R.scrollLeft),set:(R,M)=>{R.scrollLeft=-M}}:t.vertical===!0?{get:R=>R.scrollTop,set:(R,M)=>{R.scrollTop=M}}:{get:R=>R.scrollLeft,set:(R,M)=>{R.scrollLeft=M}});function xt(R){const M=k.value,{get:V,set:me}=at.value;let Ce=!1,we=V(M);const ke=R<we?-1:1;return we+=ke*5,we<0?(Ce=!0,we=0):(ke===-1&&we<=R||ke===1&&we>=R)&&(Ce=!0,we=R),me(M,we),Ae(),Ce}function Tt(R,M){for(const V in R)if(R[V]!==M[V])return!1;return!0}function vt(){let R=null,M={matchedLen:0,queryDiff:9999,hrefLen:0};const V=z.filter(ke=>ke.routeData?.hasRouterLink.value===!0),{hash:me,query:Ce}=u.$route,we=Object.keys(Ce).length;for(const ke of V){const et=ke.routeData.exact.value===!0;if(ke.routeData[et===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:mt,query:Wt,matched:ki,href:$}=ke.routeData.resolvedLink.value,oe=Object.keys(Wt).length;if(et===!0){if(mt!==me||oe!==we||Tt(Ce,Wt)===!1)continue;R=ke.name.value;break}if(mt!==""&&mt!==me||oe!==0&&Tt(Wt,Ce)===!1)continue;const ye={matchedLen:ki.length,queryDiff:we-oe,hrefLen:$.length-mt.length};if(ye.matchedLen>M.matchedLen){R=ke.name.value,M=ye;continue}else if(ye.matchedLen!==M.matchedLen)continue;if(ye.queryDiff<M.queryDiff)R=ke.name.value,M=ye;else if(ye.queryDiff!==M.queryDiff)continue;ye.hrefLen>M.hrefLen&&(R=ke.name.value,M=ye)}if(R===null&&z.some(ke=>ke.routeData===void 0&&ke.name.value===C.value)===!0){lt=!1;return}Se({name:R,setCurrent:!0})}function x(R){if(p(),G.value!==!0&&v.value!==null&&R.target&&typeof R.target.closest=="function"){const M=R.target.closest(".q-tab");M&&v.value.contains(M)===!0&&(G.value=!0,I.value===!0&&be(M))}}function j(){d(()=>{G.value=!1},30)}function ie(){Ve.avoidRouteWatcher===!1?g(vt):y()}function ce(){if(fe===void 0){const R=He(()=>u.$route.fullPath,ie);fe=()=>{R(),fe=void 0}}}function Ne(R){z.push(R),B.value++,Z(),R.routeData===void 0||u.$route===void 0?g(()=>{if(I.value===!0){const M=C.value,V=M!=null&&M!==""?z.find(me=>me.name.value===M):null;V&&be(V.rootRef.value)}}):(ce(),R.routeData.hasRouterLink.value===!0&&ie())}function ue(R){z.splice(z.indexOf(R),1),B.value--,Z(),fe!==void 0&&R.routeData!==void 0&&(z.every(M=>M.routeData===void 0)===!0&&fe(),ie())}const Ve={currentModel:C,tabProps:Le,hasFocus:G,hasActiveTab:xe,registerTab:Ne,unregisterTab:ue,verifyRouteModel:ie,updateModel:Se,onKbdNavigate:st,avoidRouteWatcher:!1};ln(Mo,Ve);function Ee(){ee!==null&&clearTimeout(ee),se(),fe?.()}let Ue,lt;return ys(Ee),gr(()=>{Ue=fe!==void 0,Ee()}),_r(()=>{Ue===!0&&(ce(),lt=!0,ie()),Z()}),()=>E("div",{ref:v,class:F.value,role:"tablist",onFocusin:x,onFocusout:j},[E(wi,{onResize:Ze}),E("div",{ref:k,class:K.value,onScroll:Ae},Xt(n.default)),E(ot,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(D.value===!0?"":" q-tabs__arrow--faded"),name:t.leftIcon||r.iconSet.tabs[t.vertical===!0?"up":"left"],onMousedownPassive:Ie,onTouchstartPassive:Ie,onMouseupPassive:se,onMouseleavePassive:se,onTouchendPassive:se}),E(ot,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(A.value===!0?"":" q-tabs__arrow--faded"),name:t.rightIcon||r.iconSet.tabs[t.vertical===!0?"down":"right"],onMousedownPassive:_e,onTouchstartPassive:_e,onMouseupPassive:se,onMouseleavePassive:se,onTouchendPassive:se})])}});let il=0;const sl=["click","keydown"],nl={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${il++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function ol(t,n,a,u){const r=Fi(Mo,ct);if(r===ct)return console.error("QTab/QRouteTab component needs to be child of QTabs"),ct;const{proxy:h}=wt(),c=he(null),f=he(null),d=he(null),p=w(()=>t.disable===!0||t.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},t.ripple===!0?{}:t.ripple)),g=w(()=>r.currentModel.value===t.name),y=w(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(g.value===!0?" q-tab--active"+(r.tabProps.value.activeClass?" "+r.tabProps.value.activeClass:"")+(r.tabProps.value.activeColor?` text-${r.tabProps.value.activeColor}`:"")+(r.tabProps.value.activeBgColor?` bg-${r.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(t.icon&&t.label&&r.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(t.noCaps===!0||r.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(t.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")),v=w(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(r.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(t.contentClass!==void 0?` ${t.contentClass}`:"")),k=w(()=>t.disable===!0||r.hasFocus.value===!0||g.value===!1&&r.hasActiveTab.value===!0?-1:t.tabindex||0);function C(z,B){if(B!==!0&&z?.qAvoidFocus!==!0&&c.value?.focus(),t.disable!==!0){r.updateModel({name:t.name}),a("click",z);return}}function I(z){br(z,[13,32])?C(z,!0):wr(z)!==!0&&z.keyCode>=35&&z.keyCode<=40&&z.altKey!==!0&&z.metaKey!==!0&&r.onKbdNavigate(z.keyCode,h.$el)===!0&&Ft(z),a("keydown",z)}function D(){const z=r.tabProps.value.narrowIndicator,B=[],G=E("div",{ref:d,class:["q-tab__indicator",r.tabProps.value.indicatorClass]});t.icon!==void 0&&B.push(E(ot,{class:"q-tab__icon",name:t.icon})),t.label!==void 0&&B.push(E("div",{class:"q-tab__label"},t.label)),t.alert!==!1&&B.push(t.alertIcon!==void 0?E(ot,{class:"q-tab__alert-icon",color:t.alert!==!0?t.alert:void 0,name:t.alertIcon}):E("div",{class:"q-tab__alert"+(t.alert!==!0?` text-${t.alert}`:"")})),z===!0&&B.push(G);const ee=[E("div",{class:"q-focus-helper",tabindex:-1,ref:c}),E("div",{class:v.value},rn(n.default,B))];return z===!1&&ee.push(G),ee}const A={name:w(()=>t.name),rootRef:f,tabIndicatorRef:d,routeData:u};ys(()=>{r.unregisterTab(A)}),Lo(()=>{r.registerTab(A)});function q(z,B){const G={ref:f,class:y.value,tabindex:k.value,role:"tab","aria-selected":g.value===!0?"true":"false","aria-disabled":t.disable===!0?"true":void 0,onClick:C,onKeydown:I,...B};return bi(E(z,G,D()),[[yr,p.value]])}return{renderTab:q,$tabs:r}}const $i=bt({name:"QTab",props:nl,emits:sl,setup(t,{slots:n,emit:a}){const{renderTab:u}=ol(t,n,a);return()=>u("div")}}),al={name:{required:!0},disable:Boolean},vo={setup(t,{slots:n}){return()=>E("div",{class:"q-panel scroll",role:"tabpanel"},Xt(n.default))}},rl={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},ll=["update:modelValue","beforeTransition","transition"];function ul(){const{props:t,emit:n,proxy:a}=wt(),{getCache:u}=So(),{registerTimeout:r}=cs();let h,c;const f=he(null),d={value:null};function p(H){const J=t.vertical===!0?"up":"left";fe((a.$q.lang.rtl===!0?-1:1)*(H.direction===J?1:-1))}const g=w(()=>[[Eo,p,void 0,{horizontal:t.vertical!==!0,vertical:t.vertical,mouse:!0}]]),y=w(()=>t.transitionPrev||`slide-${t.vertical===!0?"down":"right"}`),v=w(()=>t.transitionNext||`slide-${t.vertical===!0?"up":"left"}`),k=w(()=>`--q-transition-duration: ${t.transitionDuration}ms`),C=w(()=>typeof t.modelValue=="string"||typeof t.modelValue=="number"?t.modelValue:String(t.modelValue)),I=w(()=>({include:t.keepAliveInclude,exclude:t.keepAliveExclude,max:t.keepAliveMax})),D=w(()=>t.keepAliveInclude!==void 0||t.keepAliveExclude!==void 0);He(()=>t.modelValue,(H,J)=>{const W=B(H)===!0?G(H):-1;c!==!0&&re(W===-1?0:W<G(J)?-1:1),d.value!==W&&(d.value=W,n("beforeTransition",H,J),r(()=>{n("transition",H,J)},t.transitionDuration))});function A(){fe(1)}function q(){fe(-1)}function z(H){n("update:modelValue",H)}function B(H){return H!=null&&H!==""}function G(H){return h.findIndex(J=>J.props.name===H&&J.props.disable!==""&&J.props.disable!==!0)}function ee(){return h.filter(H=>H.props.disable!==""&&H.props.disable!==!0)}function re(H){const J=H!==0&&t.animated===!0&&d.value!==-1?"q-transition--"+(H===-1?y.value:v.value):null;f.value!==J&&(f.value=J)}function fe(H,J=d.value){let W=J+H;for(;W!==-1&&W<h.length;){const Se=h[W];if(Se!==void 0&&Se.props.disable!==""&&Se.props.disable!==!0){re(H),c=!0,n("update:modelValue",Se.props.name),setTimeout(()=>{c=!1});return}W+=H}t.infinite===!0&&h.length!==0&&J!==-1&&J!==h.length&&fe(H,H===-1?h.length:-1)}function Le(){const H=G(t.modelValue);return d.value!==H&&(d.value=H),!0}function xe(){const H=B(t.modelValue)===!0&&Le()&&h[d.value];return t.keepAlive===!0?[E(Tr,I.value,[E(D.value===!0?u(C.value,()=>({...vo,name:C.value})):vo,{key:C.value,style:k.value},()=>H)])]:[E("div",{class:"q-panel scroll",style:k.value,key:C.value,role:"tabpanel"},[H])]}function le(){if(h.length!==0)return t.animated===!0?[E(kr,{name:f.value},xe)]:xe()}function F(H){return h=Pr(Xt(H.default,[])).filter(J=>J.props!==null&&J.props.slot===void 0&&B(J.props.name)===!0),h.length}function K(){return h}return Object.assign(a,{next:A,previous:q,goTo:z}),{panelIndex:d,panelDirectives:g,updatePanelsList:F,updatePanelIndex:Le,getPanelContent:le,getEnabledPanels:ee,getPanels:K,isValidPanelName:B,keepAliveProps:I,needsUniqueKeepAliveWrapper:D,goToPanelByOffset:fe,goToPanel:z,nextPanel:A,previousPanel:q}}const Fo=bt({name:"QTabPanels",props:{...rl,...Zi},emits:ll,setup(t,{slots:n}){const a=wt(),u=Vi(t,a.proxy.$q),{updatePanelsList:r,getPanelContent:h,panelDirectives:c}=ul(),f=w(()=>"q-tab-panels q-panel-parent"+(u.value===!0?" q-tab-panels--dark q-dark":""));return()=>(r(n),qi("div",{class:f.value},h(),"pan",t.swipeable,()=>c.value))}}),hs=bt({name:"QTabPanel",props:al,setup(t,{slots:n}){return()=>E("div",{class:"q-tab-panel",role:"tabpanel"},Xt(n.default))}}),hl=/^rgb(a)?\((\d{1,3}),(\d{1,3}),(\d{1,3}),?([01]?\.?\d*?)?\)$/;function go({r:t,g:n,b:a,a:u}){const r=u!==void 0;if(t=Math.round(t),n=Math.round(n),a=Math.round(a),t>255||n>255||a>255||r&&u>100)throw new TypeError("Expected 3 numbers below 256 (and optionally one below 100)");return u=r?(Math.round(255*u/100)|256).toString(16).slice(1):"","#"+(a|n<<8|t<<16|1<<24).toString(16).slice(1)+u}function _o({r:t,g:n,b:a,a:u}){return`rgb${u!==void 0?"a":""}(${t},${n},${a}${u!==void 0?","+u/100:""})`}function qo(t){if(typeof t!="string")throw new TypeError("Expected a string");t=t.replace(/^#/,""),t.length===3?t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]:t.length===4&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);const n=parseInt(t,16);return t.length>6?{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:Math.round((n&255)/2.55)}:{r:n>>16,g:n>>8&255,b:n&255}}function yo({h:t,s:n,v:a,a:u}){let r,h,c;n=n/100,a=a/100,t=t/360;const f=Math.floor(t*6),d=t*6-f,p=a*(1-n),g=a*(1-d*n),y=a*(1-(1-d)*n);switch(f%6){case 0:r=a,h=y,c=p;break;case 1:r=g,h=a,c=p;break;case 2:r=p,h=a,c=y;break;case 3:r=p,h=g,c=a;break;case 4:r=y,h=p,c=a;break;case 5:r=a,h=p,c=g;break}return{r:Math.round(r*255),g:Math.round(h*255),b:Math.round(c*255),a:u}}function Ys({r:t,g:n,b:a,a:u}){const r=Math.max(t,n,a),h=Math.min(t,n,a),c=r-h,f=r===0?0:c/r,d=r/255;let p;switch(r){case h:p=0;break;case t:p=n-a+c*(n<a?6:0),p/=6*c;break;case n:p=a-t+c*2,p/=6*c;break;case a:p=t-n+c*4,p/=6*c;break}return{h:Math.round(p*360),s:Math.round(f*100),v:Math.round(d*100),a:u}}function Ho(t){if(typeof t!="string")throw new TypeError("Expected a string");const n=t.replace(/ /g,""),a=hl.exec(n);if(a===null)return qo(n);const u={r:Math.min(255,parseInt(a[2],10)),g:Math.min(255,parseInt(a[3],10)),b:Math.min(255,parseInt(a[4],10))};if(a[1]){const r=parseFloat(a[5]);u.a=Math.min(1,isNaN(r)===!0?1:r)*100}return u}function cl(t){if(typeof t!="string"&&(!t||t.r===void 0))throw new TypeError("Expected a string or a {r, g, b} object as color");const n=typeof t=="string"?Ho(t):t,a=n.r/255,u=n.g/255,r=n.b/255,h=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),c=u<=.03928?u/12.92:Math.pow((u+.055)/1.055,2.4),f=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4);return .2126*h+.7152*c+.0722*f}const dl=["rgb(255,204,204)","rgb(255,230,204)","rgb(255,255,204)","rgb(204,255,204)","rgb(204,255,230)","rgb(204,255,255)","rgb(204,230,255)","rgb(204,204,255)","rgb(230,204,255)","rgb(255,204,255)","rgb(255,153,153)","rgb(255,204,153)","rgb(255,255,153)","rgb(153,255,153)","rgb(153,255,204)","rgb(153,255,255)","rgb(153,204,255)","rgb(153,153,255)","rgb(204,153,255)","rgb(255,153,255)","rgb(255,102,102)","rgb(255,179,102)","rgb(255,255,102)","rgb(102,255,102)","rgb(102,255,179)","rgb(102,255,255)","rgb(102,179,255)","rgb(102,102,255)","rgb(179,102,255)","rgb(255,102,255)","rgb(255,51,51)","rgb(255,153,51)","rgb(255,255,51)","rgb(51,255,51)","rgb(51,255,153)","rgb(51,255,255)","rgb(51,153,255)","rgb(51,51,255)","rgb(153,51,255)","rgb(255,51,255)","rgb(255,0,0)","rgb(255,128,0)","rgb(255,255,0)","rgb(0,255,0)","rgb(0,255,128)","rgb(0,255,255)","rgb(0,128,255)","rgb(0,0,255)","rgb(128,0,255)","rgb(255,0,255)","rgb(245,0,0)","rgb(245,123,0)","rgb(245,245,0)","rgb(0,245,0)","rgb(0,245,123)","rgb(0,245,245)","rgb(0,123,245)","rgb(0,0,245)","rgb(123,0,245)","rgb(245,0,245)","rgb(214,0,0)","rgb(214,108,0)","rgb(214,214,0)","rgb(0,214,0)","rgb(0,214,108)","rgb(0,214,214)","rgb(0,108,214)","rgb(0,0,214)","rgb(108,0,214)","rgb(214,0,214)","rgb(163,0,0)","rgb(163,82,0)","rgb(163,163,0)","rgb(0,163,0)","rgb(0,163,82)","rgb(0,163,163)","rgb(0,82,163)","rgb(0,0,163)","rgb(82,0,163)","rgb(163,0,163)","rgb(92,0,0)","rgb(92,46,0)","rgb(92,92,0)","rgb(0,92,0)","rgb(0,92,46)","rgb(0,92,92)","rgb(0,46,92)","rgb(0,0,92)","rgb(46,0,92)","rgb(92,0,92)","rgb(255,255,255)","rgb(205,205,205)","rgb(178,178,178)","rgb(153,153,153)","rgb(127,127,127)","rgb(102,102,102)","rgb(76,76,76)","rgb(51,51,51)","rgb(25,25,25)","rgb(0,0,0)"],bo="M5 5 h10 v10 h-10 v-10 z",fl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAH0lEQVQoU2NkYGAwZkAFZ5G5jPRRgOYEVDeB3EBjBQBOZwTVugIGyAAAAABJRU5ErkJggg==",ml=bt({name:"QColor",props:{...Zi,...on,modelValue:String,defaultValue:String,defaultView:{type:String,default:"spectrum",validator:t=>["spectrum","tune","palette"].includes(t)},formatModel:{type:String,default:"auto",validator:t=>["auto","hex","rgb","hexa","rgba"].includes(t)},palette:Array,noHeader:Boolean,noHeaderTabs:Boolean,noFooter:Boolean,square:Boolean,flat:Boolean,bordered:Boolean,disable:Boolean,readonly:Boolean},emits:["update:modelValue","change"],setup(t,{emit:n}){const{proxy:a}=wt(),{$q:u}=a,r=Vi(t,u),{getCache:h}=So(),c=he(null),f=he(null),d=w(()=>t.formatModel==="auto"?null:t.formatModel.indexOf("hex")!==-1),p=w(()=>t.formatModel==="auto"?null:t.formatModel.indexOf("a")!==-1),g=he(t.formatModel==="auto"?t.modelValue===void 0||t.modelValue===null||t.modelValue===""||t.modelValue.startsWith("#")?"hex":"rgb":t.formatModel.startsWith("hex")?"hex":"rgb"),y=he(t.defaultView),v=he(F(t.modelValue||t.defaultValue)),k=w(()=>t.disable!==!0&&t.readonly!==!0),C=w(()=>t.modelValue===void 0||t.modelValue===null||t.modelValue===""||t.modelValue.startsWith("#")),I=w(()=>d.value!==null?d.value:C.value),D=w(()=>({type:"hidden",name:t.name,value:v.value[I.value===!0?"hex":"rgb"]})),A=an(D),q=w(()=>p.value!==null?p.value:v.value.a!==void 0),z=w(()=>({backgroundColor:v.value.rgb||"#000"})),B=w(()=>`q-color-picker__header-content q-color-picker__header-content--${(v.value.a!==void 0&&v.value.a<65?!0:cl(v.value)>.4)?"light":"dark"}`),G=w(()=>({background:`hsl(${v.value.h},100%,50%)`})),ee=w(()=>({top:`${100-v.value.v}%`,[u.lang.rtl===!0?"right":"left"]:`${v.value.s}%`})),re=w(()=>t.palette!==void 0&&t.palette.length!==0?t.palette:dl),fe=w(()=>"q-color-picker"+(t.bordered===!0?" q-color-picker--bordered":"")+(t.square===!0?" q-color-picker--square no-border-radius":"")+(t.flat===!0?" q-color-picker--flat no-shadow":"")+(t.disable===!0?" disabled":"")+(r.value===!0?" q-color-picker--dark q-dark":"")),Le=w(()=>t.disable===!0?{"aria-disabled":"true"}:{}),xe=w(()=>[[yi,Ze,void 0,{prevent:!0,stop:!0,mouse:!0}]]);He(()=>t.modelValue,x=>{const j=F(x||t.defaultValue);j.hex!==v.value.hex&&(v.value=j)}),He(()=>t.defaultValue,x=>{if(!t.modelValue&&x){const j=F(x);j.hex!==v.value.hex&&(v.value=j)}});function le(x,j){v.value.hex=go(x),v.value.rgb=_o(x),v.value.r=x.r,v.value.g=x.g,v.value.b=x.b,v.value.a=x.a;const ie=v.value[I.value===!0?"hex":"rgb"];n("update:modelValue",ie),j===!0&&n("change",ie)}function F(x){const j=p.value!==void 0?p.value:t.formatModel==="auto"?null:t.formatModel.indexOf("a")!==-1;if(typeof x!="string"||x.length===0||Lr.anyColor(x.replace(/ /g,""))!==!0)return{h:0,s:0,v:0,r:0,g:0,b:0,a:j===!0?100:void 0,hex:void 0,rgb:void 0};const ie=Ho(x);return j===!0&&ie.a===void 0&&(ie.a=100),ie.hex=go(ie),ie.rgb=_o(ie),Object.assign(ie,Ys(ie))}function K(x,j,ie){const ce=c.value;if(ce===null)return;const Ne=ce.clientWidth,ue=ce.clientHeight,Ve=ce.getBoundingClientRect();let Ee=Math.min(Ne,Math.max(0,x-Ve.left));u.lang.rtl===!0&&(Ee=Ne-Ee);const Ue=Math.min(ue,Math.max(0,j-Ve.top)),lt=Math.round(100*Ee/Ne),R=Math.round(100*Math.max(0,Math.min(1,-(Ue/ue)+1))),M=yo({h:v.value.h,s:lt,v:R,a:q.value===!0?v.value.a:void 0});v.value.s=lt,v.value.v=R,le(M,ie)}function H(x,j){const ie=Math.round(x),ce=yo({h:ie,s:v.value.s,v:v.value.v,a:q.value===!0?v.value.a:void 0});v.value.h=ie,le(ce,j)}function J(x){H(x,!0)}function W(x,j,ie,ce,Ne){if(ce!==void 0&&Bt(ce),!/^[0-9]+$/.test(x)){Ne===!0&&a.$forceUpdate();return}const ue=Math.floor(Number(x));if(ue<0||ue>ie){Ne===!0&&a.$forceUpdate();return}const Ve={r:j==="r"?ue:v.value.r,g:j==="g"?ue:v.value.g,b:j==="b"?ue:v.value.b,a:q.value===!0?j==="a"?ue:v.value.a:void 0};if(j!=="a"){const Ee=Ys(Ve);v.value.h=Ee.h,v.value.s=Ee.s,v.value.v=Ee.v}if(le(Ve,Ne),Ne!==!0&&ce?.target.selectionEnd!==void 0){const Ee=ce.target.selectionEnd;ds(()=>{ce.target.setSelectionRange(Ee,Ee)})}}function Se(x,j){let ie;const ce=x.target.value;if(Bt(x),g.value==="hex"){if(ce.length!==(q.value===!0?9:7)||!/^#[0-9A-Fa-f]+$/.test(ce))return!0;ie=qo(ce)}else{let ue;if(ce.endsWith(")"))if(q.value!==!0&&ce.startsWith("rgb(")){if(ue=ce.substring(4,ce.length-1).split(",").map(Ve=>parseInt(Ve,10)),ue.length!==3||!/^rgb\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3}\)$/.test(ce))return!0}else if(q.value===!0&&ce.startsWith("rgba(")){if(ue=ce.substring(5,ce.length-1).split(","),ue.length!==4||!/^rgba\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3},(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/.test(ce))return!0;for(let Ee=0;Ee<3;Ee++){const Ue=parseInt(ue[Ee],10);if(Ue<0||Ue>255)return!0;ue[Ee]=Ue}const Ve=parseFloat(ue[3]);if(Ve<0||Ve>1)return!0;ue[3]=Ve}else return!0;else return!0;if(ue[0]<0||ue[0]>255||ue[1]<0||ue[1]>255||ue[2]<0||ue[2]>255||q.value===!0&&(ue[3]<0||ue[3]>1))return!0;ie={r:ue[0],g:ue[1],b:ue[2],a:q.value===!0?ue[3]*100:void 0}}const Ne=Ys(ie);if(v.value.h=Ne.h,v.value.s=Ne.s,v.value.v=Ne.v,le(ie,j),j!==!0){const ue=x.target.selectionEnd;ds(()=>{x.target.setSelectionRange(ue,ue)})}}function Z(x){const j=F(x),ie={r:j.r,g:j.g,b:j.b,a:j.a};ie.a===void 0&&(ie.a=v.value.a),v.value.h=j.h,v.value.s=j.s,v.value.v=j.v,le(ie,!0)}function Ze(x){x.isFinal?K(x.position.left,x.position.top,!0):Y(x)}const Y=xo(x=>{K(x.position.left,x.position.top)},20);function be(x){K(x.pageX-window.pageXOffset,x.pageY-window.pageYOffset,!0)}function Ae(x){K(x.pageX-window.pageXOffset,x.pageY-window.pageYOffset)}function Fe(x){f.value!==null&&(f.value.$el.style.opacity=x?1:0)}function Ie(x){g.value=x}function _e(){const x=[];return t.noHeaderTabs!==!0&&x.push(E(po,{class:"q-color-picker__header-tabs",modelValue:g.value,dense:!0,align:"justify","onUpdate:modelValue":Ie},()=>[E($i,{label:"HEX"+(q.value===!0?"A":""),name:"hex",ripple:!1}),E($i,{label:"RGB"+(q.value===!0?"A":""),name:"rgb",ripple:!1})])),x.push(E("div",{class:"q-color-picker__header-banner row flex-center no-wrap"},[E("input",{class:"fit",value:v.value[g.value],...k.value!==!0?{readonly:!0}:{},...h("topIn",{onInput:j=>{Fe(Se(j)===!0)},onChange:Bt,onBlur:j=>{Se(j,!0)===!0&&a.$forceUpdate(),Fe(!1)}})}),E(ot,{ref:f,class:"q-color-picker__error-icon absolute no-pointer-events",name:u.iconSet.type.negative})])),E("div",{class:"q-color-picker__header relative-position overflow-hidden"},[E("div",{class:"q-color-picker__header-bg absolute-full"}),E("div",{class:B.value,style:z.value},x)])}function se(){return E(Fo,{modelValue:y.value,animated:!0},()=>[E(hs,{class:"q-color-picker__spectrum-tab overflow-hidden",name:"spectrum"},xt),E(hs,{class:"q-pa-md q-color-picker__tune-tab",name:"tune"},Tt),E(hs,{class:"q-color-picker__palette-tab",name:"palette"},vt)])}function st(x){y.value=x}function at(){return E("div",{class:"q-color-picker__footer relative-position overflow-hidden"},[E(po,{class:"absolute-full",modelValue:y.value,dense:!0,align:"justify","onUpdate:modelValue":st},()=>[E($i,{icon:u.iconSet.colorPicker.spectrum,name:"spectrum",ripple:!1}),E($i,{icon:u.iconSet.colorPicker.tune,name:"tune",ripple:!1}),E($i,{icon:u.iconSet.colorPicker.palette,name:"palette",ripple:!1})])])}function xt(){const x={ref:c,class:"q-color-picker__spectrum non-selectable relative-position cursor-pointer"+(k.value!==!0?" readonly":""),style:G.value,...k.value===!0?{onClick:be,onMousedown:Ae}:{}},j=[E("div",{style:{paddingBottom:"100%"}}),E("div",{class:"q-color-picker__spectrum-white absolute-full"}),E("div",{class:"q-color-picker__spectrum-black absolute-full"}),E("div",{class:"absolute",style:ee.value},[v.value.hex!==void 0?E("div",{class:"q-color-picker__spectrum-circle"}):null])],ie=[E(gi,{class:"q-color-picker__hue non-selectable",modelValue:v.value.h,min:0,max:360,trackSize:"8px",innerTrackColor:"transparent",selectionColor:"transparent",readonly:k.value!==!0,thumbPath:bo,"onUpdate:modelValue":H,onChange:J})];return q.value===!0&&ie.push(E(gi,{class:"q-color-picker__alpha non-selectable",modelValue:v.value.a,min:0,max:100,trackSize:"8px",trackColor:"white",innerTrackColor:"transparent",selectionColor:"transparent",trackImg:fl,readonly:k.value!==!0,hideSelection:!0,thumbPath:bo,...h("alphaSlide",{"onUpdate:modelValue":ce=>W(ce,"a",100),onChange:ce=>W(ce,"a",100,void 0,!0)})})),[qi("div",x,j,"spec",k.value,()=>xe.value),E("div",{class:"q-color-picker__sliders"},ie)]}function Tt(){return[E("div",{class:"row items-center no-wrap"},[E("div","R"),E(gi,{modelValue:v.value.r,min:0,max:255,color:"red",dark:r.value,readonly:k.value!==!0,...h("rSlide",{"onUpdate:modelValue":x=>W(x,"r",255),onChange:x=>W(x,"r",255,void 0,!0)})}),E("input",{value:v.value.r,maxlength:3,readonly:k.value!==!0,onChange:Bt,...h("rIn",{onInput:x=>W(x.target.value,"r",255,x),onBlur:x=>W(x.target.value,"r",255,x,!0)})})]),E("div",{class:"row items-center no-wrap"},[E("div","G"),E(gi,{modelValue:v.value.g,min:0,max:255,color:"green",dark:r.value,readonly:k.value!==!0,...h("gSlide",{"onUpdate:modelValue":x=>W(x,"g",255),onChange:x=>W(x,"g",255,void 0,!0)})}),E("input",{value:v.value.g,maxlength:3,readonly:k.value!==!0,onChange:Bt,...h("gIn",{onInput:x=>W(x.target.value,"g",255,x),onBlur:x=>W(x.target.value,"g",255,x,!0)})})]),E("div",{class:"row items-center no-wrap"},[E("div","B"),E(gi,{modelValue:v.value.b,min:0,max:255,color:"blue",readonly:k.value!==!0,dark:r.value,...h("bSlide",{"onUpdate:modelValue":x=>W(x,"b",255),onChange:x=>W(x,"b",255,void 0,!0)})}),E("input",{value:v.value.b,maxlength:3,readonly:k.value!==!0,onChange:Bt,...h("bIn",{onInput:x=>W(x.target.value,"b",255,x),onBlur:x=>W(x.target.value,"b",255,x,!0)})})]),q.value===!0?E("div",{class:"row items-center no-wrap"},[E("div","A"),E(gi,{modelValue:v.value.a,color:"grey",readonly:k.value!==!0,dark:r.value,...h("aSlide",{"onUpdate:modelValue":x=>W(x,"a",100),onChange:x=>W(x,"a",100,void 0,!0)})}),E("input",{value:v.value.a,maxlength:3,readonly:k.value!==!0,onChange:Bt,...h("aIn",{onInput:x=>W(x.target.value,"a",100,x),onBlur:x=>W(x.target.value,"a",100,x,!0)})})]):null]}function vt(){const x=j=>E("div",{class:"q-color-picker__cube col-auto",style:{backgroundColor:j},...k.value===!0?h("palette#"+j,{onClick:()=>{Z(j)}}):{}});return[E("div",{class:"row items-center q-color-picker__palette-rows"+(k.value===!0?" q-color-picker__palette-rows--editable":"")},re.value.map(x))]}return()=>{const x=[se()];return t.name!==void 0&&t.disable!==!0&&A(x,"push"),t.noHeader!==!0&&x.unshift(_e()),t.noFooter!==!0&&x.push(at()),E("div",{class:fe.value,...Le.value},x)}}}),pl=Pt({name:"ColorModal",emits:["update:modelValue"],props:["modelValue"],data(){return{selectedColor:""}},computed:{modalColor:{get(){return this.modelValue||"#fff"},set(t){this.selectedColor=t}}},methods:{modalSubmit(){this.$emit("update:modelValue",this.selectedColor),this.$refs.colorModal.hide()},show(){this.$refs.colorModal.show()}}}),vl={class:"bg-grey-9"};function gl(t,n,a,u,r,h){return N(),ae(Io,{minimized:"",ref:"colorModal","content-css":{minWidth:"240px",minHeight:"201px"}},{default:P(()=>[ve("div",vl,[S(ml,{dark:"","no-header-tabs":"","no-footer":"",modelValue:t.modalColor,"onUpdate:modelValue":n[0]||(n[0]=c=>t.modalColor=c),"format-model":"hex"},null,8,["modelValue"]),S(je,{flat:"",class:"full-width",color:"white",onClick:t.modalSubmit},{default:P(()=>n[1]||(n[1]=[X(" Set ")])),_:1,__:[1]},8,["onClick"])])]),_:1},512)}const Zo=kt(pl,[["render",gl],["__scopeId","data-v-3122277a"]]),ht=yt(),dt=Do("devices",{state:()=>({devices:[],activeDevicesIDs:[],devicesColors:{},devicesInitialized:!1}),getters:{getDeviceById:t=>n=>{const a=t.devices.filter(u=>u.id===n)[0];return a||{}},token:()=>fs().token},actions:{async getInitDataByDeviceId([t,n]){if(!this.token)return;const u=(await this.$connector.gw.getDevicesTelemetry(t,"position,ident")).data;ht.errorsCheck(u);const r=u&&u.result[0]&&u.result[0].telemetry&&u.result[0].telemetry.position&&u.result[0].telemetry.position.value?u.result[0].telemetry.position.value:{},h=Object.keys(r);if(!h.length||!n&&r.valid!==void 0&&r.valid===!1)return!1;const c=h.reduce((f,d)=>(f["position."+d]=r[d],f),{});u.result[0].telemetry.position.ts&&(c.timestamp=u.result[0].telemetry.position.ts),u.result[0].telemetry.ident&&u.result[0].telemetry.ident.value&&(c.ident=u.result[0].telemetry.ident.value),Object.defineProperty(c,"x-flespi-inited-by-telemetry",{value:!0,enumerable:!1}),ht.getMessagesStore(t).setHistoryMessages([c])},async getLatestPositionTimestamp(){let t=ht.date[0],n=ht.date[1];if(this.token){const a=this.activeDevicesIDs.join(",");let u=Date.now();if(a){let r;ht.requestStart("get devices telemetry",a);try{r=await this.$connector.gw.getDevicesTelemetry(a,"position.latitude,position.longitude")}catch(h){ht.requestFailed(h)}if(r&&r.data){const h=r.data;ht.errorsCheck(h);const c=Math.max(...h.result.reduce((f,d)=>(f.push(d.telemetry&&d.telemetry["position.latitude"]?Math.floor(d.telemetry["position.latitude"].ts*1e3):0),f.push(d.telemetry&&d.telemetry["position.longitude"]?Math.floor(d.telemetry["position.longitude"].ts*1e3):0),f),[]));c&&(u=c)}}t=new Date(u).setHours(0,0,0,0),n=t+86399999}return[t,n]},async poolDevices(){if(this.token){ht.requestStart("pool devices");try{const t=await this.$connector.poolDevices(n=>{this.setDevices(n)},(n,a)=>{this.updateDevices(n,a)});return async()=>{await this.$connector.poolDevicesStop(t)}}catch(t){ht.requestFailed(t)}}},addActiveDevice(t){this.activeDevicesIDs.includes(t)||(this.activeDevicesIDs.push(t),ht.setToStore({store:vi,name:"active",value:this.activeDevicesIDs}),this.router.push(`/devices/${this.activeDevicesIDs.join(",")}`).catch(n=>{}))},removeActiveDevice(t){const n=this.activeDevicesIDs.indexOf(t);this.activeDevicesIDs.splice(n,1),ht.setToStore({store:vi,name:"active",value:this.activeDevicesIDs}),this.activeDevicesIDs.length?this.router.push(`/devices/${this.activeDevicesIDs.join(",")}`).catch(a=>{}):this.router.push("/").catch(a=>{})},setActiveDevicesIDs(t){if(!Array.isArray(t)||!t.every(n=>typeof n=="number")){console.log("[devices store]: setActiveDevicesIDs() expects array of devices' ids as an argument");return}this.activeDevicesIDs.splice(0,this.activeDevicesIDs.length,...t),ht.setToStore({store:vi,name:"active",value:this.activeDevicesIDs})},setDevices(t){JSON.stringify(this.devices)!==JSON.stringify(t.data.result)&&(this.devices=t.data.result),console.log("[devices storage]: setDevices()",this.activeDevicesIDs,this.devices);const n=[];this.activeDevicesIDs.forEach(h=>{this.devices.filter(c=>c.id===h).length&&n.push(h)}),this.setActiveDevicesIDs(n);let a=ht.getFromStore({store:vi,name:"colors"});a||(a={});const u={},r="0123456789ABCDEF";this.devices.forEach(h=>{if(a[h.id])u[h.id]=a[h.id];else{let c=`#${r[Math.floor(Math.random()*5)]}`;for(let f=0;f<5;f++)c+=r[Math.floor(Math.random()*15)];u[h.id]=c}}),ht.setToStore({store:vi,name:"colors",value:u}),this.devicesColors=u,this.devicesInitialized=!0,this.activeDevicesIDs.length?this.router.push(`/devices/${this.activeDevicesIDs.join(",")}`).catch(h=>{}):this.router.push("/").catch(h=>{})},unsetDevicesInitialized(){this.devicesInitialized=!1,this.devices=[],this.activeDevicesIDs=[]},updateDeviceColor(t,n){this.devicesColors[t]=n,ht.setToStore({store:vi,name:"colors",value:this.devicesColors})},updateDevices(t,n){switch(console.log("[devices storage] updateDevices, type, device: ",t,n),t){case"created":{this.devices.push(n);break}case"updated":{this.devices.some((a,u)=>a.id===n.id?(this.devices[u]=Object.assign(this.devices[u],n),!0):!1);break}case"deleted":{this.devices.some((a,u)=>a.id===n.id?(this.devices.splice(u,1),!0):!1);break}}}}}),_l=Pt({name:"ActiveDevice",components:{ColorModal:Zo},emits:["device-in-list-clicked","follow-selected-device","remove-device-from-active-list","select-device"],props:["device","isFollowed","isSelected"],data(){return{displayTooltip:!1}},computed:{color:{get(){return dt().devicesColors[this.device.id+""]||"#909090"},set(t){this.updateDeviceColor(this.device.id,t)}}},methods:{..._t(dt,["removeActiveDevice","updateDeviceColor"]),deviceClickHandler(){this.isSelected||setTimeout(()=>{this.$emit("select-device",this.device.id)},500),this.$emit("device-in-list-clicked",!0)},removeDeviceHandler(t){if(t&&t.direction&&t.direction!=="right")return!1;this.removeActiveDevice(this.device.id),this.$emit("remove-device-from-active-list")},showOnMapButtonHandler(){this.isSelected?setTimeout(()=>{this.$emit("follow-selected-device",!this.isFollowed)},500):setTimeout(()=>{this.$emit("select-device",this.device.id)},500),setTimeout(()=>{this.displayTooltip=!1},500)}}}),yl={class:"text-center absolute-top-left bg-grey-3 text-bold text-grey-9",style:{"font-size":"10px","min-width":"55px","padding-top":"1px","z-index":"1","border-radius":"0 0 3px 0","line-height":"10px"}};function bl(t,n,a,u,r,h){const c=ft("color-modal");return bi((N(),ae(Je,{highlight:t.$q.platform.is.desktop,class:Oe([[t.isSelected?"device-item__selected":"",t.device["x-flespi-no-access"]?"no-access-device":""],"device-item__hover"]),style:{"min-height":"71px"},clickable:"",onClick:t.deviceClickHandler},{default:P(()=>[t.device["x-flespi-no-access"]?(N(),ae(De,{key:0},{default:P(()=>n[4]||(n[4]=[X("Device has no access to messages and telemetry")])),_:1,__:[4]})):Pe("",!0),ve("div",yl," #"+Be(t.device.id),1),S(ze,{side:"",style:{position:"relative"}},{default:P(()=>[S(ot,{size:"1.7rem",name:"mdi-developer-board"}),ve("div",{style:it([{position:"absolute",top:"29px",right:"8px"},{backgroundColor:t.color}]),class:"color-view q-mr-xs",onClick:n[0]||(n[0]=Qt(f=>t.$refs.colorModal.show(),["stop"]))},[S(De,null,{default:P(()=>n[5]||(n[5]=[X("Change color")])),_:1,__:[5]})],4)]),_:1}),S(ze,null,{default:P(()=>[S(Xe,{class:"ellipsis-2-lines q-pa-none text-white",header:""},{default:P(()=>[X(Be(t.device.name||"<noname>"),1)]),_:1})]),_:1}),S(ze,{side:"",class:"text-center"},{default:P(()=>[S(Xe,null,{default:P(()=>[S(ot,{class:Oe([t.isSelected?"icon__send-followed":"text-grey-5"]),size:"1.2rem",name:t.isFollowed?"mdi-crosshairs-gps":"mdi-crosshairs",onClick:Qt(t.showOnMapButtonHandler,["stop"])},{default:P(()=>[t.isFollowed?(N(),ae(De,{key:1,modelValue:t.displayTooltip,"onUpdate:modelValue":n[2]||(n[2]=f=>t.displayTooltip=f)},{default:P(()=>n[7]||(n[7]=[X("Stop following device")])),_:1,__:[7]},8,["modelValue"])):(N(),ae(De,{key:0,modelValue:t.displayTooltip,"onUpdate:modelValue":n[1]||(n[1]=f=>t.displayTooltip=f)},{default:P(()=>n[6]||(n[6]=[X("Follow device on map")])),_:1,__:[6]},8,["modelValue"]))]),_:1},8,["class","name","onClick"])]),_:1})]),_:1}),t.$q.platform.is.desktop?(N(),ae(ze,{key:1,class:"hiding-cross"},{default:P(()=>[S(Xe,null,{default:P(()=>[S(ot,{name:"mdi-close",size:"1.1rem",onClick:Qt(t.removeDeviceHandler,["stop"])},{default:P(()=>[S(De,null,{default:P(()=>n[8]||(n[8]=[X("Remove from active devices list")])),_:1,__:[8]})]),_:1},8,["onClick"])]),_:1})]),_:1})):Pe("",!0),S(c,{ref:"colorModal",modelValue:t.color,"onUpdate:modelValue":n[3]||(n[3]=f=>t.color=f)},null,8,["modelValue"])]),_:1},8,["highlight","class","onClick"])),[[Eo,t.removeDeviceHandler,void 0,{noMouse:!0,horizontal:!0}]])}const wl=kt(_l,[["render",bl]]),kl=Pt({name:"InactiveDevice",emits:["device-in-list-clicked"],props:["device"],data(){return{}},methods:{..._t(dt,["addActiveDevice"]),deviceClickHandler(){this.addActiveDevice(this.device.id),this.$emit("device-in-list-clicked",!1)}}}),Pl={class:"text-center absolute-top-left bg-grey-3 text-bold text-grey-9",style:{"font-size":"10px","min-width":"55px","padding-top":"1px","z-index":"1","border-radius":"0 0 3px 0","line-height":"10px"}};function Tl(t,n,a,u,r,h){return N(),ae(Je,{clickable:"",highlight:t.$q.platform.is.desktop,class:Oe([[t.device["x-flespi-no-access"]?"no-access-device":""],"device-item__hover"]),style:{"min-height":"71px"},onClick:t.deviceClickHandler},{default:P(()=>[t.device["x-flespi-no-access"]?(N(),ae(De,{key:0},{default:P(()=>n[0]||(n[0]=[X("Device has no access to messages and telemetry")])),_:1,__:[0]})):Pe("",!0),ve("div",Pl," #"+Be(t.device.id),1),S(ze,{side:"",style:{position:"relative"}},{default:P(()=>[S(ot,{size:"1.7rem",name:"mdi-developer-board"})]),_:1}),S(ze,null,{default:P(()=>[S(Xe,{class:"ellipsis-2-lines q-pa-none",header:""},{default:P(()=>[X(Be(t.device.name||"<noname>"),1)]),_:1})]),_:1})]),_:1},8,["highlight","class","onClick"])}const Ll=kt(kl,[["render",Tl]]),Cl=Pt({name:"DevicesList",components:{ActiveDevice:wl,InactiveDevice:Ll},emits:["click-hide","devices-list-pinned","device-in-list-clicked","follow-selected-device","select-device"],props:["activeDevicesIDs","devices","devicesListPinned","isFollowed","selectedDeviceId"],data(){return{activeDevicesHeight:0,activeDevicesMaxHeight:0,devicesFilterHeight:70,deviceItemHeight:71,filter:"",inactiveDevicesHeight:0,itemsCount:0,listHeaderHeight:60,viewportHeight:0}},computed:{classifiedDevices(){const t={active:[],inactive:[]};return this.devices.forEach(n=>{this.activeDevicesIDs.includes(n.id)?t.active.push(n):t.inactive.push(n)}),t},filteredInactiveDevices(){const t=this.filter.toLowerCase(),n=this.filter?this.classifiedDevices.inactive.filter(a=>a&&typeof a.name<"u"&&a.name!==null&&a.name.toLowerCase().indexOf(t)>=0||a&&typeof a.id<"u"&&a.id!==null&&(a.id+"").indexOf(t)>=0||a&&a.configuration&&typeof a.configuration.ident<"u"&&a.configuration.ident!==null&&a.configuration.ident.toLowerCase().indexOf(t)>=0):this.classifiedDevices.inactive;return n.sort((a,u)=>{if(!a.name)return-1;if(!u.name)return 1;const r=a.name.toLowerCase(),h=u.name.toLowerCase();return r<h?-1:(r>h,1)}),n}},methods:{deviceRemovedHandler(){this.inactiveDevicesHeight=this.inactiveDevicesHeight+this.deviceItemHeight,this.itemsCount=Math.ceil(this.inactiveDevicesHeight/this.deviceItemHeight)},onResizeActiveDevicesList(t){this.activeDevicesHeight=t.height,this.inactiveDevicesHeight=this.viewportHeight-this.listHeaderHeight-this.devicesFilterHeight-this.activeDevicesHeight,this.itemsCount=Math.ceil(this.inactiveDevicesHeight/this.deviceItemHeight);const n=this.$refs.activeDevicesList.getElementsByClassName("device-item__selected")[0];n&&n.scrollIntoView({behavior:"smooth"})},onResizeScreen(t){this.viewportHeight=t;const n=Math.ceil(t*.7);this.activeDevicesMaxHeight=n>this.deviceItemHeight*10?this.deviceItemHeight*10:n,this.activeDevicesHeight=this.$refs.activeDevicesList?this.$refs.activeDevicesList.clientHeight:0,this.inactiveDevicesHeight=this.viewportHeight-this.listHeaderHeight-this.devicesFilterHeight-this.activeDevicesHeight,this.itemsCount=Math.ceil(this.inactiveDevicesHeight/this.deviceItemHeight)}},watch:{activeDevicesIDs(){this.$refs.vlist&&this.$refs.vlist.forceRender()},"$q.screen.height":{immediate:!0,handler(t){this.onResizeScreen(t)}}}}),Ml={style:{position:"relative",height:"100dvh",overflow:"hidden"}},Sl={key:0,style:{overflow:"auto"}},xl={class:"q-px-none"};function Il(t,n,a,u,r,h){const c=ft("active-device"),f=ft("inactive-device");return N(),Re("div",Ml,[S(Hi,{dark:"",class:"bg-grey-9 text-white"},{default:P(()=>[S(Je,{style:it([{height:`${t.listHeaderHeight}px`},{"line-height":"58px !important"}])},{default:P(()=>[S(ze,{avatar:""},{default:P(()=>[S(je,{flat:"",round:"",small:"",icon:"mdi-chevron-left",style:{"margin-right":"15px"},onClick:n[0]||(n[0]=d=>t.$emit("click-hide"))})]),_:1}),S(ze,null,{default:P(()=>[S(Xe,{header:"",class:"text-bold text-white q-pa-none",style:{"font-size":"1.3rem"}},{default:P(()=>n[6]||(n[6]=[X(" Devices ")])),_:1,__:[6]})]),_:1}),S(ze,{side:""},{default:P(()=>[t.$q.platform.is.desktop?(N(),ae(je,{key:0,flat:"",round:"",small:"",icon:t.devicesListPinned?"mdi-pin":"mdi-pin-outline",class:Oe(["text-grey",{unpinned:!t.devicesListPinned}]),onClick:n[1]||(n[1]=d=>t.$emit("devices-list-pinned",!t.devicesListPinned))},{default:P(()=>[t.devicesListPinned?(N(),ae(De,{key:0},{default:P(()=>n[7]||(n[7]=[X("Unpin devices list")])),_:1,__:[7]})):(N(),ae(De,{key:1},{default:P(()=>n[8]||(n[8]=[X("Pin devices list")])),_:1,__:[8]}))]),_:1},8,["icon","class"])):Pe("",!0)]),_:1})]),_:1},8,["style"]),ve("div",{style:it([{"max-height":`${t.activeDevicesMaxHeight}px`},{overflow:"auto"}]),class:"scrollable",ref:"activeDevicesList"},[S(wi,{onResize:t.onResizeActiveDevicesList},null,8,["onResize"]),(N(!0),Re(Ut,null,ni(t.classifiedDevices.active,d=>(N(),ae(c,{class:"with-separator",key:d.id,device:d,isFollowed:t.selectedDeviceId===d.id&&t.isFollowed===!0,isSelected:t.selectedDeviceId===d.id,onSelectDevice:p=>t.$emit("select-device",d.id),onFollowSelectedDevice:n[2]||(n[2]=p=>t.$emit("follow-selected-device",!t.isFollowed)),onRemoveDeviceFromActiveList:t.deviceRemovedHandler,onDeviceInListClicked:n[3]||(n[3]=p=>t.$emit("device-in-list-clicked"))},null,8,["device","isFollowed","isSelected","onSelectDevice","onRemoveDeviceFromActiveList"]))),128))],4),t.classifiedDevices.inactive.length?(N(),Re("div",Sl,[S(Je,{style:it([{height:`${t.devicesFilterHeight}px!important`},{"padding-top":"20px"}])},{default:P(()=>[S(ze,null,{default:P(()=>[ve("div",xl,[S(Ao,{dense:"",dark:"",outlined:"","hide-bottom-space":"",modelValue:t.filter,"onUpdate:modelValue":n[4]||(n[4]=d=>t.filter=d),color:"white",label:"Filter"},null,8,["modelValue"])])]),_:1})]),_:1},8,["style"]),S(Oo,{ref:"vlist",class:"scrollable",items:t.filteredInactiveDevices,"virtual-scroll-item-size":t.deviceItemHeight,style:it({height:`${t.inactiveDevicesHeight}px`})},{default:P(({item:d})=>[(N(),ae(f,{key:d.id,device:d,itemHeight:t.deviceItemHeight,class:"with-separator",onDeviceInListClicked:n[5]||(n[5]=p=>t.$emit("device-in-list-clicked"))},null,8,["device","itemHeight"]))]),_:1},8,["items","virtual-scroll-item-size","style"])])):(N(),ae(Je,{key:1,style:it({height:`${t.inactiveDevicesHeight+t.devicesFilterHeight}px`})},{default:P(()=>[S(Xe,{header:"",class:"ellipsis text-bold",style:{width:"100%","text-align":"center"}},{default:P(()=>n[9]||(n[9]=[X("No inactive devices left")])),_:1,__:[9]})]),_:1},8,["style"]))]),_:1})])}const Dl=kt(Cl,[["render",Il]]);function wo(t,n=document.body){if(typeof t!="string")throw new TypeError("Expected a string as propName");if(!(n instanceof Element))throw new TypeError("Expected a DOM element");return getComputedStyle(n).getPropertyValue(`--q-${t}`).trim()||null}const Al=yt(),cn=Do("telemetry",{state:()=>({isLoading:void 0,telemetry:{},updateIntervalId:0}),getters:{telemetryKeys(){return Object.keys(this.telemetry)}},actions:{setParameter(t){Object.keys(t).forEach(n=>{(!this.telemetry[n]||this.telemetry[n]&&this.telemetry[n].ts<=t[n].ts)&&(this.telemetry[n]=t[n])})},async unsubscribeDeviceTelemetry(t){clearInterval(this.updateIntervalId),this.$connector.socket.unsubscribe(`flespi/state/gw/devices/${t}/telemetry/+`),this.telemetry={},this.isLoading=void 0},async subscribeDeviceTelemetry(t){try{if(t>0){this.isLoading=!0;let n=[],a=()=>{n.forEach(u=>{let r=u.topic,h=u.payload,c=r.split("/").reverse()[0];if(c==="position")return!1;let f=h.toString(),d=u.properties&&u.properties.userProperties&&u.properties.userProperties.timestamp,p={[c]:{value:f,ts:d}};this.setParameter(p)}),n=[],this.isLoading=!1};await this.$connector.socket.subscribe({name:`flespi/state/gw/devices/${t}/telemetry/+`,handler(u,r,h){n.push(h)}}),this.updateIntervalId=setInterval(a,500)}}catch(n){Al.requestFailed(n)}}}}),Ol=Pt({name:"MessagesListItem",emits:["action","item-click"],props:["item","index","cols","itemHeight","rowWidth","selected","menuCellActive"],data(){return{}},computed:{values(){let t={};return this.cols.length?t=this.cols.reduce((n,a,u,r)=>(n[a.name]={value:this.getValueOfProp(a,this.item)},u===r.length-1&&(n.etc={value:""}),n),{}):t={etc:{value:""}},Object.keys(this.item).forEach(n=>{t[n]||(n.indexOf("image.bin.")!==-1?t.etc.value+=`${n}: <binary image>`:t.etc.value+=`${n}: ${JSON.stringify(this.item[n])}; `)}),t}},methods:{..._t(yt,["formatTimestampToDate"]),clickHandler(t,n,a){this.$emit("action",{index:t,type:n,content:a})},itemClickHandler(t,n){this.$emit("item-click",{index:t,content:n})},getValue(t){return typeof t=="string"?t:JSON.stringify(t)},getValueOfProp(t,n){const a=t.name;let u=n[a];return a.match(/timestamp$/)?u=this.formatTimestampToDate(u):typeof u!="string"&&(u=JSON.stringify(u)),u}}}),zl=["title"];function El(t,n,a,u,r,h){return N(),Re("div",{onClick:n[0]||(n[0]=c=>t.itemClickHandler(t.index,t.item)),class:Oe(["cursor-pointer",{[`row_${t.index}`]:!0,"missed-items":t.item["x-flespi-status"],"bg-white-opasity":t.selected,"item--telemetry-inited":t.item["x-flespi-inited-by-telemetry"],"item--invalid-position":t.item["position.valid"]===!1}]),style:it({height:`${t.itemHeight}px`,width:`${t.rowWidth}px`,borderBottom:t.item.delimiter?"solid 1px #f40":"",color:t.selected?"#333":""})},[(N(!0),Re(Ut,null,ni(t.cols,(c,f)=>(N(),Re(Ut,{key:f},[c.__dest==="etc"?(N(),Re("span",{class:Oe(["list__item item_etc",{[`item_${f}`]:!0,"item--active":t.menuCellActive&&t.menuCellActive.row===t.index&&t.menuCellActive.col===f}]),key:c.name+f},Be(t.values.etc.value||"*Empty*"),3)):(N(),Re("span",{key:1,class:Oe(["list__item",{[`item_${f}`]:!0,"item--active":t.menuCellActive&&t.menuCellActive.row===t.index&&t.menuCellActive.col===f}]),title:t.values[c.name].value},Be(t.values[c.name].value),11,zl))],64))),128))],6)}const $l=kt(Ol,[["render",El]]),Bl=Pt({name:"MessageViewer",emits:["close"],props:{message:{type:Object,required:!0},inverted:{type:Boolean}},data(){return{}},methods:{..._t(yt,["formatTimestampToDate"]),copy(t){zo(JSON.stringify(t)).then(n=>{this.$q.notify({color:"positive",icon:"mdi-content-copy",message:"Successfully copied",timeout:1e3})},n=>{this.$q.notify({color:"negative",icon:"mdi-content-copy",message:"Error coping",timeout:1e3})})},getValue(t,n){return t==="timestamp"?this.formatTimestampToDate(n):n},show(){this.$refs.modal.show()}}}),Rl={class:"layout-padding q-pa-md"},Fl={class:"text-weight-bold"},ql={class:"message-viewer__copy text-green cursor-pointer"},Hl={class:"message-viewer__name text-white"},Zl={class:"message-viewer__value text-green"};function Vl(t,n,a,u,r,h){return N(),ae(Io,{onHide:n[2]||(n[2]=c=>t.$emit("close")),ref:"modal"},{default:P(()=>[S(Cr,{style:it({minWidth:t.$q.platform.is.mobile?"100%":"30vw"}),class:Oe({"bg-grey-9":t.inverted!==void 0})},{default:P(()=>[S(Mr,{style:it({height:t.$q.platform.is.mobile?"calc(100% - 52px)":""}),class:"scroll q-pa-none"},{default:P(()=>[ve("div",Rl,[(N(!0),Re(Ut,null,ni(t.message,(c,f,d)=>(N(),Re("div",{class:"row items-center",key:d},[ve("div",Fl,[ve("span",ql,[S(ot,{name:"mdi-content-copy",onClick:p=>t.copy(`${f}: ${c}`)},null,8,["onClick"])]),ve("span",Hl,Be(f)+": ",1),ve("span",Zl,Be(t.getValue(f,c)),1)])]))),128))])]),_:1},8,["style"]),S(Sr,{color:"white"}),S(xr,{align:"right",class:"bg-grey-9 text-white"},{default:P(()=>[S(je,{flat:"",onClick:n[0]||(n[0]=c=>t.copy(t.message))},{default:P(()=>n[3]||(n[3]=[X("Copy full message")])),_:1,__:[3]}),S(je,{flat:"",onClick:n[1]||(n[1]=c=>t.$refs.modal.hide())},{default:P(()=>n[4]||(n[4]=[X("Close")])),_:1,__:[4]})]),_:1})]),_:1},8,["style","class"])]),_:1},512)}const Nl=kt(Bl,[["render",Vl]]),Xs={actions:[{icon:"mdi-eye",label:"Show message",classes:"",type:"view"}],viewConfig:{needShowDateRange:!1,needShowFilter:!1},theme:{color:"white",bgColor:"grey-9",contentInverted:!0,controlsInverted:!0}},Ul=Pt({name:"DeviceMessages",components:{MessagesListItem:$l,MessageViewer:Nl,VirtualScrollList:Ir},emits:["view-message-content","view-on-map"],props:["activeMessagesIds","id","limit"],data(){const t=document.createElement("style");t.type="text/css";const a=(document.head||document.getElementsByTagName("head")[0]).appendChild(t);return{actions:Xs.actions,dynamicCSS:a,selectedMessageContent:void 0,theme:Xs.theme,viewConfig:Xs.viewConfig}},computed:{currentLimit:{get(){return this.messagesStore.limit},set(t){t=t||0,this.messagesStore.setLimit(t)}},messagesStore(){return this.getMessagesStore(this.id)},selectedMessageIndex:{get(){let n=this.messagesStore.selected.slice(-1)[0];return n===void 0?-1:n},set(t){this.messagesStore.setSelected([t])}}},methods:{..._t(yt,["getMessagesStore"]),actionHandler({index:t,type:n,content:a}){n==="view"&&(this.selectedMessageContent=a,this.selectedMessageIndex=t,this.highlightSelectedMessage(),this.$refs.messageViewer.show(),this.$emit("view-message-content"))},closeMessageViewerHandler(){this.selectedMessageContent=void 0,this.selectedMessageIndex=-1,this.highlightSelectedMessage()},highlightSelectedMessage(){let t="";this.selectedMessageIndex!==-1&&(t=`.row_${this.selectedMessageIndex} {background-color: rgba(255,255,255,0.7)!important; color: #333;}`),this.updateDynamicCSS(t)},messageListItemClickHandler({index:t,content:n}){this.selectedMessageIndex===t?this.selectedMessageIndex=-1:this.selectedMessageIndex=t,this.highlightSelectedMessage(),this.$emit("view-on-map",n)},messageShow(t){this.selectedMessageIndex!==t[t.length-1]&&(this.selectedMessageIndex=t[t.length-1],this.highlightSelectedMessage(),this.scrollToSelected())},scrollToSelected(){if(this.selectedMessageIndex>=0&&this.$refs.scrollList){const t=this.$refs.scrollList.itemsCount;let n=this.selectedMessageIndex-Math.floor(t/2);n<0&&(n=0),this.$refs.scrollList.scrollTo(n)}},toBottomClickHandler(){},updateDynamicCSS(t){this.dynamicCSS.styleSheet?this.dynamicCSS.styleSheet.cssText=t:this.dynamicCSS.innerText=t},updateColsHandler(t){this.messagesStore.setCols(t)}},watch:{activeMessagesIds(t){this.messageShow(t)},limit(t){this.currentLimit=t},selectedMessageIndex(){this.selectedMessageIndex>0&&this.scrollToSelected(this.selectedMessageIndex),this.highlightSelectedMessage()}},created(){const t=dt().getDeviceById(this.id);t&&t.device_type_id&&this.messagesStore.syncColsFromLS(dt().getDeviceById(this.id).device_type_id),this.currentLimit=this.limit,this.highlightSelectedMessage(this.activeMessagesIds)},unmounted(){this.messagesStore.clearSelected(),this.dynamicCSS.parentNode.removeChild(this.dynamicCSS)}});function Wl(t,n,a,u,r,h){const c=ft("messages-list-item"),f=ft("virtual-scroll-list"),d=ft("message-viewer");return N(),Re("div",null,[S(f,{ref:"scrollList",actions:t.actions,cols:t.messagesStore.cols,items:t.messagesStore.messages,theme:t.theme,viewConfig:t.viewConfig,class:"scrollable",onActionToBottom:t.toBottomClickHandler,onAction:t.actionHandler,onUpdateCols:t.updateColsHandler},{"list-item":P(({item:p,index:g,cols:y,itemHeight:v,rowWidth:k})=>[S(c,{item:p,index:g,cols:y,itemHeight:v,rowWidth:k,menuCellActive:!0,selected:!1,onItemClick:t.messageListItemClickHandler},null,8,["item","index","cols","itemHeight","rowWidth","onItemClick"])]),_:1},8,["actions","cols","items","theme","viewConfig","onActionToBottom","onAction","onUpdateCols"]),S(d,{inverted:"",ref:"messageViewer",message:typeof t.selectedMessageContent<"u"?t.selectedMessageContent:{},onClose:t.closeMessageViewerHandler},null,8,["message","onClose"])])}const Gl=kt(Ul,[["render",Wl]]),Kt={MIN:0,RANGE:1,MAX:2},jl=bt({name:"QRange",props:{...$o,modelValue:{type:Object,default:()=>({min:null,max:null}),validator:t=>"min"in t&&"max"in t},dragRange:Boolean,dragOnlyRange:Boolean,leftLabelColor:String,leftLabelTextColor:String,rightLabelColor:String,rightLabelTextColor:String,leftLabelValue:[String,Number],rightLabelValue:[String,Number],leftThumbColor:String,rightThumbColor:String},emits:Bo,setup(t,{emit:n}){const{proxy:{$q:a}}=wt(),{state:u,methods:r}=Ro({updateValue:fe,updatePosition:xe,getDragging:Le,formAttrs:w(()=>({type:"hidden",name:t.name,value:`${t.modelValue.min}|${t.modelValue.max}`}))}),h=he(null),c=he(0),f=he(0),d=he({min:0,max:0});function p(){d.value.min=t.modelValue.min===null?u.innerMin.value:rt(t.modelValue.min,u.innerMin.value,u.innerMax.value),d.value.max=t.modelValue.max===null?u.innerMax.value:rt(t.modelValue.max,u.innerMin.value,u.innerMax.value)}He(()=>`${t.modelValue.min}|${t.modelValue.max}|${u.innerMin.value}|${u.innerMax.value}`,p),p();const g=w(()=>r.convertModelToRatio(d.value.min)),y=w(()=>r.convertModelToRatio(d.value.max)),v=w(()=>u.active.value===!0?c.value:g.value),k=w(()=>u.active.value===!0?f.value:y.value),C=w(()=>{const F={[u.positionProp.value]:`${100*v.value}%`,[u.sizeProp.value]:`${100*(k.value-v.value)}%`};return t.selectionImg!==void 0&&(F.backgroundImage=`url(${t.selectionImg}) !important`),F}),I=w(()=>{if(u.editable.value!==!0)return{};if(a.platform.is.mobile===!0)return{onClick:r.onMobileClick};const F={onMousedown:r.onActivate};return(t.dragRange===!0||t.dragOnlyRange===!0)&&Object.assign(F,{onFocus:()=>{u.focus.value="both"},onBlur:r.onBlur,onKeydown:le,onKeyup:r.onKeyup}),F});function D(F){return a.platform.is.mobile!==!0&&u.editable.value===!0&&t.dragOnlyRange!==!0?{onFocus:()=>{u.focus.value=F},onBlur:r.onBlur,onKeydown:le,onKeyup:r.onKeyup}:{}}const A=w(()=>t.dragOnlyRange!==!0?u.tabindex.value:null),q=w(()=>a.platform.is.mobile!==!0&&(t.dragRange||t.dragOnlyRange===!0)?u.tabindex.value:null),z=he(null),B=w(()=>D("min")),G=r.getThumbRenderFn({focusValue:"min",getNodeData:()=>({ref:z,key:"tmin",...B.value,tabindex:A.value}),ratio:v,label:w(()=>t.leftLabelValue!==void 0?t.leftLabelValue:d.value.min),thumbColor:w(()=>t.leftThumbColor||t.thumbColor||t.color),labelColor:w(()=>t.leftLabelColor||t.labelColor),labelTextColor:w(()=>t.leftLabelTextColor||t.labelTextColor)}),ee=w(()=>D("max")),re=r.getThumbRenderFn({focusValue:"max",getNodeData:()=>({...ee.value,key:"tmax",tabindex:A.value}),ratio:k,label:w(()=>t.rightLabelValue!==void 0?t.rightLabelValue:d.value.max),thumbColor:w(()=>t.rightThumbColor||t.thumbColor||t.color),labelColor:w(()=>t.rightLabelColor||t.labelColor),labelTextColor:w(()=>t.rightLabelTextColor||t.labelTextColor)});function fe(F){(d.value.min!==t.modelValue.min||d.value.max!==t.modelValue.max)&&n("update:modelValue",{...d.value}),F===!0&&n("change",{...d.value})}function Le(F){const{left:K,top:H,width:J,height:W}=h.value.getBoundingClientRect(),Se=t.dragOnlyRange===!0?0:t.vertical===!0?z.value.offsetHeight/(2*W):z.value.offsetWidth/(2*J),Z={left:K,top:H,width:J,height:W,valueMin:d.value.min,valueMax:d.value.max,ratioMin:g.value,ratioMax:y.value},Ze=r.getDraggingRatio(F,Z);return t.dragOnlyRange!==!0&&Ze<Z.ratioMin+Se?Z.type=Kt.MIN:t.dragOnlyRange===!0||Ze<Z.ratioMax-Se?t.dragRange===!0||t.dragOnlyRange===!0?(Z.type=Kt.RANGE,Object.assign(Z,{offsetRatio:Ze,offsetModel:r.convertRatioToModel(Ze),rangeValue:Z.valueMax-Z.valueMin,rangeRatio:Z.ratioMax-Z.ratioMin})):Z.type=Z.ratioMax-Ze<Ze-Z.ratioMin?Kt.MAX:Kt.MIN:Z.type=Kt.MAX,Z}function xe(F,K=u.dragging.value){let H;const J=r.getDraggingRatio(F,K),W=r.convertRatioToModel(J);switch(K.type){case Kt.MIN:J<=K.ratioMax?(H={minR:J,maxR:K.ratioMax,min:W,max:K.valueMax},u.focus.value="min"):(H={minR:K.ratioMax,maxR:J,min:K.valueMax,max:W},u.focus.value="max");break;case Kt.MAX:J>=K.ratioMin?(H={minR:K.ratioMin,maxR:J,min:K.valueMin,max:W},u.focus.value="max"):(H={minR:J,maxR:K.ratioMin,min:W,max:K.valueMin},u.focus.value="min");break;case Kt.RANGE:const Se=J-K.offsetRatio,Z=rt(K.ratioMin+Se,u.innerMinRatio.value,u.innerMaxRatio.value-K.rangeRatio),Ze=W-K.offsetModel,Y=rt(K.valueMin+Ze,u.innerMin.value,u.innerMax.value-K.rangeValue);H={minR:Z,maxR:Z+K.rangeRatio,min:u.roundValueFn.value(Y),max:u.roundValueFn.value(Y+K.rangeValue)},u.focus.value="both";break}d.value=d.value.min===null||d.value.max===null?{min:H.min||t.min,max:H.max||t.max}:{min:H.min,max:H.max},t.snap!==!0||t.step===0?(c.value=H.minR,f.value=H.maxR):(c.value=r.convertModelToRatio(d.value.min),f.value=r.convertModelToRatio(d.value.max))}function le(F){if(hn.includes(F.keyCode)===!1)return;Ft(F);const K=([34,33].includes(F.keyCode)?10:1)*u.keyStep.value,H=([34,37,40].includes(F.keyCode)?-1:1)*(u.isReversed.value===!0?-1:1)*(t.vertical===!0?-1:1)*K;if(u.focus.value==="both"){const J=d.value.max-d.value.min,W=rt(u.roundValueFn.value(d.value.min+H),u.innerMin.value,u.innerMax.value-J);d.value={min:W,max:u.roundValueFn.value(W+J)}}else{if(u.focus.value===!1)return;{const J=u.focus.value;d.value={...d.value,[J]:rt(u.roundValueFn.value(d.value[J]+H),J==="min"?u.innerMin.value:d.value.min,J==="max"?u.innerMax.value:d.value.max)}}}fe()}return()=>{const F=r.getContent(C,q,I,K=>{K.push(G(),re())});return E("div",{ref:h,class:"q-range "+u.classes.value+(t.modelValue.min===null||t.modelValue.max===null?" q-slider--no-value":""),...u.attributes.value,"aria-valuenow":t.modelValue.min+"|"+t.modelValue.max},F)}}}),Kl=tn({name:"touch-hold",beforeMount(t,n){const{modifiers:a}=n;if(a.mouse!==!0&&gt.has.touch!==!0)return;const u={handler:n.value,noop:sn,mouseStart(h){typeof u.handler=="function"&&nn(h)===!0&&(St(u,"temp",[[document,"mousemove","move","passiveCapture"],[document,"click","end","notPassiveCapture"]]),u.start(h,!0))},touchStart(h){if(h.target!==void 0&&typeof u.handler=="function"){const c=h.target;St(u,"temp",[[c,"touchmove","move","passiveCapture"],[c,"touchcancel","end","notPassiveCapture"],[c,"touchend","end","notPassiveCapture"]]),u.start(h)}},start(h,c){u.origin=Yt(h);const f=Date.now();gt.is.mobile===!0&&(document.body.classList.add("non-selectable"),Ri(),u.styleCleanup=d=>{u.styleCleanup=void 0;const p=()=>{document.body.classList.remove("non-selectable")};d===!0?(Ri(),setTimeout(p,10)):p()}),u.triggered=!1,u.sensitivity=c===!0?u.mouseSensitivity:u.touchSensitivity,u.timer=setTimeout(()=>{u.timer=void 0,Ri(),u.triggered=!0,u.handler({evt:h,touch:c!==!0,mouse:c===!0,position:u.origin,duration:Date.now()-f})},u.duration)},move(h){const{top:c,left:f}=Yt(h);u.timer!==void 0&&(Math.abs(f-u.origin.left)>=u.sensitivity||Math.abs(c-u.origin.top)>=u.sensitivity)&&(clearTimeout(u.timer),u.timer=void 0)},end(h){Nt(u,"temp"),u.styleCleanup?.(u.triggered),u.triggered===!0?h!==void 0&&Ft(h):u.timer!==void 0&&(clearTimeout(u.timer),u.timer=void 0)}},r=[600,5,7];if(typeof n.arg=="string"&&n.arg.length!==0&&n.arg.split(":").forEach((h,c)=>{const f=parseInt(h,10);f&&(r[c]=f)}),[u.duration,u.touchSensitivity,u.mouseSensitivity]=r,t.__qtouchhold=u,a.mouse===!0){const h=a.mouseCapture===!0||a.mousecapture===!0?"Capture":"";St(u,"main",[[t,"mousedown","mouseStart",`passive${h}`]])}gt.has.touch===!0&&St(u,"main",[[t,"touchstart","touchStart",`passive${a.capture===!0?"Capture":""}`],[t,"touchend","noop","notPassiveCapture"]])},updated(t,n){const a=t.__qtouchhold;a!==void 0&&n.oldValue!==n.value&&(typeof n.value!="function"&&a.end(),a.handler=n.value)},beforeUnmount(t){const n=t.__qtouchhold;n!==void 0&&(Nt(n,"main"),Nt(n,"temp"),n.timer!==void 0&&clearTimeout(n.timer),n.styleCleanup?.(),delete t.__qtouchhold)}}),Ql=Pt({name:"MessagesPlayer",emits:["update:modelValue","player-next","player-pause","player-play","player-prev","player-speed","player-stop","switch-player-mode","switch-show-messages"],props:["min","max","mode","modelValue","needShowMessages","speed","status"],data(){return{current:0,currentSpeed:this.speed,currentStatus:this.status,currentValue:this.modelValue,percentsByPixel:0,rangeMin:this.min,rangeMax:this.max,repeatFlag:!1,timer:0}},computed:{range:{get(){return{min:this.rangeMin,max:this.rangeMax}},set(t){this.pause(),this.currentValue<=t.min&&(this.currentValue=t.min),this.currentValue>t.max&&(this.currentValue=t.max,this.end()),this.rangeMin=t.min,this.rangeMax=t.max}}},methods:{checkNeedRedraw(t){Math.abs(t-this.current)>=this.percentsByPixel&&(this.current=t)},changeCurrent(){const t=this.currentValue+1;if(t>this.rangeMax)return this.pause(),!1;this.currentValue=t},changeSpeed(t){this.currentSpeed=t,this.$emit("player-speed",t)},dragPlayerControl(t){if(this.max<=this.min||this.mode==="data")return!1;const{left:n,step:a}=this.getPlayerParams();let u=this.min+(t.position.left-n)/a;u<this.rangeMin&&(u=this.rangeMin),u>this.rangeMax&&(u=this.rangeMax),this.currentValue=t.isFinal?Math.round(u):u},emitCurrentValue(t){this.$emit("update:modelValue",Math.round(t))},end(){this.modelValue!==this.currentValue&&setTimeout(()=>{this.$emit("update:modelValue",this.currentValue)},100)},getPlayerParams(){const t=this.$refs.playerContainer,n=t.getBoundingClientRect().left,a=t.offsetWidth,u=a/(this.max-this.min);return{left:n,width:a,step:u}},lineClickHandler(t){if(this.max<=this.min||this.mode==="data")return!1;const n=t.clientX,{left:a,step:u}=this.getPlayerParams(),r=this.min+(n-a)/u;if(this.currentValue!==r){if(r<this.rangeMin||r>this.rangeMax)return!1;this.currentValue=Math.round(r)}},pause(){if(this.repeatFlag&&this.currentValue===this.max)return setTimeout(()=>{this.currentValue=this.min},600),!1;this.timer&&(clearInterval(this.timer),this.timer=0,this.currentStatus==="play"&&(this.end(),this.currentStatus="pause",this.status!==this.currentStatus&&this.$emit("player-pause")))},play(){(this.currentStatus==="pause"||this.currentStatus==="stop")&&(this.currentStatus="play",this.status!==this.currentStatus&&this.$emit("player-play")),this.currentValue===this.max&&(this.currentValue=this.min),this.timer=setInterval(this.changeCurrent,1e3/this.currentSpeed)},playClickHandler(){switch(this.currentStatus){case"stop":case"pause":{this.play();break}case"play":{this.pause();break}}},playRepeatClickHandler(){this.repeatFlag=!this.repeatFlag,this.currentStatus==="pause"&&this.playClickHandler()},processChangedSpeed(){this.$refs.currentSpeedPopover.hide(),this.currentStatus==="play"&&(this.pause(),this.$nextTick(this.play))},stop(){this.timer&&(clearInterval(this.timer),this.timer=0),(this.currentStatus==="play"||this.currentStatus==="pause")&&(this.currentStatus="stop",this.currentValue=this.min),this.status!==this.currentStatus&&this.$emit("player-stop")}},created(){this.debouncedProcessChangedSpeed=ps(this.processChangedSpeed,100),this.throttledEmitCurrentValue=xo(this.emitCurrentValue,100)},mounted(){this.$refs.playerContainer&&(this.percentsByPixel=100/this.$refs.playerContainer.offsetWidth)},watch:{currentSpeed(){this.debouncedProcessChangedSpeed()},currentValue(t){this.throttledEmitCurrentValue(t)},max(t,n){this.rangeMax===n&&(this.rangeMax=t)},min(t,n){this.rangeMin===n&&(this.rangeMin=t)},mode(t){this.currentMode=t,this.current=0,this.currentValue=this.min,this.timer&&clearInterval(this.timer)},modelValue(t){const n=(t-this.min)/(this.max-this.min)*100;if(this.checkNeedRedraw(n),t===this.currentValue)return!1;this.currentValue=t}},beforeUnmount(){this.stop()}}),Yl={class:"col-12 col-md-auto"},Xl={style:{width:"66px"}},Jl={class:"col-12 col-md relative-position"},eu={class:"player"},tu={class:"player__main"},iu={class:"player__container",style:{transform:"translate3d(0, 0, 0)"},ref:"playerContainer"};function su(t,n,a,u,r,h){return N(),Re("div",{class:"row",style:it([{"background-color":"#424242"},{height:t.needShowMessages?"auto":"100%"}])},[ve("div",Yl,[S(je,{round:"",flat:"",icon:"mdi-mail",color:t.needShowMessages?"blue":"white",size:t.$q.platform.is.desktop?"1rem":"md",onClick:n[0]||(n[0]=c=>t.$emit("switch-show-messages"))},{default:P(()=>[t.$q.platform.is.desktop?(N(),ae(De,{key:0},{default:P(()=>n[6]||(n[6]=[X("Messages")])),_:1,__:[6]})):Pe("",!0)]),_:1},8,["color","size"]),S(je,{round:"",flat:"",color:"white",icon:t.mode==="time"?"mdi-map-clock-outline":"mdi-map-marker-distance",disable:t.max<=t.min||t.status==="play",size:t.$q.platform.is.desktop?"1rem":"md",onClick:n[1]||(n[1]=c=>t.$emit("switch-player-mode"))},{default:P(()=>[t.$q.platform.is.desktop?(N(),ae(De,{key:0},{default:P(()=>n[7]||(n[7]=[X("Change mode (Time/Data)")])),_:1,__:[7]})):Pe("",!0)]),_:1},8,["icon","disable","size"]),S(je,{flat:"",class:"text-white",disable:t.max<=t.min,size:t.$q.platform.is.desktop?"1rem":"md"},{default:P(()=>[ve("span",{style:it({width:(t.$q.platform.is.desktop,"28px")})},"x"+Be(t.currentSpeed),5),S(ms,{ref:"currentSpeedPopover",anchor:"top left",style:{"background-color":"#424242"}},{default:P(()=>[ve("div",Xl,[(N(),Re(Ut,null,ni([100,70,50,30,10,1],c=>S(je,{flat:"",key:c,class:"text-white bg-grey-9 no-border-radius full-width",size:t.$q.platform.is.desktop?"1rem":"md",onClick:f=>t.changeSpeed(c)},{default:P(()=>[X(" x"+Be(c),1)]),_:2},1032,["size","onClick"])),64))])]),_:1},512),t.$q.platform.is.desktop?(N(),ae(De,{key:0},{default:P(()=>n[8]||(n[8]=[X("Player speed")])),_:1,__:[8]})):Pe("",!0)]),_:1},8,["disable","size"]),bi((N(),ae(je,{round:"",flat:"",color:t.currentStatus==="play"?"blue":"white",disable:t.max<=t.min,class:"text-white",size:t.$q.platform.is.desktop?"1rem":"md",icon:t.currentStatus==="play"?t.repeatFlag?"mdi-repeat":"mdi-pause":"mdi-play",onClick:[t.playClickHandler,Qt(t.playRepeatClickHandler,["ctrl"])]},{default:P(()=>[t.$q.platform.is.desktop?(N(),ae(De,{key:0},{default:P(()=>n[9]||(n[9]=[X("Play/Pause (Ctrl+Click to repeat)")])),_:1,__:[9]})):Pe("",!0),t.$q.platform.is.mobile?(N(),ae(De,{key:1},{default:P(()=>n[10]||(n[10]=[X("Play/Pause (Touch hold to repeat)")])),_:1,__:[10]})):Pe("",!0)]),_:1},8,["color","disable","size","icon","onClick"])),[[Kl,t.playRepeatClickHandler,void 0,{noMouse:!0}]]),S(je,{round:"",flat:"",icon:"mdi-stop",color:"white",class:"text-white",disable:t.max<=t.min,size:t.$q.platform.is.desktop?"1rem":"md",onClick:t.stop},{default:P(()=>[t.$q.platform.is.desktop?(N(),ae(De,{key:0},{default:P(()=>n[11]||(n[11]=[X("Stop")])),_:1,__:[11]})):Pe("",!0)]),_:1},8,["disable","size","onClick"])]),ve("div",Jl,[S(je,{round:"",flat:"",class:"absolute-left text-white",icon:"mdi-skip-previous",disable:t.max<=t.min||t.mode==="data",size:t.$q.platform.is.desktop?"1rem":"md",onClick:n[2]||(n[2]=c=>t.$emit("player-prev"))},{default:P(()=>[t.$q.platform.is.desktop?(N(),ae(De,{key:0},{default:P(()=>n[12]||(n[12]=[X("Prev message")])),_:1,__:[12]})):Pe("",!0)]),_:1},8,["disable","size"]),ve("div",eu,[ve("div",tu,[ve("div",iu,[t.max>t.min&&t.mode==="time"?(N(),ae(jl,{key:0,modelValue:t.range,"onUpdate:modelValue":n[3]||(n[3]=c=>t.range=c),color:"white",min:t.min,max:t.max,step:1},null,8,["modelValue","min","max"])):Pe("",!0),ve("div",{class:Oe(["player__line cursor-pointer",{disabled:t.max<=t.min||t.mode==="data"}]),onClick:n[4]||(n[4]=(...c)=>t.lineClickHandler&&t.lineClickHandler(...c))},[ve("div",{class:"line line__disabled line__disabled--left",style:it({width:`${100*(t.rangeMin-t.min)/(t.max-t.min)}%`})},null,4),ve("div",{class:"line line__active",style:it({left:`${t.mode==="time"?t.current:0}%`,width:`${100-(t.mode==="time"?t.current:0)-(t.max>0?100/t.max*(t.max-t.rangeMax):0)}%`})},null,4),ve("div",{class:"line line__disabled line__disabled--right",style:it({width:`${100/(t.max-t.min)*(t.max-t.rangeMax)}%`})},null,4)],2),bi(ve("div",{style:it({left:`${t.mode==="time"?t.current:0}%`}),class:Oe(["player__control cursor-pointer",{"player__control--mobile":t.$q.platform.is.mobile,"player__control--disabled":t.max<=t.min||t.mode==="data",disabled:t.max<=t.min||t.mode==="data"}])},null,6),[[yi,t.dragPlayerControl,void 0,{horizontal:!0,mouse:!0}]])],512)])]),S(je,{round:"",flat:"",class:"absolute-right text-white",icon:"mdi-skip-next",disable:t.max<=t.min||t.mode==="data",size:t.$q.platform.is.desktop?"1rem":"md",onClick:n[5]||(n[5]=c=>t.$emit("player-next"))},{default:P(()=>[t.$q.platform.is.desktop?(N(),ae(De,{key:0},{default:P(()=>n[13]||(n[13]=[X("Next message")])),_:1,__:[13]})):Pe("",!0)]),_:1},8,["disable","size"])])],4)}const nu=kt(Ql,[["render",su]]),ou=Pt({name:"QueueItem",components:{MessagesGrid:Gl,MessagesPlayer:nu},emits:["change-need-show-messages","player-mode","player-pause","player-play","player-speed","player-stop","player-value","view-on-map"],props:["id","needShowMessages","needShowPlayer","player"],data(){return{activeMessagesIndexes:[],messagesFlag:this.needShowMessages,playerHeight:0,playerMode:this.player.mode||"time",playerStatus:"stop",playerValue:0}},computed:{...Rt(yt,{date:t=>t.date}),height(){return this.needShowMessages&&this.needShowPlayer?`calc(22vh + ${this.playerHeight}px)`:this.needShowMessages&&!this.needShowPlayer?"22vh":!this.needShowMessages&&this.needShowPlayer?`${this.playerHeight}px`:"0vh"},indexesByTimestamp(){return this.messages.reduce((t,n,a)=>{const u=Math.floor(n.timestamp);return t[u]||(t[u]=[]),t[u].push(a),t},{})},timeRange(){return this.messages.length?{min:Math.floor(this.messages[0].timestamp),max:Math.floor(this.messages[this.messages.length-1].timestamp)}:{min:0,max:0}},messages(){return this.getMessagesStore(this.id).messages}},methods:{..._t(yt,["getMessagesStore"]),getCurrentActiveTimestamp(){let t=0;return Object.keys(this.indexesByTimestamp).every((a,u)=>this.playerValue>=a?(t=a,!0):!1),t},onResizePlayer(t){this.playerHeight=t.height},playerNextHandler(){const t=Object.keys(this.indexesByTimestamp),n=t.indexOf(this.getCurrentActiveTimestamp());if(n===t.length-1)return this.$q.notify({message:"That`s the last message",color:"info",position:"bottom-left"}),!1;this.playerValue=t[n+1]},playerPauseHandler(){this.playerStatus="pause",this.$emit("player-pause",{id:this.id})},playerPlayHandler(){this.playerStatus="play",this.playerValue||(this.playerValue=Math.floor(this.messages[0].timestamp)),this.$emit("player-play",{id:this.id})},playerPrevHandler(){const t=Object.keys(this.indexesByTimestamp),n=t.indexOf(this.getCurrentActiveTimestamp());if(n===0)return this.$q.notify({message:"That`s the first message",color:"info",position:"bottom-left"}),!1;this.playerValue=t[n-1]},playerSpeedHandler(t){this.$emit("player-speed",{id:this.id,speed:t})},playerStopHandler(){this.playerStatus="stop",this.messages.length?this.playerValue=Math.floor(this.messages[0].timestamp):this.playerValue=0,this.$emit("player-stop",{id:this.id})},switchPlayerMode(){this.playerMode=this.playerMode==="data"?"time":"data",this.$emit("player-mode",{mode:this.playerMode,id:this.id})},switchShowMessages(){this.messagesFlag=!this.messagesFlag,this.$emit("change-need-show-messages",this.messagesFlag)},viewMessageContentHandler(){this.$refs.player&&this.playerStatus!=="stop"&&this.$refs.player.stop()}},watch:{date(){this.playerValue=0,this.playerStatus="stop"},needShowMessages(t){this.messagesFlag=t},player:{deep:!0,handler(t){this.activeMessagesIndexes&&this.activeMessagesIndexes[0]!==t.currentMsgIndex&&(this.activeMessagesIndexes=[t.currentMsgIndex])}},playerValue(t,n){let a=0,u=!0;const r=Object.keys(this.indexesByTimestamp);r.every((h,c)=>t>=h?(a=h,c===r.length-1&&(u=!1),!0):((n>=h||n<a)&&(u=!1),!1)),!u&&this.playerMode==="time"&&(this.$emit("player-value",{id:this.id,messagesIndexes:this.indexesByTimestamp[a]}),this.activeMessagesIndexes=this.indexesByTimestamp[a]||[])}},mounted(){this.$refs.playerResize}});function au(t,n,a,u,r,h){const c=ft("messages-grid"),f=ft("messages-player");return N(),Re("div",{style:it([{height:t.height}])},[t.needShowMessages?(N(),Re("div",{key:0,style:it({height:t.needShowPlayer?`calc(100% - ${t.playerHeight}px)`:"100%"}),class:"table__wrapper"},[S(c,{style:{height:"100%"},activeMessagesIds:t.activeMessagesIndexes,id:t.id,limit:0,onViewMessageContent:t.viewMessageContentHandler,onViewOnMap:n[0]||(n[0]=d=>{t.$emit("view-on-map",d)})},null,8,["activeMessagesIds","id","onViewMessageContent"])],4)):Pe("",!0),ve("div",null,[S(wi,{onResize:t.onResizePlayer,ref:"playerResize"},null,8,["onResize"]),S(f,{ref:"player",modelValue:t.playerValue,"onUpdate:modelValue":n[1]||(n[1]=d=>t.playerValue=d),min:t.timeRange.min,max:t.timeRange.max,mode:t.player.mode,needShowMessages:t.needShowMessages,speed:t.player.speed,status:t.player.status,onPlayerNext:t.playerNextHandler,onPlayerPrev:t.playerPrevHandler,onPlayerPlay:t.playerPlayHandler,onPlayerPause:t.playerPauseHandler,onPlayerStop:t.playerStopHandler,onPlayerSpeed:t.playerSpeedHandler,onSwitchShowMessages:t.switchShowMessages,onSwitchPlayerMode:t.switchPlayerMode},null,8,["modelValue","min","max","mode","needShowMessages","speed","status","onPlayerNext","onPlayerPrev","onPlayerPlay","onPlayerPause","onPlayerStop","onPlayerSpeed","onSwitchShowMessages","onSwitchPlayerMode"])])],4)}const ru=kt(ou,[["render",au]]),lu=Pt({name:"DevicesQueue",components:{QueueItem:ru},emits:["change-need-show-messages","player-mode","player-pause","player-play","player-speed","player-stop","player-value","view-on-map"],props:["needShowMessages","needShowPlayer","player","selectedDeviceId"],computed:{...Rt(dt,{activeDevicesIDs:t=>t.activeDevicesIDs})},data(){return{selected:null}},watch:{activeDevicesIDs:{deep:!0,handler(t){t.length||(this.selected=""),(!this.selected||!t.includes(parseInt(this.selected)))&&t.length&&(this.selected=t[t.length-1].toString())}},selectedDeviceId(t){t&&(this.selected=t.toString())}}}),uu={id:"queue",class:"absolute-bottom-left absolute-bottom-right"};function hu(t,n,a,u,r,h){const c=ft("queue-item");return N(),Re("div",uu,[S(Fo,{modelValue:t.selected,"onUpdate:modelValue":n[8]||(n[8]=f=>t.selected=f),animated:"",style:{background:"rgba(0, 0, 0, 0.5)"}},{default:P(()=>[(N(!0),Re(Ut,null,ni(t.activeDevicesIDs,f=>(N(),ae(hs,{class:"no-padding no-scroll",name:f.toString(),key:`tab-panel-${f}`},{default:P(()=>[S(c,{id:f,needShowMessages:t.needShowMessages,needShowPlayer:t.needShowPlayer,player:t.player,onChangeNeedShowMessages:n[0]||(n[0]=d=>{t.$emit("change-need-show-messages",d)}),onPlayerMode:n[1]||(n[1]=d=>t.$emit("player-mode",d)),onPlayerPause:n[2]||(n[2]=d=>t.$emit("player-pause",d)),onPlayerPlay:n[3]||(n[3]=d=>t.$emit("player-play",d)),onPlayerSpeed:n[4]||(n[4]=d=>t.$emit("player-speed",d)),onPlayerStop:n[5]||(n[5]=d=>t.$emit("player-stop",d)),onPlayerValue:n[6]||(n[6]=d=>t.$emit("player-value",d)),onViewOnMap:n[7]||(n[7]=d=>{t.$emit("view-on-map",d)})},null,8,["id","needShowMessages","needShowPlayer","player"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])}const cu=kt(lu,[["render",hu]]);var Bi={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var du=Bi.exports,ko;function dn(){return ko||(ko=1,function(t,n){(function(a,u){u(n)})(du,function(a){var u="1.9.4";function r(e){var i,s,o,l;for(s=1,o=arguments.length;s<o;s++){l=arguments[s];for(i in l)e[i]=l[i]}return e}var h=Object.create||function(){function e(){}return function(i){return e.prototype=i,new e}}();function c(e,i){var s=Array.prototype.slice;if(e.bind)return e.bind.apply(e,s.call(arguments,1));var o=s.call(arguments,2);return function(){return e.apply(i,o.length?o.concat(s.call(arguments)):arguments)}}var f=0;function d(e){return"_leaflet_id"in e||(e._leaflet_id=++f),e._leaflet_id}function p(e,i,s){var o,l,m,_;return _=function(){o=!1,l&&(m.apply(s,l),l=!1)},m=function(){o?l=arguments:(e.apply(s,arguments),setTimeout(_,i),o=!0)},m}function g(e,i,s){var o=i[1],l=i[0],m=o-l;return e===o&&s?e:((e-l)%m+m)%m+l}function y(){return!1}function v(e,i){if(i===!1)return e;var s=Math.pow(10,i===void 0?6:i);return Math.round(e*s)/s}function k(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function C(e){return k(e).split(/\s+/)}function I(e,i){Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?h(e.options):{});for(var s in i)e.options[s]=i[s];return e.options}function D(e,i,s){var o=[];for(var l in e)o.push(encodeURIComponent(s?l.toUpperCase():l)+"="+encodeURIComponent(e[l]));return(!i||i.indexOf("?")===-1?"?":"&")+o.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function q(e,i){return e.replace(A,function(s,o){var l=i[o];if(l===void 0)throw new Error("No value provided for variable "+s);return typeof l=="function"&&(l=l(i)),l})}var z=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function B(e,i){for(var s=0;s<e.length;s++)if(e[s]===i)return s;return-1}var G="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function ee(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var re=0;function fe(e){var i=+new Date,s=Math.max(0,16-(i-re));return re=i+s,window.setTimeout(e,s)}var Le=window.requestAnimationFrame||ee("RequestAnimationFrame")||fe,xe=window.cancelAnimationFrame||ee("CancelAnimationFrame")||ee("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function le(e,i,s){if(s&&Le===fe)e.call(i);else return Le.call(window,c(e,i))}function F(e){e&&xe.call(window,e)}var K={__proto__:null,extend:r,create:h,bind:c,get lastId(){return f},stamp:d,throttle:p,wrapNum:g,falseFn:y,formatNum:v,trim:k,splitWords:C,setOptions:I,getParamString:D,template:q,isArray:z,indexOf:B,emptyImageUrl:G,requestFn:Le,cancelFn:xe,requestAnimFrame:le,cancelAnimFrame:F};function H(){}H.extend=function(e){var i=function(){I(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},s=i.__super__=this.prototype,o=h(s);o.constructor=i,i.prototype=o;for(var l in this)Object.prototype.hasOwnProperty.call(this,l)&&l!=="prototype"&&l!=="__super__"&&(i[l]=this[l]);return e.statics&&r(i,e.statics),e.includes&&(J(e.includes),r.apply(null,[o].concat(e.includes))),r(o,e),delete o.statics,delete o.includes,o.options&&(o.options=s.options?h(s.options):{},r(o.options,e.options)),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){s.callInitHooks&&s.callInitHooks.call(this),this._initHooksCalled=!0;for(var m=0,_=o._initHooks.length;m<_;m++)o._initHooks[m].call(this)}},i},H.include=function(e){var i=this.prototype.options;return r(this.prototype,e),e.options&&(this.prototype.options=i,this.mergeOptions(e.options)),this},H.mergeOptions=function(e){return r(this.prototype.options,e),this},H.addInitHook=function(e){var i=Array.prototype.slice.call(arguments,1),s=typeof e=="function"?e:function(){this[e].apply(this,i)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(s),this};function J(e){if(!(typeof L>"u"||!L||!L.Mixin)){e=z(e)?e:[e];for(var i=0;i<e.length;i++)e[i]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var W={on:function(e,i,s){if(typeof e=="object")for(var o in e)this._on(o,e[o],i);else{e=C(e);for(var l=0,m=e.length;l<m;l++)this._on(e[l],i,s)}return this},off:function(e,i,s){if(!arguments.length)delete this._events;else if(typeof e=="object")for(var o in e)this._off(o,e[o],i);else{e=C(e);for(var l=arguments.length===1,m=0,_=e.length;m<_;m++)l?this._off(e[m]):this._off(e[m],i,s)}return this},_on:function(e,i,s,o){if(typeof i!="function"){console.warn("wrong listener type: "+typeof i);return}if(this._listens(e,i,s)===!1){s===this&&(s=void 0);var l={fn:i,ctx:s};o&&(l.once=!0),this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(l)}},_off:function(e,i,s){var o,l,m;if(this._events&&(o=this._events[e],!!o)){if(arguments.length===1){if(this._firingCount)for(l=0,m=o.length;l<m;l++)o[l].fn=y;delete this._events[e];return}if(typeof i!="function"){console.warn("wrong listener type: "+typeof i);return}var _=this._listens(e,i,s);if(_!==!1){var b=o[_];this._firingCount&&(b.fn=y,this._events[e]=o=o.slice()),o.splice(_,1)}}},fire:function(e,i,s){if(!this.listens(e,s))return this;var o=r({},i,{type:e,target:this,sourceTarget:i&&i.sourceTarget||this});if(this._events){var l=this._events[e];if(l){this._firingCount=this._firingCount+1||1;for(var m=0,_=l.length;m<_;m++){var b=l[m],T=b.fn;b.once&&this.off(e,T,b.ctx),T.call(b.ctx||this,o)}this._firingCount--}}return s&&this._propagateEvent(o),this},listens:function(e,i,s,o){typeof e!="string"&&console.warn('"string" type argument expected');var l=i;typeof i!="function"&&(o=!!i,l=void 0,s=void 0);var m=this._events&&this._events[e];if(m&&m.length&&this._listens(e,l,s)!==!1)return!0;if(o){for(var _ in this._eventParents)if(this._eventParents[_].listens(e,i,s,o))return!0}return!1},_listens:function(e,i,s){if(!this._events)return!1;var o=this._events[e]||[];if(!i)return!!o.length;s===this&&(s=void 0);for(var l=0,m=o.length;l<m;l++)if(o[l].fn===i&&o[l].ctx===s)return l;return!1},once:function(e,i,s){if(typeof e=="object")for(var o in e)this._on(o,e[o],i,!0);else{e=C(e);for(var l=0,m=e.length;l<m;l++)this._on(e[l],i,s,!0)}return this},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[d(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[d(e)],this},_propagateEvent:function(e){for(var i in this._eventParents)this._eventParents[i].fire(e.type,r({layer:e.target,propagatedFrom:e.target},e),!0)}};W.addEventListener=W.on,W.removeEventListener=W.clearAllEventListeners=W.off,W.addOneTimeEventListener=W.once,W.fireEvent=W.fire,W.hasEventListeners=W.listens;var Se=H.extend(W);function Z(e,i,s){this.x=s?Math.round(e):e,this.y=s?Math.round(i):i}var Ze=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};Z.prototype={clone:function(){return new Z(this.x,this.y)},add:function(e){return this.clone()._add(Y(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(Y(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new Z(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new Z(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Ze(this.x),this.y=Ze(this.y),this},distanceTo:function(e){e=Y(e);var i=e.x-this.x,s=e.y-this.y;return Math.sqrt(i*i+s*s)},equals:function(e){return e=Y(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=Y(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+v(this.x)+", "+v(this.y)+")"}};function Y(e,i,s){return e instanceof Z?e:z(e)?new Z(e[0],e[1]):e==null?e:typeof e=="object"&&"x"in e&&"y"in e?new Z(e.x,e.y):new Z(e,i,s)}function be(e,i){if(e)for(var s=i?[e,i]:e,o=0,l=s.length;o<l;o++)this.extend(s[o])}be.prototype={extend:function(e){var i,s;if(!e)return this;if(e instanceof Z||typeof e[0]=="number"||"x"in e)i=s=Y(e);else if(e=Ae(e),i=e.min,s=e.max,!i||!s)return this;return!this.min&&!this.max?(this.min=i.clone(),this.max=s.clone()):(this.min.x=Math.min(i.x,this.min.x),this.max.x=Math.max(s.x,this.max.x),this.min.y=Math.min(i.y,this.min.y),this.max.y=Math.max(s.y,this.max.y)),this},getCenter:function(e){return Y((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return Y(this.min.x,this.max.y)},getTopRight:function(){return Y(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var i,s;return typeof e[0]=="number"||e instanceof Z?e=Y(e):e=Ae(e),e instanceof be?(i=e.min,s=e.max):i=s=e,i.x>=this.min.x&&s.x<=this.max.x&&i.y>=this.min.y&&s.y<=this.max.y},intersects:function(e){e=Ae(e);var i=this.min,s=this.max,o=e.min,l=e.max,m=l.x>=i.x&&o.x<=s.x,_=l.y>=i.y&&o.y<=s.y;return m&&_},overlaps:function(e){e=Ae(e);var i=this.min,s=this.max,o=e.min,l=e.max,m=l.x>i.x&&o.x<s.x,_=l.y>i.y&&o.y<s.y;return m&&_},isValid:function(){return!!(this.min&&this.max)},pad:function(e){var i=this.min,s=this.max,o=Math.abs(i.x-s.x)*e,l=Math.abs(i.y-s.y)*e;return Ae(Y(i.x-o,i.y-l),Y(s.x+o,s.y+l))},equals:function(e){return e?(e=Ae(e),this.min.equals(e.getTopLeft())&&this.max.equals(e.getBottomRight())):!1}};function Ae(e,i){return!e||e instanceof be?e:new be(e,i)}function Fe(e,i){if(e)for(var s=i?[e,i]:e,o=0,l=s.length;o<l;o++)this.extend(s[o])}Fe.prototype={extend:function(e){var i=this._southWest,s=this._northEast,o,l;if(e instanceof _e)o=e,l=e;else if(e instanceof Fe){if(o=e._southWest,l=e._northEast,!o||!l)return this}else return e?this.extend(se(e)||Ie(e)):this;return!i&&!s?(this._southWest=new _e(o.lat,o.lng),this._northEast=new _e(l.lat,l.lng)):(i.lat=Math.min(o.lat,i.lat),i.lng=Math.min(o.lng,i.lng),s.lat=Math.max(l.lat,s.lat),s.lng=Math.max(l.lng,s.lng)),this},pad:function(e){var i=this._southWest,s=this._northEast,o=Math.abs(i.lat-s.lat)*e,l=Math.abs(i.lng-s.lng)*e;return new Fe(new _e(i.lat-o,i.lng-l),new _e(s.lat+o,s.lng+l))},getCenter:function(){return new _e((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new _e(this.getNorth(),this.getWest())},getSouthEast:function(){return new _e(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){typeof e[0]=="number"||e instanceof _e||"lat"in e?e=se(e):e=Ie(e);var i=this._southWest,s=this._northEast,o,l;return e instanceof Fe?(o=e.getSouthWest(),l=e.getNorthEast()):o=l=e,o.lat>=i.lat&&l.lat<=s.lat&&o.lng>=i.lng&&l.lng<=s.lng},intersects:function(e){e=Ie(e);var i=this._southWest,s=this._northEast,o=e.getSouthWest(),l=e.getNorthEast(),m=l.lat>=i.lat&&o.lat<=s.lat,_=l.lng>=i.lng&&o.lng<=s.lng;return m&&_},overlaps:function(e){e=Ie(e);var i=this._southWest,s=this._northEast,o=e.getSouthWest(),l=e.getNorthEast(),m=l.lat>i.lat&&o.lat<s.lat,_=l.lng>i.lng&&o.lng<s.lng;return m&&_},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,i){return e?(e=Ie(e),this._southWest.equals(e.getSouthWest(),i)&&this._northEast.equals(e.getNorthEast(),i)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ie(e,i){return e instanceof Fe?e:new Fe(e,i)}function _e(e,i,s){if(isNaN(e)||isNaN(i))throw new Error("Invalid LatLng object: ("+e+", "+i+")");this.lat=+e,this.lng=+i,s!==void 0&&(this.alt=+s)}_e.prototype={equals:function(e,i){if(!e)return!1;e=se(e);var s=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return s<=(i===void 0?1e-9:i)},toString:function(e){return"LatLng("+v(this.lat,e)+", "+v(this.lng,e)+")"},distanceTo:function(e){return at.distance(this,se(e))},wrap:function(){return at.wrapLatLng(this)},toBounds:function(e){var i=180*e/40075017,s=i/Math.cos(Math.PI/180*this.lat);return Ie([this.lat-i,this.lng-s],[this.lat+i,this.lng+s])},clone:function(){return new _e(this.lat,this.lng,this.alt)}};function se(e,i,s){return e instanceof _e?e:z(e)&&typeof e[0]!="object"?e.length===3?new _e(e[0],e[1],e[2]):e.length===2?new _e(e[0],e[1]):null:e==null?e:typeof e=="object"&&"lat"in e?new _e(e.lat,"lng"in e?e.lng:e.lon,e.alt):i===void 0?null:new _e(e,i,s)}var st={latLngToPoint:function(e,i){var s=this.projection.project(e),o=this.scale(i);return this.transformation._transform(s,o)},pointToLatLng:function(e,i){var s=this.scale(i),o=this.transformation.untransform(e,s);return this.projection.unproject(o)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var i=this.projection.bounds,s=this.scale(e),o=this.transformation.transform(i.min,s),l=this.transformation.transform(i.max,s);return new be(o,l)},infinite:!1,wrapLatLng:function(e){var i=this.wrapLng?g(e.lng,this.wrapLng,!0):e.lng,s=this.wrapLat?g(e.lat,this.wrapLat,!0):e.lat,o=e.alt;return new _e(s,i,o)},wrapLatLngBounds:function(e){var i=e.getCenter(),s=this.wrapLatLng(i),o=i.lat-s.lat,l=i.lng-s.lng;if(o===0&&l===0)return e;var m=e.getSouthWest(),_=e.getNorthEast(),b=new _e(m.lat-o,m.lng-l),T=new _e(_.lat-o,_.lng-l);return new Fe(b,T)}},at=r({},st,{wrapLng:[-180,180],R:6371e3,distance:function(e,i){var s=Math.PI/180,o=e.lat*s,l=i.lat*s,m=Math.sin((i.lat-e.lat)*s/2),_=Math.sin((i.lng-e.lng)*s/2),b=m*m+Math.cos(o)*Math.cos(l)*_*_,T=2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b));return this.R*T}}),xt=6378137,Tt={R:xt,MAX_LATITUDE:85.0511287798,project:function(e){var i=Math.PI/180,s=this.MAX_LATITUDE,o=Math.max(Math.min(s,e.lat),-s),l=Math.sin(o*i);return new Z(this.R*e.lng*i,this.R*Math.log((1+l)/(1-l))/2)},unproject:function(e){var i=180/Math.PI;return new _e((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*i,e.x*i/this.R)},bounds:function(){var e=xt*Math.PI;return new be([-e,-e],[e,e])}()};function vt(e,i,s,o){if(z(e)){this._a=e[0],this._b=e[1],this._c=e[2],this._d=e[3];return}this._a=e,this._b=i,this._c=s,this._d=o}vt.prototype={transform:function(e,i){return this._transform(e.clone(),i)},_transform:function(e,i){return i=i||1,e.x=i*(this._a*e.x+this._b),e.y=i*(this._c*e.y+this._d),e},untransform:function(e,i){return i=i||1,new Z((e.x/i-this._b)/this._a,(e.y/i-this._d)/this._c)}};function x(e,i,s,o){return new vt(e,i,s,o)}var j=r({},at,{code:"EPSG:3857",projection:Tt,transformation:function(){var e=.5/(Math.PI*Tt.R);return x(e,.5,-e,.5)}()}),ie=r({},j,{code:"EPSG:900913"});function ce(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Ne(e,i){var s="",o,l,m,_,b,T;for(o=0,m=e.length;o<m;o++){for(b=e[o],l=0,_=b.length;l<_;l++)T=b[l],s+=(l?"L":"M")+T.x+" "+T.y;s+=i?Q.svg?"z":"x":""}return s||"M0 0"}var ue=document.documentElement.style,Ve="ActiveXObject"in window,Ee=Ve&&!document.addEventListener,Ue="msLaunchUri"in navigator&&!("documentMode"in document),lt=Ot("webkit"),R=Ot("android"),M=Ot("android 2")||Ot("android 3"),V=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),me=R&&Ot("Google")&&V<537&&!("AudioNode"in window),Ce=!!window.opera,we=!Ue&&Ot("chrome"),ke=Ot("gecko")&&!lt&&!Ce&&!Ve,et=!we&&Ot("safari"),mt=Ot("phantom"),Wt="OTransition"in ue,ki=navigator.platform.indexOf("Win")===0,$=Ve&&"transition"in ue,oe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!M,ye="MozPerspective"in ue,qe=!window.L_DISABLE_3D&&($||oe||ye)&&!Wt&&!mt,Ge=typeof orientation<"u"||Ot("mobile"),At=Ge&&lt,Pi=Ge&&oe,oi=!window.PointerEvent&&window.MSPointerEvent,fn=!!(window.PointerEvent||oi),mn="ontouchstart"in window||!!window.TouchEvent,Vo=!window.L_NO_TOUCH&&(mn||fn),No=Ge&&Ce,Uo=Ge&&ke,Wo=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Go=function(){var e=!1;try{var i=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",y,i),window.removeEventListener("testPassiveEventSupport",y,i)}catch{}return e}(),jo=function(){return!!document.createElement("canvas").getContext}(),bs=!!(document.createElementNS&&ce("svg").createSVGRect),Ko=!!bs&&function(){var e=document.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Qo=!bs&&function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var i=e.firstChild;return i.style.behavior="url(#default#VML)",i&&typeof i.adj=="object"}catch{return!1}}(),Yo=navigator.platform.indexOf("Mac")===0,Xo=navigator.platform.indexOf("Linux")===0;function Ot(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var Q={ie:Ve,ielt9:Ee,edge:Ue,webkit:lt,android:R,android23:M,androidStock:me,opera:Ce,chrome:we,gecko:ke,safari:et,phantom:mt,opera12:Wt,win:ki,ie3d:$,webkit3d:oe,gecko3d:ye,any3d:qe,mobile:Ge,mobileWebkit:At,mobileWebkit3d:Pi,msPointer:oi,pointer:fn,touch:Vo,touchNative:mn,mobileOpera:No,mobileGecko:Uo,retina:Wo,passiveEvents:Go,canvas:jo,svg:bs,vml:Qo,inlineSvg:Ko,mac:Yo,linux:Xo},pn=Q.msPointer?"MSPointerDown":"pointerdown",vn=Q.msPointer?"MSPointerMove":"pointermove",gn=Q.msPointer?"MSPointerUp":"pointerup",_n=Q.msPointer?"MSPointerCancel":"pointercancel",ws={touchstart:pn,touchmove:vn,touchend:gn,touchcancel:_n},yn={touchstart:na,touchmove:Ni,touchend:Ni,touchcancel:Ni},ai={},bn=!1;function Jo(e,i,s){return i==="touchstart"&&sa(),yn[i]?(s=yn[i].bind(this,s),e.addEventListener(ws[i],s,!1),s):(console.warn("wrong event specified:",i),y)}function ea(e,i,s){if(!ws[i]){console.warn("wrong event specified:",i);return}e.removeEventListener(ws[i],s,!1)}function ta(e){ai[e.pointerId]=e}function ia(e){ai[e.pointerId]&&(ai[e.pointerId]=e)}function wn(e){delete ai[e.pointerId]}function sa(){bn||(document.addEventListener(pn,ta,!0),document.addEventListener(vn,ia,!0),document.addEventListener(gn,wn,!0),document.addEventListener(_n,wn,!0),bn=!0)}function Ni(e,i){if(i.pointerType!==(i.MSPOINTER_TYPE_MOUSE||"mouse")){i.touches=[];for(var s in ai)i.touches.push(ai[s]);i.changedTouches=[i],e(i)}}function na(e,i){i.MSPOINTER_TYPE_TOUCH&&i.pointerType===i.MSPOINTER_TYPE_TOUCH&&nt(i),Ni(e,i)}function oa(e){var i={},s,o;for(o in e)s=e[o],i[o]=s&&s.bind?s.bind(e):s;return e=i,i.type="dblclick",i.detail=2,i.isTrusted=!1,i._simulated=!0,i}var aa=200;function ra(e,i){e.addEventListener("dblclick",i);var s=0,o;function l(m){if(m.detail!==1){o=m.detail;return}if(!(m.pointerType==="mouse"||m.sourceCapabilities&&!m.sourceCapabilities.firesTouchEvents)){var _=Cn(m);if(!(_.some(function(T){return T instanceof HTMLLabelElement&&T.attributes.for})&&!_.some(function(T){return T instanceof HTMLInputElement||T instanceof HTMLSelectElement}))){var b=Date.now();b-s<=aa?(o++,o===2&&i(oa(m))):o=1,s=b}}}return e.addEventListener("click",l),{dblclick:i,simDblclick:l}}function la(e,i){e.removeEventListener("dblclick",i.dblclick),e.removeEventListener("click",i.simDblclick)}var ks=Gi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ti=Gi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),kn=Ti==="webkitTransition"||Ti==="OTransition"?Ti+"End":"transitionend";function Pn(e){return typeof e=="string"?document.getElementById(e):e}function Li(e,i){var s=e.style[i]||e.currentStyle&&e.currentStyle[i];if((!s||s==="auto")&&document.defaultView){var o=document.defaultView.getComputedStyle(e,null);s=o?o[i]:null}return s==="auto"?null:s}function Me(e,i,s){var o=document.createElement(e);return o.className=i||"",s&&s.appendChild(o),o}function We(e){var i=e.parentNode;i&&i.removeChild(e)}function Ui(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function ri(e){var i=e.parentNode;i&&i.lastChild!==e&&i.appendChild(e)}function li(e){var i=e.parentNode;i&&i.firstChild!==e&&i.insertBefore(e,i.firstChild)}function Ps(e,i){if(e.classList!==void 0)return e.classList.contains(i);var s=Wi(e);return s.length>0&&new RegExp("(^|\\s)"+i+"(\\s|$)").test(s)}function pe(e,i){if(e.classList!==void 0)for(var s=C(i),o=0,l=s.length;o<l;o++)e.classList.add(s[o]);else if(!Ps(e,i)){var m=Wi(e);Ts(e,(m?m+" ":"")+i)}}function Ke(e,i){e.classList!==void 0?e.classList.remove(i):Ts(e,k((" "+Wi(e)+" ").replace(" "+i+" "," ")))}function Ts(e,i){e.className.baseVal===void 0?e.className=i:e.className.baseVal=i}function Wi(e){return e.correspondingElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function Lt(e,i){"opacity"in e.style?e.style.opacity=i:"filter"in e.style&&ua(e,i)}function ua(e,i){var s=!1,o="DXImageTransform.Microsoft.Alpha";try{s=e.filters.item(o)}catch{if(i===1)return}i=Math.round(i*100),s?(s.Enabled=i!==100,s.Opacity=i):e.style.filter+=" progid:"+o+"(opacity="+i+")"}function Gi(e){for(var i=document.documentElement.style,s=0;s<e.length;s++)if(e[s]in i)return e[s];return!1}function Jt(e,i,s){var o=i||new Z(0,0);e.style[ks]=(Q.ie3d?"translate("+o.x+"px,"+o.y+"px)":"translate3d("+o.x+"px,"+o.y+"px,0)")+(s?" scale("+s+")":"")}function Qe(e,i){e._leaflet_pos=i,Q.any3d?Jt(e,i):(e.style.left=i.x+"px",e.style.top=i.y+"px")}function ei(e){return e._leaflet_pos||new Z(0,0)}var Ci,Mi,Ls;if("onselectstart"in document)Ci=function(){de(window,"selectstart",nt)},Mi=function(){$e(window,"selectstart",nt)};else{var Si=Gi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ci=function(){if(Si){var e=document.documentElement.style;Ls=e[Si],e[Si]="none"}},Mi=function(){Si&&(document.documentElement.style[Si]=Ls,Ls=void 0)}}function Cs(){de(window,"dragstart",nt)}function Ms(){$e(window,"dragstart",nt)}var ji,Ss;function xs(e){for(;e.tabIndex===-1;)e=e.parentNode;e.style&&(Ki(),ji=e,Ss=e.style.outlineStyle,e.style.outlineStyle="none",de(window,"keydown",Ki))}function Ki(){ji&&(ji.style.outlineStyle=Ss,ji=void 0,Ss=void 0,$e(window,"keydown",Ki))}function Tn(e){do e=e.parentNode;while((!e.offsetWidth||!e.offsetHeight)&&e!==document.body);return e}function Is(e){var i=e.getBoundingClientRect();return{x:i.width/e.offsetWidth||1,y:i.height/e.offsetHeight||1,boundingClientRect:i}}var ha={__proto__:null,TRANSFORM:ks,TRANSITION:Ti,TRANSITION_END:kn,get:Pn,getStyle:Li,create:Me,remove:We,empty:Ui,toFront:ri,toBack:li,hasClass:Ps,addClass:pe,removeClass:Ke,setClass:Ts,getClass:Wi,setOpacity:Lt,testProp:Gi,setTransform:Jt,setPosition:Qe,getPosition:ei,get disableTextSelection(){return Ci},get enableTextSelection(){return Mi},disableImageDrag:Cs,enableImageDrag:Ms,preventOutline:xs,restoreOutline:Ki,getSizedParentNode:Tn,getScale:Is};function de(e,i,s,o){if(i&&typeof i=="object")for(var l in i)As(e,l,i[l],s);else{i=C(i);for(var m=0,_=i.length;m<_;m++)As(e,i[m],s,o)}return this}var zt="_leaflet_events";function $e(e,i,s,o){if(arguments.length===1)Ln(e),delete e[zt];else if(i&&typeof i=="object")for(var l in i)Os(e,l,i[l],s);else if(i=C(i),arguments.length===2)Ln(e,function(b){return B(i,b)!==-1});else for(var m=0,_=i.length;m<_;m++)Os(e,i[m],s,o);return this}function Ln(e,i){for(var s in e[zt]){var o=s.split(/\d/)[0];(!i||i(o))&&Os(e,o,null,null,s)}}var Ds={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function As(e,i,s,o){var l=i+d(s)+(o?"_"+d(o):"");if(e[zt]&&e[zt][l])return this;var m=function(b){return s.call(o||e,b||window.event)},_=m;!Q.touchNative&&Q.pointer&&i.indexOf("touch")===0?m=Jo(e,i,m):Q.touch&&i==="dblclick"?m=ra(e,m):"addEventListener"in e?i==="touchstart"||i==="touchmove"||i==="wheel"||i==="mousewheel"?e.addEventListener(Ds[i]||i,m,Q.passiveEvents?{passive:!1}:!1):i==="mouseenter"||i==="mouseleave"?(m=function(b){b=b||window.event,Es(e,b)&&_(b)},e.addEventListener(Ds[i],m,!1)):e.addEventListener(i,_,!1):e.attachEvent("on"+i,m),e[zt]=e[zt]||{},e[zt][l]=m}function Os(e,i,s,o,l){l=l||i+d(s)+(o?"_"+d(o):"");var m=e[zt]&&e[zt][l];if(!m)return this;!Q.touchNative&&Q.pointer&&i.indexOf("touch")===0?ea(e,i,m):Q.touch&&i==="dblclick"?la(e,m):"removeEventListener"in e?e.removeEventListener(Ds[i]||i,m,!1):e.detachEvent("on"+i,m),e[zt][l]=null}function ti(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}function zs(e){return As(e,"wheel",ti),this}function xi(e){return de(e,"mousedown touchstart dblclick contextmenu",ti),e._leaflet_disable_click=!0,this}function nt(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function ii(e){return nt(e),ti(e),this}function Cn(e){if(e.composedPath)return e.composedPath();for(var i=[],s=e.target;s;)i.push(s),s=s.parentNode;return i}function Mn(e,i){if(!i)return new Z(e.clientX,e.clientY);var s=Is(i),o=s.boundingClientRect;return new Z((e.clientX-o.left)/s.x-i.clientLeft,(e.clientY-o.top)/s.y-i.clientTop)}var ca=Q.linux&&Q.chrome?window.devicePixelRatio:Q.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Sn(e){return Q.edge?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/ca:e.deltaY&&e.deltaMode===1?-e.deltaY*20:e.deltaY&&e.deltaMode===2?-e.deltaY*60:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?-e.detail*20:e.detail?e.detail/-32765*60:0}function Es(e,i){var s=i.relatedTarget;if(!s)return!0;try{for(;s&&s!==e;)s=s.parentNode}catch{return!1}return s!==e}var da={__proto__:null,on:de,off:$e,stopPropagation:ti,disableScrollPropagation:zs,disableClickPropagation:xi,preventDefault:nt,stop:ii,getPropagationPath:Cn,getMousePosition:Mn,getWheelDelta:Sn,isExternalTarget:Es,addListener:de,removeListener:$e},xn=Se.extend({run:function(e,i,s,o){this.stop(),this._el=e,this._inProgress=!0,this._duration=s||.25,this._easeOutPower=1/Math.max(o||.5,.2),this._startPos=ei(e),this._offset=i.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=le(this._animate,this),this._step()},_step:function(e){var i=+new Date-this._startTime,s=this._duration*1e3;i<s?this._runFrame(this._easeOut(i/s),e):(this._runFrame(1),this._complete())},_runFrame:function(e,i){var s=this._startPos.add(this._offset.multiplyBy(e));i&&s._round(),Qe(this._el,s),this.fire("step")},_complete:function(){F(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),Te=Se.extend({options:{crs:j,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,i){i=I(this,i),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),i.maxBounds&&this.setMaxBounds(i.maxBounds),i.zoom!==void 0&&(this._zoom=this._limitZoom(i.zoom)),i.center&&i.zoom!==void 0&&this.setView(se(i.center),i.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ti&&Q.any3d&&!Q.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),de(this._proxy,kn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,i,s){if(i=i===void 0?this._zoom:this._limitZoom(i),e=this._limitCenter(se(e),i,this.options.maxBounds),s=s||{},this._stop(),this._loaded&&!s.reset&&s!==!0){s.animate!==void 0&&(s.zoom=r({animate:s.animate},s.zoom),s.pan=r({animate:s.animate,duration:s.duration},s.pan));var o=this._zoom!==i?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,i,s.zoom):this._tryAnimatedPan(e,s.pan);if(o)return clearTimeout(this._sizeTimer),this}return this._resetView(e,i,s.pan&&s.pan.noMoveStart),this},setZoom:function(e,i){return this._loaded?this.setView(this.getCenter(),e,{zoom:i}):(this._zoom=e,this)},zoomIn:function(e,i){return e=e||(Q.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,i)},zoomOut:function(e,i){return e=e||(Q.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,i)},setZoomAround:function(e,i,s){var o=this.getZoomScale(i),l=this.getSize().divideBy(2),m=e instanceof Z?e:this.latLngToContainerPoint(e),_=m.subtract(l).multiplyBy(1-1/o),b=this.containerPointToLatLng(l.add(_));return this.setView(b,i,{zoom:s})},_getBoundsCenterZoom:function(e,i){i=i||{},e=e.getBounds?e.getBounds():Ie(e);var s=Y(i.paddingTopLeft||i.padding||[0,0]),o=Y(i.paddingBottomRight||i.padding||[0,0]),l=this.getBoundsZoom(e,!1,s.add(o));if(l=typeof i.maxZoom=="number"?Math.min(i.maxZoom,l):l,l===1/0)return{center:e.getCenter(),zoom:l};var m=o.subtract(s).divideBy(2),_=this.project(e.getSouthWest(),l),b=this.project(e.getNorthEast(),l),T=this.unproject(_.add(b).divideBy(2).add(m),l);return{center:T,zoom:l}},fitBounds:function(e,i){if(e=Ie(e),!e.isValid())throw new Error("Bounds are not valid.");var s=this._getBoundsCenterZoom(e,i);return this.setView(s.center,s.zoom,i)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,i){return this.setView(e,this._zoom,{pan:i})},panBy:function(e,i){if(e=Y(e).round(),i=i||{},!e.x&&!e.y)return this.fire("moveend");if(i.animate!==!0&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new xn,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),i.noMoveStart||this.fire("movestart"),i.animate!==!1){pe(this._mapPane,"leaflet-pan-anim");var s=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,s,i.duration||.25,i.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,i,s){if(s=s||{},s.animate===!1||!Q.any3d)return this.setView(e,i,s);this._stop();var o=this.project(this.getCenter()),l=this.project(e),m=this.getSize(),_=this._zoom;e=se(e),i=i===void 0?_:i;var b=Math.max(m.x,m.y),T=b*this.getZoomScale(_,i),O=l.distanceTo(o)||1,U=1.42,ne=U*U;function ge(Ye){var rs=Ye?-1:1,er=Ye?T:b,tr=T*T-b*b+rs*ne*ne*O*O,ir=2*er*ne*O,Ws=tr/ir,uo=Math.sqrt(Ws*Ws+1)-Ws,sr=uo<1e-9?-18:Math.log(uo);return sr}function ut(Ye){return(Math.exp(Ye)-Math.exp(-Ye))/2}function tt(Ye){return(Math.exp(Ye)+Math.exp(-Ye))/2}function Mt(Ye){return ut(Ye)/tt(Ye)}var pt=ge(0);function mi(Ye){return b*(tt(pt)/tt(pt+U*Ye))}function Qa(Ye){return b*(tt(pt)*Mt(pt+U*Ye)-ut(pt))/ne}function Ya(Ye){return 1-Math.pow(1-Ye,1.5)}var Xa=Date.now(),ro=(ge(1)-pt)/U,Ja=s.duration?1e3*s.duration:1e3*ro*.8;function lo(){var Ye=(Date.now()-Xa)/Ja,rs=Ya(Ye)*ro;Ye<=1?(this._flyToFrame=le(lo,this),this._move(this.unproject(o.add(l.subtract(o).multiplyBy(Qa(rs)/O)),_),this.getScaleZoom(b/mi(rs),_),{flyTo:!0})):this._move(e,i)._moveEnd(!0)}return this._moveStart(!0,s.noMoveStart),lo.call(this),this},flyToBounds:function(e,i){var s=this._getBoundsCenterZoom(e,i);return this.flyTo(s.center,s.zoom,i)},setMaxBounds:function(e){return e=Ie(e),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),e.isValid()?(this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(e){var i=this.options.minZoom;return this.options.minZoom=e,this._loaded&&i!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var i=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&i!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,i){this._enforcingBounds=!0;var s=this.getCenter(),o=this._limitCenter(s,this._zoom,Ie(e));return s.equals(o)||this.panTo(o,i),this._enforcingBounds=!1,this},panInside:function(e,i){i=i||{};var s=Y(i.paddingTopLeft||i.padding||[0,0]),o=Y(i.paddingBottomRight||i.padding||[0,0]),l=this.project(this.getCenter()),m=this.project(e),_=this.getPixelBounds(),b=Ae([_.min.add(s),_.max.subtract(o)]),T=b.getSize();if(!b.contains(m)){this._enforcingBounds=!0;var O=m.subtract(b.getCenter()),U=b.extend(m).getSize().subtract(T);l.x+=O.x<0?-U.x:U.x,l.y+=O.y<0?-U.y:U.y,this.panTo(this.unproject(l),i),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=r({animate:!1,pan:!0},e===!0?{animate:!0}:e);var i=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var s=this.getSize(),o=i.divideBy(2).round(),l=s.divideBy(2).round(),m=o.subtract(l);return!m.x&&!m.y?this:(e.animate&&e.pan?this.panBy(m):(e.pan&&this._rawPanBy(m),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:i,newSize:s}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=r({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var i=c(this._handleGeolocationResponse,this),s=c(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(i,s,e):navigator.geolocation.getCurrentPosition(i,s,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){if(this._container._leaflet_id){var i=e.code,s=e.message||(i===1?"permission denied":i===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:i,message:"Geolocation error: "+s+"."})}},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var i=e.coords.latitude,s=e.coords.longitude,o=new _e(i,s),l=o.toBounds(e.coords.accuracy*2),m=this._locateOptions;if(m.setView){var _=this.getBoundsZoom(l);this.setView(o,m.maxZoom?Math.min(_,m.maxZoom):_)}var b={latlng:o,bounds:l,timestamp:e.timestamp};for(var T in e.coords)typeof e.coords[T]=="number"&&(b[T]=e.coords[T]);this.fire("locationfound",b)}},addHandler:function(e,i){if(!i)return this;var s=this[e]=new i(this);return this._handlers.push(s),this.options[e]&&s.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),We(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(F(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var e;for(e in this._layers)this._layers[e].remove();for(e in this._panes)We(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,i){var s="leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),o=Me("div",s,i||this._mapPane);return e&&(this._panes[e]=o),o},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),i=this.unproject(e.getBottomLeft()),s=this.unproject(e.getTopRight());return new Fe(i,s)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,i,s){e=Ie(e),s=Y(s||[0,0]);var o=this.getZoom()||0,l=this.getMinZoom(),m=this.getMaxZoom(),_=e.getNorthWest(),b=e.getSouthEast(),T=this.getSize().subtract(s),O=Ae(this.project(b,o),this.project(_,o)).getSize(),U=Q.any3d?this.options.zoomSnap:1,ne=T.x/O.x,ge=T.y/O.y,ut=i?Math.max(ne,ge):Math.min(ne,ge);return o=this.getScaleZoom(ut,o),U&&(o=Math.round(o/(U/100))*(U/100),o=i?Math.ceil(o/U)*U:Math.floor(o/U)*U),Math.max(l,Math.min(m,o))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,i){var s=this._getTopLeftPoint(e,i);return new be(s,s.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(e===void 0?this.getZoom():e)},getPane:function(e){return typeof e=="string"?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,i){var s=this.options.crs;return i=i===void 0?this._zoom:i,s.scale(e)/s.scale(i)},getScaleZoom:function(e,i){var s=this.options.crs;i=i===void 0?this._zoom:i;var o=s.zoom(e*s.scale(i));return isNaN(o)?1/0:o},project:function(e,i){return i=i===void 0?this._zoom:i,this.options.crs.latLngToPoint(se(e),i)},unproject:function(e,i){return i=i===void 0?this._zoom:i,this.options.crs.pointToLatLng(Y(e),i)},layerPointToLatLng:function(e){var i=Y(e).add(this.getPixelOrigin());return this.unproject(i)},latLngToLayerPoint:function(e){var i=this.project(se(e))._round();return i._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(se(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(Ie(e))},distance:function(e,i){return this.options.crs.distance(se(e),se(i))},containerPointToLayerPoint:function(e){return Y(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return Y(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var i=this.containerPointToLayerPoint(Y(e));return this.layerPointToLatLng(i)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(se(e)))},mouseEventToContainerPoint:function(e){return Mn(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var i=this._container=Pn(e);if(i){if(i._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");de(i,"scroll",this._onScroll,this),this._containerId=d(i)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&Q.any3d,pe(e,"leaflet-container"+(Q.touch?" leaflet-touch":"")+(Q.retina?" leaflet-retina":"")+(Q.ielt9?" leaflet-oldie":"")+(Q.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var i=Li(e,"position");i!=="absolute"&&i!=="relative"&&i!=="fixed"&&i!=="sticky"&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Qe(this._mapPane,new Z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(pe(e.markerPane,"leaflet-zoom-hide"),pe(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,i,s){Qe(this._mapPane,new Z(0,0));var o=!this._loaded;this._loaded=!0,i=this._limitZoom(i),this.fire("viewprereset");var l=this._zoom!==i;this._moveStart(l,s)._move(e,i)._moveEnd(l),this.fire("viewreset"),o&&this.fire("load")},_moveStart:function(e,i){return e&&this.fire("zoomstart"),i||this.fire("movestart"),this},_move:function(e,i,s,o){i===void 0&&(i=this._zoom);var l=this._zoom!==i;return this._zoom=i,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),o?s&&s.pinch&&this.fire("zoom",s):((l||s&&s.pinch)&&this.fire("zoom",s),this.fire("move",s)),this},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return F(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){Qe(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[d(this._container)]=this;var i=e?$e:de;i(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&i(window,"resize",this._onResize,this),Q.any3d&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){F(this._resizeRequest),this._resizeRequest=le(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,i){for(var s=[],o,l=i==="mouseout"||i==="mouseover",m=e.target||e.srcElement,_=!1;m;){if(o=this._targets[d(m)],o&&(i==="click"||i==="preclick")&&this._draggableMoved(o)){_=!0;break}if(o&&o.listens(i,!0)&&(l&&!Es(m,e)||(s.push(o),l))||m===this._container)break;m=m.parentNode}return!s.length&&!_&&!l&&this.listens(i,!0)&&(s=[this]),s},_isClickDisabled:function(e){for(;e&&e!==this._container;){if(e._leaflet_disable_click)return!0;e=e.parentNode}},_handleDOMEvent:function(e){var i=e.target||e.srcElement;if(!(!this._loaded||i._leaflet_disable_events||e.type==="click"&&this._isClickDisabled(i))){var s=e.type;s==="mousedown"&&xs(i),this._fireDOMEvent(e,s)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,i,s){if(e.type==="click"){var o=r({},e);o.type="preclick",this._fireDOMEvent(o,o.type,s)}var l=this._findEventTargets(e,i);if(s){for(var m=[],_=0;_<s.length;_++)s[_].listens(i,!0)&&m.push(s[_]);l=m.concat(l)}if(l.length){i==="contextmenu"&&nt(e);var b=l[0],T={originalEvent:e};if(e.type!=="keypress"&&e.type!=="keydown"&&e.type!=="keyup"){var O=b.getLatLng&&(!b._radius||b._radius<=10);T.containerPoint=O?this.latLngToContainerPoint(b.getLatLng()):this.mouseEventToContainerPoint(e),T.layerPoint=this.containerPointToLayerPoint(T.containerPoint),T.latlng=O?b.getLatLng():this.layerPointToLatLng(T.layerPoint)}for(_=0;_<l.length;_++)if(l[_].fire(i,T,!0),T.originalEvent._stopped||l[_].options.bubblingMouseEvents===!1&&B(this._mouseEvents,i)!==-1)return}},_draggableMoved:function(e){return e=e.dragging&&e.dragging.enabled()?e:this,e.dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,i=this._handlers.length;e<i;e++)this._handlers[e].disable()},whenReady:function(e,i){return this._loaded?e.call(i||this,{target:this}):this.on("load",e,i),this},_getMapPanePos:function(){return ei(this._mapPane)||new Z(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,i){var s=e&&i!==void 0?this._getNewPixelOrigin(e,i):this.getPixelOrigin();return s.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,i){var s=this.getSize()._divideBy(2);return this.project(e,i)._subtract(s)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,i,s){var o=this._getNewPixelOrigin(s,i);return this.project(e,i)._subtract(o)},_latLngBoundsToNewLayerBounds:function(e,i,s){var o=this._getNewPixelOrigin(s,i);return Ae([this.project(e.getSouthWest(),i)._subtract(o),this.project(e.getNorthWest(),i)._subtract(o),this.project(e.getSouthEast(),i)._subtract(o),this.project(e.getNorthEast(),i)._subtract(o)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,i,s){if(!s)return e;var o=this.project(e,i),l=this.getSize().divideBy(2),m=new be(o.subtract(l),o.add(l)),_=this._getBoundsOffset(m,s,i);return Math.abs(_.x)<=1&&Math.abs(_.y)<=1?e:this.unproject(o.add(_),i)},_limitOffset:function(e,i){if(!i)return e;var s=this.getPixelBounds(),o=new be(s.min.add(e),s.max.add(e));return e.add(this._getBoundsOffset(o,i))},_getBoundsOffset:function(e,i,s){var o=Ae(this.project(i.getNorthEast(),s),this.project(i.getSouthWest(),s)),l=o.min.subtract(e.min),m=o.max.subtract(e.max),_=this._rebound(l.x,-m.x),b=this._rebound(l.y,-m.y);return new Z(_,b)},_rebound:function(e,i){return e+i>0?Math.round(e-i)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(i))},_limitZoom:function(e){var i=this.getMinZoom(),s=this.getMaxZoom(),o=Q.any3d?this.options.zoomSnap:1;return o&&(e=Math.round(e/o)*o),Math.max(i,Math.min(s,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ke(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,i){var s=this._getCenterOffset(e)._trunc();return(i&&i.animate)!==!0&&!this.getSize().contains(s)?!1:(this.panBy(s,i),!0)},_createAnimProxy:function(){var e=this._proxy=Me("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",function(i){var s=ks,o=this._proxy.style[s];Jt(this._proxy,this.project(i.center,i.zoom),this.getZoomScale(i.zoom,1)),o===this._proxy.style[s]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){We(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),i=this.getZoom();Jt(this._proxy,this.project(e,i),this.getZoomScale(i,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,i,s){if(this._animatingZoom)return!0;if(s=s||{},!this._zoomAnimated||s.animate===!1||this._nothingToAnimate()||Math.abs(i-this._zoom)>this.options.zoomAnimationThreshold)return!1;var o=this.getZoomScale(i),l=this._getCenterOffset(e)._divideBy(1-1/o);return s.animate!==!0&&!this.getSize().contains(l)?!1:(le(function(){this._moveStart(!0,s.noMoveStart||!1)._animateZoom(e,i,!0)},this),!0)},_animateZoom:function(e,i,s,o){this._mapPane&&(s&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=i,pe(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:i,noUpdate:o}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ke(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function fa(e,i){return new Te(e,i)}var It=H.extend({options:{position:"topright"},initialize:function(e){I(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var i=this._map;return i&&i.removeControl(this),this.options.position=e,i&&i.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var i=this._container=this.onAdd(e),s=this.getPosition(),o=e._controlCorners[s];return pe(i,"leaflet-control"),s.indexOf("bottom")!==-1?o.insertBefore(i,o.firstChild):o.appendChild(i),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(We(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),Ii=function(e){return new It(e)};Te.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},i="leaflet-",s=this._controlContainer=Me("div",i+"control-container",this._container);function o(l,m){var _=i+l+" "+i+m;e[l+m]=Me("div",_,s)}o("top","left"),o("top","right"),o("bottom","left"),o("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)We(this._controlCorners[e]);We(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var In=It.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,i,s,o){return s<o?-1:o<s?1:0}},initialize:function(e,i,s){I(this,s),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var o in e)this._addLayer(e[o],o);for(o in i)this._addLayer(i[o],o,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return It.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,i){return this._addLayer(e,i),this._map?this._update():this},addOverlay:function(e,i){return this._addLayer(e,i,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var i=this._getLayer(d(e));return i&&this._layers.splice(this._layers.indexOf(i),1),this._map?this._update():this},expand:function(){pe(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(pe(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):Ke(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ke(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",i=this._container=Me("div",e),s=this.options.collapsed;i.setAttribute("aria-haspopup",!0),xi(i),zs(i);var o=this._section=Me("section",e+"-list");s&&(this._map.on("click",this.collapse,this),de(i,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var l=this._layersLink=Me("a",e+"-toggle",i);l.href="#",l.title="Layers",l.setAttribute("role","button"),de(l,{keydown:function(m){m.keyCode===13&&this._expandSafely()},click:function(m){nt(m),this._expandSafely()}},this),s||this.expand(),this._baseLayersList=Me("div",e+"-base",o),this._separator=Me("div",e+"-separator",o),this._overlaysList=Me("div",e+"-overlays",o),i.appendChild(o)},_getLayer:function(e){for(var i=0;i<this._layers.length;i++)if(this._layers[i]&&d(this._layers[i].layer)===e)return this._layers[i]},_addLayer:function(e,i,s){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:i,overlay:s}),this.options.sortLayers&&this._layers.sort(c(function(o,l){return this.options.sortFunction(o.layer,l.layer,o.name,l.name)},this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ui(this._baseLayersList),Ui(this._overlaysList),this._layerControlInputs=[];var e,i,s,o,l=0;for(s=0;s<this._layers.length;s++)o=this._layers[s],this._addItem(o),i=i||o.overlay,e=e||!o.overlay,l+=o.overlay?0:1;return this.options.hideSingleBase&&(e=e&&l>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=i&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var i=this._getLayer(d(e.target)),s=i.overlay?e.type==="add"?"overlayadd":"overlayremove":e.type==="add"?"baselayerchange":null;s&&this._map.fire(s,i)},_createRadioElement:function(e,i){var s='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(i?' checked="checked"':"")+"/>",o=document.createElement("div");return o.innerHTML=s,o.firstChild},_addItem:function(e){var i=document.createElement("label"),s=this._map.hasLayer(e.layer),o;e.overlay?(o=document.createElement("input"),o.type="checkbox",o.className="leaflet-control-layers-selector",o.defaultChecked=s):o=this._createRadioElement("leaflet-base-layers_"+d(this),s),this._layerControlInputs.push(o),o.layerId=d(e.layer),de(o,"click",this._onInputClick,this);var l=document.createElement("span");l.innerHTML=" "+e.name;var m=document.createElement("span");i.appendChild(m),m.appendChild(o),m.appendChild(l);var _=e.overlay?this._overlaysList:this._baseLayersList;return _.appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){if(!this._preventClick){var e=this._layerControlInputs,i,s,o=[],l=[];this._handlingClick=!0;for(var m=e.length-1;m>=0;m--)i=e[m],s=this._getLayer(i.layerId).layer,i.checked?o.push(s):i.checked||l.push(s);for(m=0;m<l.length;m++)this._map.hasLayer(l[m])&&this._map.removeLayer(l[m]);for(m=0;m<o.length;m++)this._map.hasLayer(o[m])||this._map.addLayer(o[m]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var e=this._layerControlInputs,i,s,o=this._map.getZoom(),l=e.length-1;l>=0;l--)i=e[l],s=this._getLayer(i.layerId).layer,i.disabled=s.options.minZoom!==void 0&&o<s.options.minZoom||s.options.maxZoom!==void 0&&o>s.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var e=this._section;this._preventClick=!0,de(e,"click",nt),this.expand();var i=this;setTimeout(function(){$e(e,"click",nt),i._preventClick=!1})}}),ma=function(e,i,s){return new In(e,i,s)},$s=It.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(e){var i="leaflet-control-zoom",s=Me("div",i+" leaflet-bar"),o=this.options;return this._zoomInButton=this._createButton(o.zoomInText,o.zoomInTitle,i+"-in",s,this._zoomIn),this._zoomOutButton=this._createButton(o.zoomOutText,o.zoomOutTitle,i+"-out",s,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),s},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,i,s,o,l){var m=Me("a",s,o);return m.innerHTML=e,m.href="#",m.title=i,m.setAttribute("role","button"),m.setAttribute("aria-label",i),xi(m),de(m,"click",ii),de(m,"click",l,this),de(m,"click",this._refocusOnMap,this),m},_updateDisabled:function(){var e=this._map,i="leaflet-disabled";Ke(this._zoomInButton,i),Ke(this._zoomOutButton,i),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||e._zoom===e.getMinZoom())&&(pe(this._zoomOutButton,i),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||e._zoom===e.getMaxZoom())&&(pe(this._zoomInButton,i),this._zoomInButton.setAttribute("aria-disabled","true"))}});Te.mergeOptions({zoomControl:!0}),Te.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new $s,this.addControl(this.zoomControl))});var pa=function(e){return new $s(e)},Dn=It.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var i="leaflet-control-scale",s=Me("div",i),o=this.options;return this._addScales(o,i+"-line",s),e.on(o.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),s},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,i,s){e.metric&&(this._mScale=Me("div",i,s)),e.imperial&&(this._iScale=Me("div",i,s))},_update:function(){var e=this._map,i=e.getSize().y/2,s=e.distance(e.containerPointToLatLng([0,i]),e.containerPointToLatLng([this.options.maxWidth,i]));this._updateScales(s)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var i=this._getRoundNum(e),s=i<1e3?i+" m":i/1e3+" km";this._updateScale(this._mScale,s,i/e)},_updateImperial:function(e){var i=e*3.2808399,s,o,l;i>5280?(s=i/5280,o=this._getRoundNum(s),this._updateScale(this._iScale,o+" mi",o/s)):(l=this._getRoundNum(i),this._updateScale(this._iScale,l+" ft",l/i))},_updateScale:function(e,i,s){e.style.width=Math.round(this.options.maxWidth*s)+"px",e.innerHTML=i},_getRoundNum:function(e){var i=Math.pow(10,(Math.floor(e)+"").length-1),s=e/i;return s=s>=10?10:s>=5?5:s>=3?3:s>=2?2:1,i*s}}),va=function(e){return new Dn(e)},ga='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Bs=It.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Q.inlineSvg?ga+" ":"")+"Leaflet</a>"},initialize:function(e){I(this,e),this._attributions={}},onAdd:function(e){e.attributionControl=this,this._container=Me("div","leaflet-control-attribution"),xi(this._container);for(var i in e._layers)e._layers[i].getAttribution&&this.addAttribution(e._layers[i].getAttribution());return this._update(),e.on("layeradd",this._addAttribution,this),this._container},onRemove:function(e){e.off("layeradd",this._addAttribution,this)},_addAttribution:function(e){e.layer.getAttribution&&(this.addAttribution(e.layer.getAttribution()),e.layer.once("remove",function(){this.removeAttribution(e.layer.getAttribution())},this))},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var i in this._attributions)this._attributions[i]&&e.push(i);var s=[];this.options.prefix&&s.push(this.options.prefix),e.length&&s.push(e.join(", ")),this._container.innerHTML=s.join(' <span aria-hidden="true">|</span> ')}}});Te.mergeOptions({attributionControl:!0}),Te.addInitHook(function(){this.options.attributionControl&&new Bs().addTo(this)});var _a=function(e){return new Bs(e)};It.Layers=In,It.Zoom=$s,It.Scale=Dn,It.Attribution=Bs,Ii.layers=ma,Ii.zoom=pa,Ii.scale=va,Ii.attribution=_a;var Et=H.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Et.addTo=function(e,i){return e.addHandler(i,this),this};var ya={Events:W},An=Q.touch?"touchstart mousedown":"mousedown",Gt=Se.extend({options:{clickTolerance:3},initialize:function(e,i,s,o){I(this,o),this._element=e,this._dragStartTarget=i||e,this._preventOutline=s},enable:function(){this._enabled||(de(this._dragStartTarget,An,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Gt._dragging===this&&this.finishDrag(!0),$e(this._dragStartTarget,An,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(this._enabled&&(this._moved=!1,!Ps(this._element,"leaflet-zoom-anim"))){if(e.touches&&e.touches.length!==1){Gt._dragging===this&&this.finishDrag();return}if(!(Gt._dragging||e.shiftKey||e.which!==1&&e.button!==1&&!e.touches)&&(Gt._dragging=this,this._preventOutline&&xs(this._element),Cs(),Ci(),!this._moving)){this.fire("down");var i=e.touches?e.touches[0]:e,s=Tn(this._element);this._startPoint=new Z(i.clientX,i.clientY),this._startPos=ei(this._element),this._parentScale=Is(s);var o=e.type==="mousedown";de(document,o?"mousemove":"touchmove",this._onMove,this),de(document,o?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(e){if(this._enabled){if(e.touches&&e.touches.length>1){this._moved=!0;return}var i=e.touches&&e.touches.length===1?e.touches[0]:e,s=new Z(i.clientX,i.clientY)._subtract(this._startPoint);!s.x&&!s.y||Math.abs(s.x)+Math.abs(s.y)<this.options.clickTolerance||(s.x/=this._parentScale.x,s.y/=this._parentScale.y,nt(e),this._moved||(this.fire("dragstart"),this._moved=!0,pe(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),pe(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(s),this._moving=!0,this._lastEvent=e,this._updatePosition())}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),Qe(this._element,this._newPos),this.fire("drag",e)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(e){Ke(document.body,"leaflet-dragging"),this._lastTarget&&(Ke(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),$e(document,"mousemove touchmove",this._onMove,this),$e(document,"mouseup touchend touchcancel",this._onUp,this),Ms(),Mi();var i=this._moved&&this._moving;this._moving=!1,Gt._dragging=!1,i&&this.fire("dragend",{noInertia:e,distance:this._newPos.distanceTo(this._startPos)})}});function On(e,i,s){var o,l=[1,4,2,8],m,_,b,T,O,U,ne,ge;for(m=0,U=e.length;m<U;m++)e[m]._code=si(e[m],i);for(b=0;b<4;b++){for(ne=l[b],o=[],m=0,U=e.length,_=U-1;m<U;_=m++)T=e[m],O=e[_],T._code&ne?O._code&ne||(ge=Qi(O,T,ne,i,s),ge._code=si(ge,i),o.push(ge)):(O._code&ne&&(ge=Qi(O,T,ne,i,s),ge._code=si(ge,i),o.push(ge)),o.push(T));e=o}return e}function zn(e,i){var s,o,l,m,_,b,T,O,U;if(!e||e.length===0)throw new Error("latlngs not passed");Ct(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var ne=se([0,0]),ge=Ie(e),ut=ge.getNorthWest().distanceTo(ge.getSouthWest())*ge.getNorthEast().distanceTo(ge.getNorthWest());ut<1700&&(ne=Rs(e));var tt=e.length,Mt=[];for(s=0;s<tt;s++){var pt=se(e[s]);Mt.push(i.project(se([pt.lat-ne.lat,pt.lng-ne.lng])))}for(b=T=O=0,s=0,o=tt-1;s<tt;o=s++)l=Mt[s],m=Mt[o],_=l.y*m.x-m.y*l.x,T+=(l.x+m.x)*_,O+=(l.y+m.y)*_,b+=_*3;b===0?U=Mt[0]:U=[T/b,O/b];var mi=i.unproject(Y(U));return se([mi.lat+ne.lat,mi.lng+ne.lng])}function Rs(e){for(var i=0,s=0,o=0,l=0;l<e.length;l++){var m=se(e[l]);i+=m.lat,s+=m.lng,o++}return se([i/o,s/o])}var ba={__proto__:null,clipPolygon:On,polygonCenter:zn,centroid:Rs};function En(e,i){if(!i||!e.length)return e.slice();var s=i*i;return e=Pa(e,s),e=ka(e,s),e}function $n(e,i,s){return Math.sqrt(Di(e,i,s,!0))}function wa(e,i,s){return Di(e,i,s)}function ka(e,i){var s=e.length,o=typeof Uint8Array<"u"?Uint8Array:Array,l=new o(s);l[0]=l[s-1]=1,Fs(e,l,i,0,s-1);var m,_=[];for(m=0;m<s;m++)l[m]&&_.push(e[m]);return _}function Fs(e,i,s,o,l){var m=0,_,b,T;for(b=o+1;b<=l-1;b++)T=Di(e[b],e[o],e[l],!0),T>m&&(_=b,m=T);m>s&&(i[_]=1,Fs(e,i,s,o,_),Fs(e,i,s,_,l))}function Pa(e,i){for(var s=[e[0]],o=1,l=0,m=e.length;o<m;o++)Ta(e[o],e[l])>i&&(s.push(e[o]),l=o);return l<m-1&&s.push(e[m-1]),s}var Bn;function Rn(e,i,s,o,l){var m=o?Bn:si(e,s),_=si(i,s),b,T,O;for(Bn=_;;){if(!(m|_))return[e,i];if(m&_)return!1;b=m||_,T=Qi(e,i,b,s,l),O=si(T,s),b===m?(e=T,m=O):(i=T,_=O)}}function Qi(e,i,s,o,l){var m=i.x-e.x,_=i.y-e.y,b=o.min,T=o.max,O,U;return s&8?(O=e.x+m*(T.y-e.y)/_,U=T.y):s&4?(O=e.x+m*(b.y-e.y)/_,U=b.y):s&2?(O=T.x,U=e.y+_*(T.x-e.x)/m):s&1&&(O=b.x,U=e.y+_*(b.x-e.x)/m),new Z(O,U,l)}function si(e,i){var s=0;return e.x<i.min.x?s|=1:e.x>i.max.x&&(s|=2),e.y<i.min.y?s|=4:e.y>i.max.y&&(s|=8),s}function Ta(e,i){var s=i.x-e.x,o=i.y-e.y;return s*s+o*o}function Di(e,i,s,o){var l=i.x,m=i.y,_=s.x-l,b=s.y-m,T=_*_+b*b,O;return T>0&&(O=((e.x-l)*_+(e.y-m)*b)/T,O>1?(l=s.x,m=s.y):O>0&&(l+=_*O,m+=b*O)),_=e.x-l,b=e.y-m,o?_*_+b*b:new Z(l,m)}function Ct(e){return!z(e[0])||typeof e[0][0]!="object"&&typeof e[0][0]<"u"}function Fn(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ct(e)}function qn(e,i){var s,o,l,m,_,b,T,O;if(!e||e.length===0)throw new Error("latlngs not passed");Ct(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var U=se([0,0]),ne=Ie(e),ge=ne.getNorthWest().distanceTo(ne.getSouthWest())*ne.getNorthEast().distanceTo(ne.getNorthWest());ge<1700&&(U=Rs(e));var ut=e.length,tt=[];for(s=0;s<ut;s++){var Mt=se(e[s]);tt.push(i.project(se([Mt.lat-U.lat,Mt.lng-U.lng])))}for(s=0,o=0;s<ut-1;s++)o+=tt[s].distanceTo(tt[s+1])/2;if(o===0)O=tt[0];else for(s=0,m=0;s<ut-1;s++)if(_=tt[s],b=tt[s+1],l=_.distanceTo(b),m+=l,m>o){T=(m-o)/l,O=[b.x-T*(b.x-_.x),b.y-T*(b.y-_.y)];break}var pt=i.unproject(Y(O));return se([pt.lat+U.lat,pt.lng+U.lng])}var La={__proto__:null,simplify:En,pointToSegmentDistance:$n,closestPointOnSegment:wa,clipSegment:Rn,_getEdgeIntersection:Qi,_getBitCode:si,_sqClosestPointOnSegment:Di,isFlat:Ct,_flat:Fn,polylineCenter:qn},qs={project:function(e){return new Z(e.lng,e.lat)},unproject:function(e){return new _e(e.y,e.x)},bounds:new be([-180,-90],[180,90])},Hs={R:6378137,R_MINOR:6356752314245179e-9,bounds:new be([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(e){var i=Math.PI/180,s=this.R,o=e.lat*i,l=this.R_MINOR/s,m=Math.sqrt(1-l*l),_=m*Math.sin(o),b=Math.tan(Math.PI/4-o/2)/Math.pow((1-_)/(1+_),m/2);return o=-s*Math.log(Math.max(b,1e-10)),new Z(e.lng*i*s,o)},unproject:function(e){for(var i=180/Math.PI,s=this.R,o=this.R_MINOR/s,l=Math.sqrt(1-o*o),m=Math.exp(-e.y/s),_=Math.PI/2-2*Math.atan(m),b=0,T=.1,O;b<15&&Math.abs(T)>1e-7;b++)O=l*Math.sin(_),O=Math.pow((1-O)/(1+O),l/2),T=Math.PI/2-2*Math.atan(m*O)-_,_+=T;return new _e(_*i,e.x*i/s)}},Ca={__proto__:null,LonLat:qs,Mercator:Hs,SphericalMercator:Tt},Ma=r({},at,{code:"EPSG:3395",projection:Hs,transformation:function(){var e=.5/(Math.PI*Hs.R);return x(e,.5,-e,.5)}()}),Hn=r({},at,{code:"EPSG:4326",projection:qs,transformation:x(1/180,1,-1/180,.5)}),Sa=r({},st,{projection:qs,transformation:x(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,i){var s=i.lng-e.lng,o=i.lat-e.lat;return Math.sqrt(s*s+o*o)},infinite:!0});st.Earth=at,st.EPSG3395=Ma,st.EPSG3857=j,st.EPSG900913=ie,st.EPSG4326=Hn,st.Simple=Sa;var Dt=Se.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[d(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[d(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var i=e.target;if(i.hasLayer(this)){if(this._map=i,this._zoomAnimated=i._zoomAnimated,this.getEvents){var s=this.getEvents();i.on(s,this),this.once("remove",function(){i.off(s,this)},this)}this.onAdd(i),this.fire("add"),i.fire("layeradd",{layer:this})}}});Te.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var i=d(e);return this._layers[i]?this:(this._layers[i]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e),this)},removeLayer:function(e){var i=d(e);return this._layers[i]?(this._loaded&&e.onRemove(this),delete this._layers[i],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return d(e)in this._layers},eachLayer:function(e,i){for(var s in this._layers)e.call(i,this._layers[s]);return this},_addLayers:function(e){e=e?z(e)?e:[e]:[];for(var i=0,s=e.length;i<s;i++)this.addLayer(e[i])},_addZoomLimit:function(e){(!isNaN(e.options.maxZoom)||!isNaN(e.options.minZoom))&&(this._zoomBoundLayers[d(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var i=d(e);this._zoomBoundLayers[i]&&(delete this._zoomBoundLayers[i],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,i=-1/0,s=this._getZoomSpan();for(var o in this._zoomBoundLayers){var l=this._zoomBoundLayers[o].options;e=l.minZoom===void 0?e:Math.min(e,l.minZoom),i=l.maxZoom===void 0?i:Math.max(i,l.maxZoom)}this._layersMaxZoom=i===-1/0?void 0:i,this._layersMinZoom=e===1/0?void 0:e,s!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ui=Dt.extend({initialize:function(e,i){I(this,i),this._layers={};var s,o;if(e)for(s=0,o=e.length;s<o;s++)this.addLayer(e[s])},addLayer:function(e){var i=this.getLayerId(e);return this._layers[i]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var i=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[i]&&this._map.removeLayer(this._layers[i]),delete this._layers[i],this},hasLayer:function(e){var i=typeof e=="number"?e:this.getLayerId(e);return i in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var i=Array.prototype.slice.call(arguments,1),s,o;for(s in this._layers)o=this._layers[s],o[e]&&o[e].apply(o,i);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,i){for(var s in this._layers)e.call(i,this._layers[s]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return d(e)}}),xa=function(e,i){return new ui(e,i)},qt=ui.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),ui.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),ui.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new Fe;for(var i in this._layers){var s=this._layers[i];e.extend(s.getBounds?s.getBounds():s.getLatLng())}return e}}),Ia=function(e,i){return new qt(e,i)},hi=H.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(e){I(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,i){var s=this._getIconUrl(e);if(!s){if(e==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var o=this._createImg(s,i&&i.tagName==="IMG"?i:null);return this._setIconStyles(o,e),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),o},_setIconStyles:function(e,i){var s=this.options,o=s[i+"Size"];typeof o=="number"&&(o=[o,o]);var l=Y(o),m=Y(i==="shadow"&&s.shadowAnchor||s.iconAnchor||l&&l.divideBy(2,!0));e.className="leaflet-marker-"+i+" "+(s.className||""),m&&(e.style.marginLeft=-m.x+"px",e.style.marginTop=-m.y+"px"),l&&(e.style.width=l.x+"px",e.style.height=l.y+"px")},_createImg:function(e,i){return i=i||document.createElement("img"),i.src=e,i},_getIconUrl:function(e){return Q.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function Da(e){return new hi(e)}var Ai=hi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return typeof Ai.imagePath!="string"&&(Ai.imagePath=this._detectIconPath()),(this.options.imagePath||Ai.imagePath)+hi.prototype._getIconUrl.call(this,e)},_stripUrl:function(e){var i=function(s,o,l){var m=o.exec(s);return m&&m[l]};return e=i(e,/^url\((['"])?(.+)\1\)$/,2),e&&i(e,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var e=Me("div","leaflet-default-icon-path",document.body),i=Li(e,"background-image")||Li(e,"backgroundImage");if(document.body.removeChild(e),i=this._stripUrl(i),i)return i;var s=document.querySelector('link[href$="leaflet.css"]');return s?s.href.substring(0,s.href.length-11-1):""}}),Zn=Et.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new Gt(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),pe(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ke(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var i=this._marker,s=i._map,o=this._marker.options.autoPanSpeed,l=this._marker.options.autoPanPadding,m=ei(i._icon),_=s.getPixelBounds(),b=s.getPixelOrigin(),T=Ae(_.min._subtract(b).add(l),_.max._subtract(b).subtract(l));if(!T.contains(m)){var O=Y((Math.max(T.max.x,m.x)-T.max.x)/(_.max.x-T.max.x)-(Math.min(T.min.x,m.x)-T.min.x)/(_.min.x-T.min.x),(Math.max(T.max.y,m.y)-T.max.y)/(_.max.y-T.max.y)-(Math.min(T.min.y,m.y)-T.min.y)/(_.min.y-T.min.y)).multiplyBy(o);s.panBy(O,{animate:!1}),this._draggable._newPos._add(O),this._draggable._startPos._add(O),Qe(i._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=le(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(F(this._panRequest),this._panRequest=le(this._adjustPan.bind(this,e)))},_onDrag:function(e){var i=this._marker,s=i._shadow,o=ei(i._icon),l=i._map.layerPointToLatLng(o);s&&Qe(s,o),i._latlng=l,e.latlng=l,e.oldLatLng=this._oldLatLng,i.fire("move",e).fire("drag",e)},_onDragEnd:function(e){F(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),Yi=Dt.extend({options:{icon:new Ai,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,i){I(this,i),this._latlng=se(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var i=this._latlng;return this._latlng=se(e),this.update(),this.fire("move",{oldLatLng:i,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,i="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),s=e.icon.createIcon(this._icon),o=!1;s!==this._icon&&(this._icon&&this._removeIcon(),o=!0,e.title&&(s.title=e.title),s.tagName==="IMG"&&(s.alt=e.alt||"")),pe(s,i),e.keyboard&&(s.tabIndex="0",s.setAttribute("role","button")),this._icon=s,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&de(s,"focus",this._panOnFocus,this);var l=e.icon.createShadow(this._shadow),m=!1;l!==this._shadow&&(this._removeShadow(),m=!0),l&&(pe(l,i),l.alt=""),this._shadow=l,e.opacity<1&&this._updateOpacity(),o&&this.getPane().appendChild(this._icon),this._initInteraction(),l&&m&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&$e(this._icon,"focus",this._panOnFocus,this),We(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&We(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&Qe(this._icon,e),this._shadow&&Qe(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var i=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(i)},_initInteraction:function(){if(this.options.interactive&&(pe(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Zn)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Zn(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&Lt(this._icon,e),this._shadow&&Lt(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var e=this._map;if(e){var i=this.options.icon.options,s=i.iconSize?Y(i.iconSize):Y(0,0),o=i.iconAnchor?Y(i.iconAnchor):Y(0,0);e.panInside(this._latlng,{paddingTopLeft:o,paddingBottomRight:s.subtract(o)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Aa(e,i){return new Yi(e,i)}var jt=Dt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return I(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Xi=jt.extend({options:{fill:!0,radius:10},initialize:function(e,i){I(this,i),this._latlng=se(e),this._radius=this.options.radius},setLatLng:function(e){var i=this._latlng;return this._latlng=se(e),this.redraw(),this.fire("move",{oldLatLng:i,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var i=e&&e.radius||this._radius;return jt.prototype.setStyle.call(this,e),this.setRadius(i),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,i=this._radiusY||e,s=this._clickTolerance(),o=[e+s,i+s];this._pxBounds=new be(this._point.subtract(o),this._point.add(o))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Oa(e,i){return new Xi(e,i)}var Zs=Xi.extend({initialize:function(e,i,s){if(typeof i=="number"&&(i=r({},s,{radius:i})),I(this,i),this._latlng=se(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new Fe(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:jt.prototype.setStyle,_project:function(){var e=this._latlng.lng,i=this._latlng.lat,s=this._map,o=s.options.crs;if(o.distance===at.distance){var l=Math.PI/180,m=this._mRadius/at.R/l,_=s.project([i+m,e]),b=s.project([i-m,e]),T=_.add(b).divideBy(2),O=s.unproject(T).lat,U=Math.acos((Math.cos(m*l)-Math.sin(i*l)*Math.sin(O*l))/(Math.cos(i*l)*Math.cos(O*l)))/l;(isNaN(U)||U===0)&&(U=m/Math.cos(Math.PI/180*i)),this._point=T.subtract(s.getPixelOrigin()),this._radius=isNaN(U)?0:T.x-s.project([O,e-U]).x,this._radiusY=T.y-_.y}else{var ne=o.unproject(o.project(this._latlng).subtract([this._mRadius,0]));this._point=s.latLngToLayerPoint(this._latlng),this._radius=this._point.x-s.latLngToLayerPoint(ne).x}this._updateBounds()}});function za(e,i,s){return new Zs(e,i,s)}var Ht=jt.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,i){I(this,i),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var i=1/0,s=null,o=Di,l,m,_=0,b=this._parts.length;_<b;_++)for(var T=this._parts[_],O=1,U=T.length;O<U;O++){l=T[O-1],m=T[O];var ne=o(e,l,m,!0);ne<i&&(i=ne,s=o(e,l,m))}return s&&(s.distance=Math.sqrt(i)),s},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return qn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(e,i){return i=i||this._defaultShape(),e=se(e),i.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new Fe,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return Ct(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var i=[],s=Ct(e),o=0,l=e.length;o<l;o++)s?(i[o]=se(e[o]),this._bounds.extend(i[o])):i[o]=this._convertLatLngs(e[o]);return i},_project:function(){var e=new be;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),i=new Z(e,e);this._rawPxBounds&&(this._pxBounds=new be([this._rawPxBounds.min.subtract(i),this._rawPxBounds.max.add(i)]))},_projectLatlngs:function(e,i,s){var o=e[0]instanceof _e,l=e.length,m,_;if(o){for(_=[],m=0;m<l;m++)_[m]=this._map.latLngToLayerPoint(e[m]),s.extend(_[m]);i.push(_)}else for(m=0;m<l;m++)this._projectLatlngs(e[m],i,s)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}var i=this._parts,s,o,l,m,_,b,T;for(s=0,l=0,m=this._rings.length;s<m;s++)for(T=this._rings[s],o=0,_=T.length;o<_-1;o++)b=Rn(T[o],T[o+1],e,o,!0),b&&(i[l]=i[l]||[],i[l].push(b[0]),(b[1]!==T[o+1]||o===_-2)&&(i[l].push(b[1]),l++))}},_simplifyPoints:function(){for(var e=this._parts,i=this.options.smoothFactor,s=0,o=e.length;s<o;s++)e[s]=En(e[s],i)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,i){var s,o,l,m,_,b,T=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(s=0,m=this._parts.length;s<m;s++)for(b=this._parts[s],o=0,_=b.length,l=_-1;o<_;l=o++)if(!(!i&&o===0)&&$n(e,b[l],b[o])<=T)return!0;return!1}});function Ea(e,i){return new Ht(e,i)}Ht._flat=Fn;var ci=Ht.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return zn(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(e){var i=Ht.prototype._convertLatLngs.call(this,e),s=i.length;return s>=2&&i[0]instanceof _e&&i[0].equals(i[s-1])&&i.pop(),i},_setLatLngs:function(e){Ht.prototype._setLatLngs.call(this,e),Ct(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ct(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,i=this.options.weight,s=new Z(i,i);if(e=new be(e.min.subtract(s),e.max.add(s)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}for(var o=0,l=this._rings.length,m;o<l;o++)m=On(this._rings[o],e,!0),m.length&&this._parts.push(m)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var i=!1,s,o,l,m,_,b,T,O;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(m=0,T=this._parts.length;m<T;m++)for(s=this._parts[m],_=0,O=s.length,b=O-1;_<O;b=_++)o=s[_],l=s[b],o.y>e.y!=l.y>e.y&&e.x<(l.x-o.x)*(e.y-o.y)/(l.y-o.y)+o.x&&(i=!i);return i||Ht.prototype._containsPoint.call(this,e,!0)}});function $a(e,i){return new ci(e,i)}var Zt=qt.extend({initialize:function(e,i){I(this,i),this._layers={},e&&this.addData(e)},addData:function(e){var i=z(e)?e:e.features,s,o,l;if(i){for(s=0,o=i.length;s<o;s++)l=i[s],(l.geometries||l.geometry||l.features||l.coordinates)&&this.addData(l);return this}var m=this.options;if(m.filter&&!m.filter(e))return this;var _=Ji(e,m);return _?(_.feature=is(e),_.defaultOptions=_.options,this.resetStyle(_),m.onEachFeature&&m.onEachFeature(e,_),this.addLayer(_)):this},resetStyle:function(e){return e===void 0?this.eachLayer(this.resetStyle,this):(e.options=r({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer(function(i){this._setLayerStyle(i,e)},this)},_setLayerStyle:function(e,i){e.setStyle&&(typeof i=="function"&&(i=i(e.feature)),e.setStyle(i))}});function Ji(e,i){var s=e.type==="Feature"?e.geometry:e,o=s?s.coordinates:null,l=[],m=i&&i.pointToLayer,_=i&&i.coordsToLatLng||Vs,b,T,O,U;if(!o&&!s)return null;switch(s.type){case"Point":return b=_(o),Vn(m,e,b,i);case"MultiPoint":for(O=0,U=o.length;O<U;O++)b=_(o[O]),l.push(Vn(m,e,b,i));return new qt(l);case"LineString":case"MultiLineString":return T=es(o,s.type==="LineString"?0:1,_),new Ht(T,i);case"Polygon":case"MultiPolygon":return T=es(o,s.type==="Polygon"?1:2,_),new ci(T,i);case"GeometryCollection":for(O=0,U=s.geometries.length;O<U;O++){var ne=Ji({geometry:s.geometries[O],type:"Feature",properties:e.properties},i);ne&&l.push(ne)}return new qt(l);case"FeatureCollection":for(O=0,U=s.features.length;O<U;O++){var ge=Ji(s.features[O],i);ge&&l.push(ge)}return new qt(l);default:throw new Error("Invalid GeoJSON object.")}}function Vn(e,i,s,o){return e?e(i,s):new Yi(s,o&&o.markersInheritOptions&&o)}function Vs(e){return new _e(e[1],e[0],e[2])}function es(e,i,s){for(var o=[],l=0,m=e.length,_;l<m;l++)_=i?es(e[l],i-1,s):(s||Vs)(e[l]),o.push(_);return o}function Ns(e,i){return e=se(e),e.alt!==void 0?[v(e.lng,i),v(e.lat,i),v(e.alt,i)]:[v(e.lng,i),v(e.lat,i)]}function ts(e,i,s,o){for(var l=[],m=0,_=e.length;m<_;m++)l.push(i?ts(e[m],Ct(e[m])?0:i-1,s,o):Ns(e[m],o));return!i&&s&&l.length>0&&l.push(l[0].slice()),l}function di(e,i){return e.feature?r({},e.feature,{geometry:i}):is(i)}function is(e){return e.type==="Feature"||e.type==="FeatureCollection"?e:{type:"Feature",properties:{},geometry:e}}var Us={toGeoJSON:function(e){return di(this,{type:"Point",coordinates:Ns(this.getLatLng(),e)})}};Yi.include(Us),Zs.include(Us),Xi.include(Us),Ht.include({toGeoJSON:function(e){var i=!Ct(this._latlngs),s=ts(this._latlngs,i?1:0,!1,e);return di(this,{type:(i?"Multi":"")+"LineString",coordinates:s})}}),ci.include({toGeoJSON:function(e){var i=!Ct(this._latlngs),s=i&&!Ct(this._latlngs[0]),o=ts(this._latlngs,s?2:i?1:0,!0,e);return i||(o=[o]),di(this,{type:(s?"Multi":"")+"Polygon",coordinates:o})}}),ui.include({toMultiPoint:function(e){var i=[];return this.eachLayer(function(s){i.push(s.toGeoJSON(e).geometry.coordinates)}),di(this,{type:"MultiPoint",coordinates:i})},toGeoJSON:function(e){var i=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(i==="MultiPoint")return this.toMultiPoint(e);var s=i==="GeometryCollection",o=[];return this.eachLayer(function(l){if(l.toGeoJSON){var m=l.toGeoJSON(e);if(s)o.push(m.geometry);else{var _=is(m);_.type==="FeatureCollection"?o.push.apply(o,_.features):o.push(_)}}}),s?di(this,{geometries:o,type:"GeometryCollection"}):{type:"FeatureCollection",features:o}}});function Nn(e,i){return new Zt(e,i)}var Ba=Nn,ss=Dt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,i,s){this._url=e,this._bounds=Ie(i),I(this,s)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(pe(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){We(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&ri(this._image),this},bringToBack:function(){return this._map&&li(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=Ie(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e=this._url.tagName==="IMG",i=this._image=e?this._url:Me("img");if(pe(i,"leaflet-image-layer"),this._zoomAnimated&&pe(i,"leaflet-zoom-animated"),this.options.className&&pe(i,this.options.className),i.onselectstart=y,i.onmousemove=y,i.onload=c(this.fire,this,"load"),i.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(i.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e){this._url=i.src;return}i.src=this._url,i.alt=this.options.alt},_animateZoom:function(e){var i=this._map.getZoomScale(e.zoom),s=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;Jt(this._image,s,i)},_reset:function(){var e=this._image,i=new be(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),s=i.getSize();Qe(e,i.min),e.style.width=s.x+"px",e.style.height=s.y+"px"},_updateOpacity:function(){Lt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)},getCenter:function(){return this._bounds.getCenter()}}),Ra=function(e,i,s){return new ss(e,i,s)},Un=ss.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var e=this._url.tagName==="VIDEO",i=this._image=e?this._url:Me("video");if(pe(i,"leaflet-image-layer"),this._zoomAnimated&&pe(i,"leaflet-zoom-animated"),this.options.className&&pe(i,this.options.className),i.onselectstart=y,i.onmousemove=y,i.onloadeddata=c(this.fire,this,"load"),e){for(var s=i.getElementsByTagName("source"),o=[],l=0;l<s.length;l++)o.push(s[l].src);this._url=s.length>0?o:[i.src];return}z(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(i.style,"objectFit")&&(i.style.objectFit="fill"),i.autoplay=!!this.options.autoplay,i.loop=!!this.options.loop,i.muted=!!this.options.muted,i.playsInline=!!this.options.playsInline;for(var m=0;m<this._url.length;m++){var _=Me("source");_.src=this._url[m],i.appendChild(_)}}});function Fa(e,i,s){return new Un(e,i,s)}var Wn=ss.extend({_initImage:function(){var e=this._image=this._url;pe(e,"leaflet-image-layer"),this._zoomAnimated&&pe(e,"leaflet-zoom-animated"),this.options.className&&pe(e,this.options.className),e.onselectstart=y,e.onmousemove=y}});function qa(e,i,s){return new Wn(e,i,s)}var $t=Dt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(e,i){e&&(e instanceof _e||z(e))?(this._latlng=se(e),I(this,i)):(I(this,e),this._source=i),this.options.content&&(this._content=this.options.content)},openOn:function(e){return e=arguments.length?e:this._source._map,e.hasLayer(this)||e.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(e){return this._map?this.close():(arguments.length?this._source=e:e=this._source,this._prepareOpen(),this.openOn(e._map)),this},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&Lt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&Lt(this._container,1),this.bringToFront(),this.options.interactive&&(pe(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(e){e._fadeAnimated?(Lt(this._container,0),this._removeTimeout=setTimeout(c(We,void 0,this._container),200)):We(this._container),this.options.interactive&&(Ke(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=se(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ri(this._container),this},bringToBack:function(){return this._map&&li(this._container),this},_prepareOpen:function(e){var i=this._source;if(!i._map)return!1;if(i instanceof qt){i=null;var s=this._source._layers;for(var o in s)if(s[o]._map){i=s[o];break}if(!i)return!1;this._source=i}if(!e)if(i.getCenter)e=i.getCenter();else if(i.getLatLng)e=i.getLatLng();else if(i.getBounds)e=i.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(e),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var e=this._contentNode,i=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof i=="string")e.innerHTML=i;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(i)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),i=Y(this.options.offset),s=this._getAnchor();this._zoomAnimated?Qe(this._container,e.add(s)):i=i.add(e).add(s);var o=this._containerBottom=-i.y,l=this._containerLeft=-Math.round(this._containerWidth/2)+i.x;this._container.style.bottom=o+"px",this._container.style.left=l+"px"}},_getAnchor:function(){return[0,0]}});Te.include({_initOverlay:function(e,i,s,o){var l=i;return l instanceof e||(l=new e(o).setContent(i)),s&&l.setLatLng(s),l}}),Dt.include({_initOverlay:function(e,i,s,o){var l=s;return l instanceof e?(I(l,o),l._source=this):(l=i&&!o?i:new e(o,this),l.setContent(s)),l}});var ns=$t.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return e=arguments.length?e:this._source._map,!e.hasLayer(this)&&e._popup&&e._popup.options.autoClose&&e.removeLayer(e._popup),e._popup=this,$t.prototype.openOn.call(this,e)},onAdd:function(e){$t.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof jt||this._source.on("preclick",ti))},onRemove:function(e){$t.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof jt||this._source.off("preclick",ti))},getEvents:function(){var e=$t.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this.close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_initLayout:function(){var e="leaflet-popup",i=this._container=Me("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),s=this._wrapper=Me("div",e+"-content-wrapper",i);if(this._contentNode=Me("div",e+"-content",s),xi(i),zs(this._contentNode),de(i,"contextmenu",ti),this._tipContainer=Me("div",e+"-tip-container",i),this._tip=Me("div",e+"-tip",this._tipContainer),this.options.closeButton){var o=this._closeButton=Me("a",e+"-close-button",i);o.setAttribute("role","button"),o.setAttribute("aria-label","Close popup"),o.href="#close",o.innerHTML='<span aria-hidden="true">&#215;</span>',de(o,"click",function(l){nt(l),this.close()},this)}},_updateLayout:function(){var e=this._contentNode,i=e.style;i.width="",i.whiteSpace="nowrap";var s=e.offsetWidth;s=Math.min(s,this.options.maxWidth),s=Math.max(s,this.options.minWidth),i.width=s+1+"px",i.whiteSpace="",i.height="";var o=e.offsetHeight,l=this.options.maxHeight,m="leaflet-popup-scrolled";l&&o>l?(i.height=l+"px",pe(e,m)):Ke(e,m),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var i=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),s=this._getAnchor();Qe(this._container,i.add(s))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var e=this._map,i=parseInt(Li(this._container,"marginBottom"),10)||0,s=this._container.offsetHeight+i,o=this._containerWidth,l=new Z(this._containerLeft,-s-this._containerBottom);l._add(ei(this._container));var m=e.layerPointToContainerPoint(l),_=Y(this.options.autoPanPadding),b=Y(this.options.autoPanPaddingTopLeft||_),T=Y(this.options.autoPanPaddingBottomRight||_),O=e.getSize(),U=0,ne=0;m.x+o+T.x>O.x&&(U=m.x+o-O.x+T.x),m.x-U-b.x<0&&(U=m.x-b.x),m.y+s+T.y>O.y&&(ne=m.y+s-O.y+T.y),m.y-ne-b.y<0&&(ne=m.y-b.y),(U||ne)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([U,ne]))}},_getAnchor:function(){return Y(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ha=function(e,i){return new ns(e,i)};Te.mergeOptions({closePopupOnClick:!0}),Te.include({openPopup:function(e,i,s){return this._initOverlay(ns,e,i,s).openOn(this),this},closePopup:function(e){return e=arguments.length?e:this._popup,e&&e.close(),this}}),Dt.include({bindPopup:function(e,i){return this._popup=this._initOverlay(ns,this._popup,e,i),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e){return this._popup&&(this instanceof qt||(this._popup._source=this),this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){if(!(!this._popup||!this._map)){ii(e);var i=e.layer||e.target;if(this._popup._source===i&&!(i instanceof jt)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng);return}this._popup._source=i,this.openPopup(e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){e.originalEvent.keyCode===13&&this._openPopup(e)}});var os=$t.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(e){$t.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(e){$t.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var e=$t.prototype.getEvents.call(this);return this.options.permanent||(e.preclick=this.close),e},_initLayout:function(){var e="leaflet-tooltip",i=e+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Me("div",i),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var i,s,o=this._map,l=this._container,m=o.latLngToContainerPoint(o.getCenter()),_=o.layerPointToContainerPoint(e),b=this.options.direction,T=l.offsetWidth,O=l.offsetHeight,U=Y(this.options.offset),ne=this._getAnchor();b==="top"?(i=T/2,s=O):b==="bottom"?(i=T/2,s=0):b==="center"?(i=T/2,s=O/2):b==="right"?(i=0,s=O/2):b==="left"?(i=T,s=O/2):_.x<m.x?(b="right",i=0,s=O/2):(b="left",i=T+(U.x+ne.x)*2,s=O/2),e=e.subtract(Y(i,s,!0)).add(U).add(ne),Ke(l,"leaflet-tooltip-right"),Ke(l,"leaflet-tooltip-left"),Ke(l,"leaflet-tooltip-top"),Ke(l,"leaflet-tooltip-bottom"),pe(l,"leaflet-tooltip-"+b),Qe(l,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&Lt(this._container,e)},_animateZoom:function(e){var i=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(i)},_getAnchor:function(){return Y(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Za=function(e,i){return new os(e,i)};Te.include({openTooltip:function(e,i,s){return this._initOverlay(os,e,i,s).openOn(this),this},closeTooltip:function(e){return e.close(),this}}),Dt.include({bindTooltip:function(e,i){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(os,this._tooltip,e,i),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(!(!e&&this._tooltipHandlersAdded)){var i=e?"off":"on",s={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?s.add=this._openTooltip:(s.mouseover=this._openTooltip,s.mouseout=this.closeTooltip,s.click=this._openTooltip,this._map?this._addFocusListeners():s.add=this._addFocusListeners),this._tooltip.options.sticky&&(s.mousemove=this._moveTooltip),this[i](s),this._tooltipHandlersAdded=!e}},openTooltip:function(e){return this._tooltip&&(this instanceof qt||(this._tooltip._source=this),this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(e){var i=typeof e.getElement=="function"&&e.getElement();i&&(de(i,"focus",function(){this._tooltip._source=e,this.openTooltip()},this),de(i,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(e){var i=typeof e.getElement=="function"&&e.getElement();i&&i.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(e){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var i=this;this._map.once("moveend",function(){i._openOnceFlag=!1,i._openTooltip(e)});return}this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)}},_moveTooltip:function(e){var i=e.latlng,s,o;this._tooltip.options.sticky&&e.originalEvent&&(s=this._map.mouseEventToContainerPoint(e.originalEvent),o=this._map.containerPointToLayerPoint(s),i=this._map.layerPointToLatLng(o)),this._tooltip.setLatLng(i)}});var Gn=hi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var i=e&&e.tagName==="DIV"?e:document.createElement("div"),s=this.options;if(s.html instanceof Element?(Ui(i),i.appendChild(s.html)):i.innerHTML=s.html!==!1?s.html:"",s.bgPos){var o=Y(s.bgPos);i.style.backgroundPosition=-o.x+"px "+-o.y+"px"}return this._setIconStyles(i,"icon"),i},createShadow:function(){return null}});function Va(e){return new Gn(e)}hi.Default=Ai;var Oi=Dt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Q.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){I(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),We(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ri(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(li(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var e=this._clampZoom(this._map.getZoom());e!==this._tileZoom&&(this._tileZoom=e,this._updateLevels()),this._update()}return this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof Z?e:new Z(e,e)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var i=this.getPane().children,s=-e(-1/0,1/0),o=0,l=i.length,m;o<l;o++)m=i[o].style.zIndex,i[o]!==this._container&&m&&(s=e(s,+m));isFinite(s)&&(this.options.zIndex=s+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Q.ielt9){Lt(this._container,this.options.opacity);var e=+new Date,i=!1,s=!1;for(var o in this._tiles){var l=this._tiles[o];if(!(!l.current||!l.loaded)){var m=Math.min(1,(e-l.loaded)/200);Lt(l.el,m),m<1?i=!0:(l.active?s=!0:this._onOpaqueTile(l),l.active=!0)}}s&&!this._noPrune&&this._pruneTiles(),i&&(F(this._fadeFrame),this._fadeFrame=le(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=Me("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,i=this.options.maxZoom;if(e!==void 0){for(var s in this._levels)s=Number(s),this._levels[s].el.children.length||s===e?(this._levels[s].el.style.zIndex=i-Math.abs(e-s),this._onUpdateLevel(s)):(We(this._levels[s].el),this._removeTilesAtZoom(s),this._onRemoveLevel(s),delete this._levels[s]);var o=this._levels[e],l=this._map;return o||(o=this._levels[e]={},o.el=Me("div","leaflet-tile-container leaflet-zoom-animated",this._container),o.el.style.zIndex=i,o.origin=l.project(l.unproject(l.getPixelOrigin()),e).round(),o.zoom=e,this._setZoomTransform(o,l.getCenter(),l.getZoom()),y(o.el.offsetWidth),this._onCreateLevel(o)),this._level=o,o}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var e,i,s=this._map.getZoom();if(s>this.options.maxZoom||s<this.options.minZoom){this._removeAllTiles();return}for(e in this._tiles)i=this._tiles[e],i.retain=i.current;for(e in this._tiles)if(i=this._tiles[e],i.current&&!i.active){var o=i.coords;this._retainParent(o.x,o.y,o.z,o.z-5)||this._retainChildren(o.x,o.y,o.z,o.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}},_removeTilesAtZoom:function(e){for(var i in this._tiles)this._tiles[i].coords.z===e&&this._removeTile(i)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)We(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,i,s,o){var l=Math.floor(e/2),m=Math.floor(i/2),_=s-1,b=new Z(+l,+m);b.z=+_;var T=this._tileCoordsToKey(b),O=this._tiles[T];return O&&O.active?(O.retain=!0,!0):(O&&O.loaded&&(O.retain=!0),_>o?this._retainParent(l,m,_,o):!1)},_retainChildren:function(e,i,s,o){for(var l=2*e;l<2*e+2;l++)for(var m=2*i;m<2*i+2;m++){var _=new Z(l,m);_.z=s+1;var b=this._tileCoordsToKey(_),T=this._tiles[b];if(T&&T.active){T.retain=!0;continue}else T&&T.loaded&&(T.retain=!0);s+1<o&&this._retainChildren(l,m,s+1,o)}},_resetView:function(e){var i=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),i,i)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var i=this.options;return i.minNativeZoom!==void 0&&e<i.minNativeZoom?i.minNativeZoom:i.maxNativeZoom!==void 0&&i.maxNativeZoom<e?i.maxNativeZoom:e},_setView:function(e,i,s,o){var l=Math.round(i);this.options.maxZoom!==void 0&&l>this.options.maxZoom||this.options.minZoom!==void 0&&l<this.options.minZoom?l=void 0:l=this._clampZoom(l);var m=this.options.updateWhenZooming&&l!==this._tileZoom;(!o||m)&&(this._tileZoom=l,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),l!==void 0&&this._update(e),s||this._pruneTiles(),this._noPrune=!!s),this._setZoomTransforms(e,i)},_setZoomTransforms:function(e,i){for(var s in this._levels)this._setZoomTransform(this._levels[s],e,i)},_setZoomTransform:function(e,i,s){var o=this._map.getZoomScale(s,e.zoom),l=e.origin.multiplyBy(o).subtract(this._map._getNewPixelOrigin(i,s)).round();Q.any3d?Jt(e.el,l,o):Qe(e.el,l)},_resetGrid:function(){var e=this._map,i=e.options.crs,s=this._tileSize=this.getTileSize(),o=this._tileZoom,l=this._map.getPixelWorldBounds(this._tileZoom);l&&(this._globalTileRange=this._pxBoundsToTileRange(l)),this._wrapX=i.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,i.wrapLng[0]],o).x/s.x),Math.ceil(e.project([0,i.wrapLng[1]],o).x/s.y)],this._wrapY=i.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([i.wrapLat[0],0],o).y/s.x),Math.ceil(e.project([i.wrapLat[1],0],o).y/s.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(e){var i=this._map,s=i._animatingZoom?Math.max(i._animateToZoom,i.getZoom()):i.getZoom(),o=i.getZoomScale(s,this._tileZoom),l=i.project(e,this._tileZoom).floor(),m=i.getSize().divideBy(o*2);return new be(l.subtract(m),l.add(m))},_update:function(e){var i=this._map;if(i){var s=this._clampZoom(i.getZoom());if(e===void 0&&(e=i.getCenter()),this._tileZoom!==void 0){var o=this._getTiledPixelBounds(e),l=this._pxBoundsToTileRange(o),m=l.getCenter(),_=[],b=this.options.keepBuffer,T=new be(l.getBottomLeft().subtract([b,-b]),l.getTopRight().add([b,-b]));if(!(isFinite(l.min.x)&&isFinite(l.min.y)&&isFinite(l.max.x)&&isFinite(l.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var O in this._tiles){var U=this._tiles[O].coords;(U.z!==this._tileZoom||!T.contains(new Z(U.x,U.y)))&&(this._tiles[O].current=!1)}if(Math.abs(s-this._tileZoom)>1){this._setView(e,s);return}for(var ne=l.min.y;ne<=l.max.y;ne++)for(var ge=l.min.x;ge<=l.max.x;ge++){var ut=new Z(ge,ne);if(ut.z=this._tileZoom,!!this._isValidTile(ut)){var tt=this._tiles[this._tileCoordsToKey(ut)];tt?tt.current=!0:_.push(ut)}}if(_.sort(function(pt,mi){return pt.distanceTo(m)-mi.distanceTo(m)}),_.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Mt=document.createDocumentFragment();for(ge=0;ge<_.length;ge++)this._addTile(_[ge],Mt);this._level.el.appendChild(Mt)}}}},_isValidTile:function(e){var i=this._map.options.crs;if(!i.infinite){var s=this._globalTileRange;if(!i.wrapLng&&(e.x<s.min.x||e.x>s.max.x)||!i.wrapLat&&(e.y<s.min.y||e.y>s.max.y))return!1}if(!this.options.bounds)return!0;var o=this._tileCoordsToBounds(e);return Ie(this.options.bounds).overlaps(o)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var i=this._map,s=this.getTileSize(),o=e.scaleBy(s),l=o.add(s),m=i.unproject(o,e.z),_=i.unproject(l,e.z);return[m,_]},_tileCoordsToBounds:function(e){var i=this._tileCoordsToNwSe(e),s=new Fe(i[0],i[1]);return this.options.noWrap||(s=this._map.wrapLatLngBounds(s)),s},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var i=e.split(":"),s=new Z(+i[0],+i[1]);return s.z=+i[2],s},_removeTile:function(e){var i=this._tiles[e];i&&(We(i.el),delete this._tiles[e],this.fire("tileunload",{tile:i.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){pe(e,"leaflet-tile");var i=this.getTileSize();e.style.width=i.x+"px",e.style.height=i.y+"px",e.onselectstart=y,e.onmousemove=y,Q.ielt9&&this.options.opacity<1&&Lt(e,this.options.opacity)},_addTile:function(e,i){var s=this._getTilePos(e),o=this._tileCoordsToKey(e),l=this.createTile(this._wrapCoords(e),c(this._tileReady,this,e));this._initTile(l),this.createTile.length<2&&le(c(this._tileReady,this,e,null,l)),Qe(l,s),this._tiles[o]={el:l,coords:e,current:!0},i.appendChild(l),this.fire("tileloadstart",{tile:l,coords:e})},_tileReady:function(e,i,s){i&&this.fire("tileerror",{error:i,tile:s,coords:e});var o=this._tileCoordsToKey(e);s=this._tiles[o],s&&(s.loaded=+new Date,this._map._fadeAnimated?(Lt(s.el,0),F(this._fadeFrame),this._fadeFrame=le(this._updateOpacity,this)):(s.active=!0,this._pruneTiles()),i||(pe(s.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:s.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Q.ielt9||!this._map._fadeAnimated?le(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var i=new Z(this._wrapX?g(e.x,this._wrapX):e.x,this._wrapY?g(e.y,this._wrapY):e.y);return i.z=e.z,i},_pxBoundsToTileRange:function(e){var i=this.getTileSize();return new be(e.min.unscaleBy(i).floor(),e.max.unscaleBy(i).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function Na(e){return new Oi(e)}var fi=Oi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(e,i){this._url=e,i=I(this,i),i.detectRetina&&Q.retina&&i.maxZoom>0?(i.tileSize=Math.floor(i.tileSize/2),i.zoomReverse?(i.zoomOffset--,i.minZoom=Math.min(i.maxZoom,i.minZoom+1)):(i.zoomOffset++,i.maxZoom=Math.max(i.minZoom,i.maxZoom-1)),i.minZoom=Math.max(0,i.minZoom)):i.zoomReverse?i.minZoom=Math.min(i.maxZoom,i.minZoom):i.maxZoom=Math.max(i.minZoom,i.maxZoom),typeof i.subdomains=="string"&&(i.subdomains=i.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(e,i){return this._url===e&&i===void 0&&(i=!0),this._url=e,i||this.redraw(),this},createTile:function(e,i){var s=document.createElement("img");return de(s,"load",c(this._tileOnLoad,this,i,s)),de(s,"error",c(this._tileOnError,this,i,s)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(s.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(s.referrerPolicy=this.options.referrerPolicy),s.alt="",s.src=this.getTileUrl(e),s},getTileUrl:function(e){var i={r:Q.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var s=this._globalTileRange.max.y-e.y;this.options.tms&&(i.y=s),i["-y"]=s}return q(this._url,r(i,this.options))},_tileOnLoad:function(e,i){Q.ielt9?setTimeout(c(e,this,null,i),0):e(null,i)},_tileOnError:function(e,i,s){var o=this.options.errorTileUrl;o&&i.getAttribute("src")!==o&&(i.src=o),e(s,i)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,i=this.options.maxZoom,s=this.options.zoomReverse,o=this.options.zoomOffset;return s&&(e=i-e),e+o},_getSubdomain:function(e){var i=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[i]},_abortLoading:function(){var e,i;for(e in this._tiles)if(this._tiles[e].coords.z!==this._tileZoom&&(i=this._tiles[e].el,i.onload=y,i.onerror=y,!i.complete)){i.src=G;var s=this._tiles[e].coords;We(i),delete this._tiles[e],this.fire("tileabort",{tile:i,coords:s})}},_removeTile:function(e){var i=this._tiles[e];if(i)return i.el.setAttribute("src",G),Oi.prototype._removeTile.call(this,e)},_tileReady:function(e,i,s){if(!(!this._map||s&&s.getAttribute("src")===G))return Oi.prototype._tileReady.call(this,e,i,s)}});function jn(e,i){return new fi(e,i)}var Kn=fi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,i){this._url=e;var s=r({},this.defaultWmsParams);for(var o in i)o in this.options||(s[o]=i[o]);i=I(this,i);var l=i.detectRetina&&Q.retina?2:1,m=this.getTileSize();s.width=m.x*l,s.height=m.y*l,this.wmsParams=s},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var i=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[i]=this._crs.code,fi.prototype.onAdd.call(this,e)},getTileUrl:function(e){var i=this._tileCoordsToNwSe(e),s=this._crs,o=Ae(s.project(i[0]),s.project(i[1])),l=o.min,m=o.max,_=(this._wmsVersion>=1.3&&this._crs===Hn?[l.y,l.x,m.y,m.x]:[l.x,l.y,m.x,m.y]).join(","),b=fi.prototype.getTileUrl.call(this,e);return b+D(this.wmsParams,b,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+_},setParams:function(e,i){return r(this.wmsParams,e),i||this.redraw(),this}});function Ua(e,i){return new Kn(e,i)}fi.WMS=Kn,jn.wms=Ua;var Vt=Dt.extend({options:{padding:.1},initialize:function(e){I(this,e),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),pe(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,i){var s=this._map.getZoomScale(i,this._zoom),o=this._map.getSize().multiplyBy(.5+this.options.padding),l=this._map.project(this._center,i),m=o.multiplyBy(-s).add(l).subtract(this._map._getNewPixelOrigin(e,i));Q.any3d?Jt(this._container,m,s):Qe(this._container,m)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var e in this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,i=this._map.getSize(),s=this._map.containerPointToLayerPoint(i.multiplyBy(-e)).round();this._bounds=new be(s,s.add(i.multiplyBy(1+e*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Qn=Vt.extend({options:{tolerance:0},getEvents:function(){var e=Vt.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Vt.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");de(e,"mousemove",this._onMouseMove,this),de(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),de(e,"mouseout",this._handleMouseOut,this),e._leaflet_disable_events=!0,this._ctx=e.getContext("2d")},_destroyContainer:function(){F(this._redrawRequest),delete this._ctx,We(this._container),$e(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var e;this._redrawBounds=null;for(var i in this._layers)e=this._layers[i],e._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Vt.prototype._update.call(this);var e=this._bounds,i=this._container,s=e.getSize(),o=Q.retina?2:1;Qe(i,e.min),i.width=o*s.x,i.height=o*s.y,i.style.width=s.x+"px",i.style.height=s.y+"px",Q.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){Vt.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[d(e)]=e;var i=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=i),this._drawLast=i,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var i=e._order,s=i.next,o=i.prev;s?s.prev=o:this._drawLast=o,o?o.next=s:this._drawFirst=s,delete e._order,delete this._layers[d(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if(typeof e.options.dashArray=="string"){var i=e.options.dashArray.split(/[, ]+/),s=[],o,l;for(l=0;l<i.length;l++){if(o=Number(i[l]),isNaN(o))return;s.push(o)}e.options._dashArray=s}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||le(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var i=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new be,this._redrawBounds.extend(e._pxBounds.min.subtract([i,i])),this._redrawBounds.extend(e._pxBounds.max.add([i,i]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var i=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,i.x,i.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,i=this._redrawBounds;if(this._ctx.save(),i){var s=i.getSize();this._ctx.beginPath(),this._ctx.rect(i.min.x,i.min.y,s.x,s.y),this._ctx.clip()}this._drawing=!0;for(var o=this._drawFirst;o;o=o.next)e=o.layer,(!i||e._pxBounds&&e._pxBounds.intersects(i))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,i){if(this._drawing){var s,o,l,m,_=e._parts,b=_.length,T=this._ctx;if(b){for(T.beginPath(),s=0;s<b;s++){for(o=0,l=_[s].length;o<l;o++)m=_[s][o],T[o?"lineTo":"moveTo"](m.x,m.y);i&&T.closePath()}this._fillStroke(T,e)}}},_updateCircle:function(e){if(!(!this._drawing||e._empty())){var i=e._point,s=this._ctx,o=Math.max(Math.round(e._radius),1),l=(Math.max(Math.round(e._radiusY),1)||o)/o;l!==1&&(s.save(),s.scale(1,l)),s.beginPath(),s.arc(i.x,i.y/l,o,0,Math.PI*2,!1),l!==1&&s.restore(),this._fillStroke(s,e)}},_fillStroke:function(e,i){var s=i.options;s.fill&&(e.globalAlpha=s.fillOpacity,e.fillStyle=s.fillColor||s.color,e.fill(s.fillRule||"evenodd")),s.stroke&&s.weight!==0&&(e.setLineDash&&e.setLineDash(i.options&&i.options._dashArray||[]),e.globalAlpha=s.opacity,e.lineWidth=s.weight,e.strokeStyle=s.color,e.lineCap=s.lineCap,e.lineJoin=s.lineJoin,e.stroke())},_onClick:function(e){for(var i=this._map.mouseEventToLayerPoint(e),s,o,l=this._drawFirst;l;l=l.next)s=l.layer,s.options.interactive&&s._containsPoint(i)&&(!(e.type==="click"||e.type==="preclick")||!this._map._draggableMoved(s))&&(o=s);this._fireEvent(o?[o]:!1,e)},_onMouseMove:function(e){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var i=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,i)}},_handleMouseOut:function(e){var i=this._hoveredLayer;i&&(Ke(this._container,"leaflet-interactive"),this._fireEvent([i],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,i){if(!this._mouseHoverThrottled){for(var s,o,l=this._drawFirst;l;l=l.next)s=l.layer,s.options.interactive&&s._containsPoint(i)&&(o=s);o!==this._hoveredLayer&&(this._handleMouseOut(e),o&&(pe(this._container,"leaflet-interactive"),this._fireEvent([o],e,"mouseover"),this._hoveredLayer=o)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,e),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(e,i,s){this._map._fireDOMEvent(i,s||i.type,e)},_bringToFront:function(e){var i=e._order;if(i){var s=i.next,o=i.prev;if(s)s.prev=o;else return;o?o.next=s:s&&(this._drawFirst=s),i.prev=this._drawLast,this._drawLast.next=i,i.next=null,this._drawLast=i,this._requestRedraw(e)}},_bringToBack:function(e){var i=e._order;if(i){var s=i.next,o=i.prev;if(o)o.next=s;else return;s?s.prev=o:o&&(this._drawLast=o),i.prev=null,i.next=this._drawFirst,this._drawFirst.prev=i,this._drawFirst=i,this._requestRedraw(e)}}});function Yn(e){return Q.canvas?new Qn(e):null}var zi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch{}return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Wa={_initContainer:function(){this._container=Me("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Vt.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var i=e._container=zi("shape");pe(i,"leaflet-vml-shape "+(this.options.className||"")),i.coordsize="1 1",e._path=zi("path"),i.appendChild(e._path),this._updateStyle(e),this._layers[d(e)]=e},_addPath:function(e){var i=e._container;this._container.appendChild(i),e.options.interactive&&e.addInteractiveTarget(i)},_removePath:function(e){var i=e._container;We(i),e.removeInteractiveTarget(i),delete this._layers[d(e)]},_updateStyle:function(e){var i=e._stroke,s=e._fill,o=e.options,l=e._container;l.stroked=!!o.stroke,l.filled=!!o.fill,o.stroke?(i||(i=e._stroke=zi("stroke")),l.appendChild(i),i.weight=o.weight+"px",i.color=o.color,i.opacity=o.opacity,o.dashArray?i.dashStyle=z(o.dashArray)?o.dashArray.join(" "):o.dashArray.replace(/( *, *)/g," "):i.dashStyle="",i.endcap=o.lineCap.replace("butt","flat"),i.joinstyle=o.lineJoin):i&&(l.removeChild(i),e._stroke=null),o.fill?(s||(s=e._fill=zi("fill")),l.appendChild(s),s.color=o.fillColor||o.color,s.opacity=o.fillOpacity):s&&(l.removeChild(s),e._fill=null)},_updateCircle:function(e){var i=e._point.round(),s=Math.round(e._radius),o=Math.round(e._radiusY||s);this._setPath(e,e._empty()?"M0 0":"AL "+i.x+","+i.y+" "+s+","+o+" 0,"+65535*360)},_setPath:function(e,i){e._path.v=i},_bringToFront:function(e){ri(e._container)},_bringToBack:function(e){li(e._container)}},as=Q.vml?zi:ce,Ei=Vt.extend({_initContainer:function(){this._container=as("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=as("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){We(this._container),$e(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Vt.prototype._update.call(this);var e=this._bounds,i=e.getSize(),s=this._container;(!this._svgSize||!this._svgSize.equals(i))&&(this._svgSize=i,s.setAttribute("width",i.x),s.setAttribute("height",i.y)),Qe(s,e.min),s.setAttribute("viewBox",[e.min.x,e.min.y,i.x,i.y].join(" ")),this.fire("update")}},_initPath:function(e){var i=e._path=as("path");e.options.className&&pe(i,e.options.className),e.options.interactive&&pe(i,"leaflet-interactive"),this._updateStyle(e),this._layers[d(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){We(e._path),e.removeInteractiveTarget(e._path),delete this._layers[d(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var i=e._path,s=e.options;i&&(s.stroke?(i.setAttribute("stroke",s.color),i.setAttribute("stroke-opacity",s.opacity),i.setAttribute("stroke-width",s.weight),i.setAttribute("stroke-linecap",s.lineCap),i.setAttribute("stroke-linejoin",s.lineJoin),s.dashArray?i.setAttribute("stroke-dasharray",s.dashArray):i.removeAttribute("stroke-dasharray"),s.dashOffset?i.setAttribute("stroke-dashoffset",s.dashOffset):i.removeAttribute("stroke-dashoffset")):i.setAttribute("stroke","none"),s.fill?(i.setAttribute("fill",s.fillColor||s.color),i.setAttribute("fill-opacity",s.fillOpacity),i.setAttribute("fill-rule",s.fillRule||"evenodd")):i.setAttribute("fill","none"))},_updatePoly:function(e,i){this._setPath(e,Ne(e._parts,i))},_updateCircle:function(e){var i=e._point,s=Math.max(Math.round(e._radius),1),o=Math.max(Math.round(e._radiusY),1)||s,l="a"+s+","+o+" 0 1,0 ",m=e._empty()?"M0 0":"M"+(i.x-s)+","+i.y+l+s*2+",0 "+l+-s*2+",0 ";this._setPath(e,m)},_setPath:function(e,i){e._path.setAttribute("d",i)},_bringToFront:function(e){ri(e._path)},_bringToBack:function(e){li(e._path)}});Q.vml&&Ei.include(Wa);function Xn(e){return Q.svg||Q.vml?new Ei(e):null}Te.include({getRenderer:function(e){var i=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return i||(i=this._renderer=this._createRenderer()),this.hasLayer(i)||this.addLayer(i),i},_getPaneRenderer:function(e){if(e==="overlayPane"||e===void 0)return!1;var i=this._paneRenderers[e];return i===void 0&&(i=this._createRenderer({pane:e}),this._paneRenderers[e]=i),i},_createRenderer:function(e){return this.options.preferCanvas&&Yn(e)||Xn(e)}});var Jn=ci.extend({initialize:function(e,i){ci.prototype.initialize.call(this,this._boundsToLatLngs(e),i)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=Ie(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function Ga(e,i){return new Jn(e,i)}Ei.create=as,Ei.pointsToPath=Ne,Zt.geometryToLayer=Ji,Zt.coordsToLatLng=Vs,Zt.coordsToLatLngs=es,Zt.latLngToCoords=Ns,Zt.latLngsToCoords=ts,Zt.getFeature=di,Zt.asFeature=is,Te.mergeOptions({boxZoom:!0});var eo=Et.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){de(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){$e(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){We(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||e.which!==1&&e.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ci(),Cs(),this._startPoint=this._map.mouseEventToContainerPoint(e),de(document,{contextmenu:ii,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=Me("div","leaflet-zoom-box",this._container),pe(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var i=new be(this._point,this._startPoint),s=i.getSize();Qe(this._box,i.min),this._box.style.width=s.x+"px",this._box.style.height=s.y+"px"},_finish:function(){this._moved&&(We(this._box),Ke(this._container,"leaflet-crosshair")),Mi(),Ms(),$e(document,{contextmenu:ii,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if(!(e.which!==1&&e.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var i=new Fe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(i).fire("boxzoomend",{boxZoomBounds:i})}},_onKeyDown:function(e){e.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Te.addInitHook("addHandler","boxZoom",eo),Te.mergeOptions({doubleClickZoom:!0});var to=Et.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var i=this._map,s=i.getZoom(),o=i.options.zoomDelta,l=e.originalEvent.shiftKey?s-o:s+o;i.options.doubleClickZoom==="center"?i.setZoom(l):i.setZoomAround(e.containerPoint,l)}});Te.addInitHook("addHandler","doubleClickZoom",to),Te.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var io=Et.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new Gt(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}pe(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ke(this._map._container,"leaflet-grab"),Ke(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var i=Ie(this._map.options.maxBounds);this._offsetLimit=Ae(this._map.latLngToContainerPoint(i.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(i.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var i=this._lastTime=+new Date,s=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(s),this._times.push(i),this._prunePositions(i)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),i=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=i.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,i){return e-(e-i)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var e=this._draggable._newPos.subtract(this._draggable._startPos),i=this._offsetLimit;e.x<i.min.x&&(e.x=this._viscousLimit(e.x,i.min.x)),e.y<i.min.y&&(e.y=this._viscousLimit(e.y,i.min.y)),e.x>i.max.x&&(e.x=this._viscousLimit(e.x,i.max.x)),e.y>i.max.y&&(e.y=this._viscousLimit(e.y,i.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,i=Math.round(e/2),s=this._initialWorldOffset,o=this._draggable._newPos.x,l=(o-i+s)%e+i-s,m=(o+i+s)%e-i-s,_=Math.abs(l+s)<Math.abs(m+s)?l:m;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=_},_onDragEnd:function(e){var i=this._map,s=i.options,o=!s.inertia||e.noInertia||this._times.length<2;if(i.fire("dragend",e),o)i.fire("moveend");else{this._prunePositions(+new Date);var l=this._lastPos.subtract(this._positions[0]),m=(this._lastTime-this._times[0])/1e3,_=s.easeLinearity,b=l.multiplyBy(_/m),T=b.distanceTo([0,0]),O=Math.min(s.inertiaMaxSpeed,T),U=b.multiplyBy(O/T),ne=O/(s.inertiaDeceleration*_),ge=U.multiplyBy(-ne/2).round();!ge.x&&!ge.y?i.fire("moveend"):(ge=i._limitOffset(ge,i.options.maxBounds),le(function(){i.panBy(ge,{duration:ne,easeLinearity:_,noMoveStart:!0,animate:!0})}))}}});Te.addInitHook("addHandler","dragging",io),Te.mergeOptions({keyboard:!0,keyboardPanDelta:80});var so=Et.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),de(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),$e(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,i=document.documentElement,s=e.scrollTop||i.scrollTop,o=e.scrollLeft||i.scrollLeft;this._map._container.focus(),window.scrollTo(o,s)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var i=this._panKeys={},s=this.keyCodes,o,l;for(o=0,l=s.left.length;o<l;o++)i[s.left[o]]=[-1*e,0];for(o=0,l=s.right.length;o<l;o++)i[s.right[o]]=[e,0];for(o=0,l=s.down.length;o<l;o++)i[s.down[o]]=[0,e];for(o=0,l=s.up.length;o<l;o++)i[s.up[o]]=[0,-1*e]},_setZoomDelta:function(e){var i=this._zoomKeys={},s=this.keyCodes,o,l;for(o=0,l=s.zoomIn.length;o<l;o++)i[s.zoomIn[o]]=e;for(o=0,l=s.zoomOut.length;o<l;o++)i[s.zoomOut[o]]=-e},_addHooks:function(){de(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){$e(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var i=e.keyCode,s=this._map,o;if(i in this._panKeys){if(!s._panAnim||!s._panAnim._inProgress)if(o=this._panKeys[i],e.shiftKey&&(o=Y(o).multiplyBy(3)),s.options.maxBounds&&(o=s._limitOffset(Y(o),s.options.maxBounds)),s.options.worldCopyJump){var l=s.wrapLatLng(s.unproject(s.project(s.getCenter()).add(o)));s.panTo(l)}else s.panBy(o)}else if(i in this._zoomKeys)s.setZoom(s.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[i]);else if(i===27&&s._popup&&s._popup.options.closeOnEscapeKey)s.closePopup();else return;ii(e)}}});Te.addInitHook("addHandler","keyboard",so),Te.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var no=Et.extend({addHooks:function(){de(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){$e(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var i=Sn(e),s=this._map.options.wheelDebounceTime;this._delta+=i,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var o=Math.max(s-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),o),ii(e)},_performZoom:function(){var e=this._map,i=e.getZoom(),s=this._map.options.zoomSnap||0;e._stop();var o=this._delta/(this._map.options.wheelPxPerZoomLevel*4),l=4*Math.log(2/(1+Math.exp(-Math.abs(o))))/Math.LN2,m=s?Math.ceil(l/s)*s:l,_=e._limitZoom(i+(this._delta>0?m:-m))-i;this._delta=0,this._startTime=null,_&&(e.options.scrollWheelZoom==="center"?e.setZoom(i+_):e.setZoomAround(this._lastMousePos,i+_))}});Te.addInitHook("addHandler","scrollWheelZoom",no);var ja=600;Te.mergeOptions({tapHold:Q.touchNative&&Q.safari&&Q.mobile,tapTolerance:15});var oo=Et.extend({addHooks:function(){de(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){$e(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(clearTimeout(this._holdTimeout),e.touches.length===1){var i=e.touches[0];this._startPos=this._newPos=new Z(i.clientX,i.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(de(document,"touchend",nt),de(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",i))},this),ja),de(document,"touchend touchcancel contextmenu",this._cancel,this),de(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function e(){$e(document,"touchend",nt),$e(document,"touchend touchcancel",e)},_cancel:function(){clearTimeout(this._holdTimeout),$e(document,"touchend touchcancel contextmenu",this._cancel,this),$e(document,"touchmove",this._onMove,this)},_onMove:function(e){var i=e.touches[0];this._newPos=new Z(i.clientX,i.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(e,i){var s=new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,screenX:i.screenX,screenY:i.screenY,clientX:i.clientX,clientY:i.clientY});s._simulated=!0,i.target.dispatchEvent(s)}});Te.addInitHook("addHandler","tapHold",oo),Te.mergeOptions({touchZoom:Q.touch,bounceAtZoomLimits:!0});var ao=Et.extend({addHooks:function(){pe(this._map._container,"leaflet-touch-zoom"),de(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ke(this._map._container,"leaflet-touch-zoom"),$e(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var i=this._map;if(!(!e.touches||e.touches.length!==2||i._animatingZoom||this._zooming)){var s=i.mouseEventToContainerPoint(e.touches[0]),o=i.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=i.getSize()._divideBy(2),this._startLatLng=i.containerPointToLatLng(this._centerPoint),i.options.touchZoom!=="center"&&(this._pinchStartLatLng=i.containerPointToLatLng(s.add(o)._divideBy(2))),this._startDist=s.distanceTo(o),this._startZoom=i.getZoom(),this._moved=!1,this._zooming=!0,i._stop(),de(document,"touchmove",this._onTouchMove,this),de(document,"touchend touchcancel",this._onTouchEnd,this),nt(e)}},_onTouchMove:function(e){if(!(!e.touches||e.touches.length!==2||!this._zooming)){var i=this._map,s=i.mouseEventToContainerPoint(e.touches[0]),o=i.mouseEventToContainerPoint(e.touches[1]),l=s.distanceTo(o)/this._startDist;if(this._zoom=i.getScaleZoom(l,this._startZoom),!i.options.bounceAtZoomLimits&&(this._zoom<i.getMinZoom()&&l<1||this._zoom>i.getMaxZoom()&&l>1)&&(this._zoom=i._limitZoom(this._zoom)),i.options.touchZoom==="center"){if(this._center=this._startLatLng,l===1)return}else{var m=s._add(o)._divideBy(2)._subtract(this._centerPoint);if(l===1&&m.x===0&&m.y===0)return;this._center=i.unproject(i.project(this._pinchStartLatLng,this._zoom).subtract(m),this._zoom)}this._moved||(i._moveStart(!0,!1),this._moved=!0),F(this._animRequest);var _=c(i._move,i,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=le(_,this,!0),nt(e)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,F(this._animRequest),$e(document,"touchmove",this._onTouchMove,this),$e(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Te.addInitHook("addHandler","touchZoom",ao),Te.BoxZoom=eo,Te.DoubleClickZoom=to,Te.Drag=io,Te.Keyboard=so,Te.ScrollWheelZoom=no,Te.TapHold=oo,Te.TouchZoom=ao,a.Bounds=be,a.Browser=Q,a.CRS=st,a.Canvas=Qn,a.Circle=Zs,a.CircleMarker=Xi,a.Class=H,a.Control=It,a.DivIcon=Gn,a.DivOverlay=$t,a.DomEvent=da,a.DomUtil=ha,a.Draggable=Gt,a.Evented=Se,a.FeatureGroup=qt,a.GeoJSON=Zt,a.GridLayer=Oi,a.Handler=Et,a.Icon=hi,a.ImageOverlay=ss,a.LatLng=_e,a.LatLngBounds=Fe,a.Layer=Dt,a.LayerGroup=ui,a.LineUtil=La,a.Map=Te,a.Marker=Yi,a.Mixin=ya,a.Path=jt,a.Point=Z,a.PolyUtil=ba,a.Polygon=ci,a.Polyline=Ht,a.Popup=ns,a.PosAnimation=xn,a.Projection=Ca,a.Rectangle=Jn,a.Renderer=Vt,a.SVG=Ei,a.SVGOverlay=Wn,a.TileLayer=fi,a.Tooltip=os,a.Transformation=vt,a.Util=K,a.VideoOverlay=Un,a.bind=c,a.bounds=Ae,a.canvas=Yn,a.circle=za,a.circleMarker=Oa,a.control=Ii,a.divIcon=Va,a.extend=r,a.featureGroup=Ia,a.geoJSON=Nn,a.geoJson=Ba,a.gridLayer=Na,a.icon=Da,a.imageOverlay=Ra,a.latLng=se,a.latLngBounds=Ie,a.layerGroup=xa,a.map=fa,a.marker=Aa,a.point=Y,a.polygon=$a,a.polyline=Ea,a.popup=Ha,a.rectangle=Ga,a.setOptions=I,a.stamp=d,a.svg=Xn,a.svgOverlay=qa,a.tileLayer=jn,a.tooltip=Za,a.transformation=x,a.version=u,a.videoOverlay=Fa;var Ka=window.L;a.noConflict=function(){return window.L=Ka,this},window.L=a})}(Bi,Bi.exports)),Bi.exports}var te=dn();const fu=Dr(te),mu=Rr({__proto__:null,default:fu},[te]);var Js={exports:{}},Po;function pu(){return Po||(Po=1,function(t){(function(n){var a;a=dn(),t.exports=n(a)})(function(n){return n.Polyline._flat=n.LineUtil.isFlat||n.Polyline._flat||function(a){return!n.Util.isArray(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"},n.GeometryUtil=n.extend(n.GeometryUtil||{},{distance:function(a,u,r){return a.latLngToLayerPoint(u).distanceTo(a.latLngToLayerPoint(r))},distanceSegment:function(a,u,r,h){var c=a.latLngToLayerPoint(u),f=a.latLngToLayerPoint(r),d=a.latLngToLayerPoint(h);return n.LineUtil.pointToSegmentDistance(c,f,d)},readableDistance:function(a,u){var r=u!=="imperial",h;return r?a>1e3?h=(a/1e3).toFixed(2)+" km":h=a.toFixed(1)+" m":(a*=1.09361,a>1760?h=(a/1760).toFixed(2)+" miles":h=a.toFixed(1)+" yd"),h},belongsSegment:function(a,u,r,h){h=h===void 0?.2:h;var c=u.distanceTo(r),f=u.distanceTo(a)+a.distanceTo(r)-c;return f/c<h},length:function(a){var u=n.GeometryUtil.accumulatedLengths(a);return u.length>0?u[u.length-1]:0},accumulatedLengths:function(a){if(typeof a.getLatLngs=="function"&&(a=a.getLatLngs()),a.length===0)return[];for(var u=0,r=[0],h=0,c=a.length-1;h<c;h++)u+=a[h].distanceTo(a[h+1]),r.push(u);return r},closestOnSegment:function(a,u,r,h){var c=a.getMaxZoom();c===1/0&&(c=a.getZoom());var f=a.project(u,c),d=a.project(r,c),p=a.project(h,c),g=n.LineUtil.closestPointOnSegment(f,d,p);return a.unproject(g,c)},closestOnCircle:function(a,u){const r=a.getLatLng(),h=a.getRadius(),c=typeof h=="number"?h:h.radius,f=u.lng,d=u.lat,p=r.lng,g=r.lat,y=f-p,v=d-g,k=Math.sqrt(y*y+v*v),C=p+y/k*c,I=g+v/k*c;return new n.LatLng(I,C)},closest:function(a,u,r,h){var c,f=1/0,d=null,p,g,y,v;if(u instanceof Array)if(u[0]instanceof Array&&typeof u[0][0]!="number"){for(p=0;p<u.length;p++)v=n.GeometryUtil.closest(a,u[p],r,h),v&&v.distance<f&&(f=v.distance,d=v);return d}else if(u[0]instanceof n.LatLng||typeof u[0][0]=="number"||typeof u[0].lat=="number")u=n.polyline(u);else return d;if(!(u instanceof n.Polyline))return d;if(c=JSON.parse(JSON.stringify(u.getLatLngs().slice(0))),u instanceof n.Polygon){var k=function(A){if(n.Polyline._flat(A))A.push(A[0]);else for(var q=0;q<A.length;q++)k(A[q])};k(c)}if(n.Polyline._flat(c)){if(h){for(p=0,g=c.length;p<g;p++){var C=c[p];y=n.GeometryUtil.distance(a,r,C),y<f&&(f=y,d=C,d.distance=y)}return d}for(p=0,g=c.length;p<g-1;p++){var I=c[p],D=c[p+1];y=n.GeometryUtil.distanceSegment(a,r,I,D),y<=f&&(f=y,d=n.GeometryUtil.closestOnSegment(a,r,I,D),d.distance=y)}return d}else{for(p=0;p<c.length;p++)v=n.GeometryUtil.closest(a,c[p],r,h),v.distance<f&&(f=v.distance,d=v);return d}},closestLayer:function(a,u,r){for(var h=1/0,c=null,f=null,d=1/0,p=0,g=u.length;p<g;p++){var y=u[p];if(y instanceof n.LayerGroup){var v=n.GeometryUtil.closestLayer(a,y.getLayers(),r);v.distance<h&&(h=v.distance,c=v)}else y instanceof n.Circle?(f=this.closestOnCircle(y,r),d=n.GeometryUtil.distance(a,r,f)):typeof y.getLatLng=="function"?(f=y.getLatLng(),d=n.GeometryUtil.distance(a,r,f)):(f=n.GeometryUtil.closest(a,y,r),f&&(d=f.distance)),d<h&&(h=d,c={layer:y,latlng:f,distance:d})}return c},nClosestLayers:function(a,u,r,h){if(h=typeof h=="number"?h:u.length,h<1||u.length<1)return null;for(var c=[],f,d,p=0,g=u.length;p<g;p++){var y=u[p];if(y instanceof n.LayerGroup){var v=n.GeometryUtil.closestLayer(a,y.getLayers(),r);c.push(v)}else y instanceof n.Circle?(d=this.closestOnCircle(y,r),f=n.GeometryUtil.distance(a,r,d)):typeof y.getLatLng=="function"?(d=y.getLatLng(),f=n.GeometryUtil.distance(a,r,d)):(d=n.GeometryUtil.closest(a,y,r),d&&(f=d.distance)),c.push({layer:y,latlng:d,distance:f})}return c.sort(function(k,C){return k.distance-C.distance}),c.length>h?c.slice(0,h):c},layersWithin:function(a,u,r,h){h=typeof h=="number"?h:1/0;for(var c=[],f=null,d=0,p=0,g=u.length;p<g;p++){var y=u[p];typeof y.getLatLng=="function"?(f=y.getLatLng(),d=n.GeometryUtil.distance(a,r,f)):(f=n.GeometryUtil.closest(a,y,r),f&&(d=f.distance)),f&&d<h&&c.push({layer:y,latlng:f,distance:d})}var v=c.sort(function(k,C){return k.distance-C.distance});return v},closestLayerSnap:function(a,u,r,h,c){h=typeof h=="number"?h:1/0,c=typeof c=="boolean"?c:!0;var f=n.GeometryUtil.closestLayer(a,u,r);if(!f||f.distance>h)return null;if(c&&typeof f.layer.getLatLngs=="function"){var d=n.GeometryUtil.closest(a,f.layer,f.latlng,!0);d.distance<h&&(f.latlng=d,f.distance=n.GeometryUtil.distance(a,d,r))}return f},interpolateOnPointSegment:function(a,u,r){return n.point(a.x*(1-r)+r*u.x,a.y*(1-r)+r*u.y)},interpolateOnLine:function(a,u,r){u=u instanceof n.Polyline?u.getLatLngs():u;var h=u.length;if(h<2)return null;if(r=Math.max(Math.min(r,1),0),r===0)return{latLng:u[0]instanceof n.LatLng?u[0]:n.latLng(u[0]),predecessor:-1};if(r==1)return{latLng:u[u.length-1]instanceof n.LatLng?u[u.length-1]:n.latLng(u[u.length-1]),predecessor:u.length-2};var c=a.getMaxZoom();c===1/0&&(c=a.getZoom());for(var f=[],d=0,p=0;p<h;p++)f[p]=a.project(u[p],c),p>0&&(d+=f[p-1].distanceTo(f[p]));for(var g=d*r,y=0,v=0,p=0;v<g;p++){var k=f[p],C=f[p+1];y=v,v+=k.distanceTo(C)}if(k==null&&C==null)var k=f[0],C=f[1],p=1;var I=v-y!==0?(g-y)/(v-y):0,D=n.GeometryUtil.interpolateOnPointSegment(k,C,I);return{latLng:a.unproject(D,c),predecessor:p-1}},locateOnLine:function(a,u,r){var h=u.getLatLngs();if(r.equals(h[0]))return 0;if(r.equals(h[h.length-1]))return 1;for(var c=n.GeometryUtil.closest(a,u,r,!1),f=n.GeometryUtil.accumulatedLengths(h),d=f[f.length-1],p=0,g=!1,y=0,v=h.length-1;y<v;y++){var k=h[y],C=h[y+1];if(p=f[y],n.GeometryUtil.belongsSegment(c,k,C,.001)){p+=k.distanceTo(c),g=!0;break}}if(!g)throw"Could not interpolate "+r.toString()+" within "+u.toString();return p/d},reverse:function(a){return n.polyline(a.getLatLngs().slice(0).reverse())},extract:function(a,u,r,h){if(r>h)return n.GeometryUtil.extract(a,n.GeometryUtil.reverse(u),1-r,1-h);r=Math.max(Math.min(r,1),0),h=Math.max(Math.min(h,1),0);var c=u.getLatLngs(),f=n.GeometryUtil.interpolateOnLine(a,u,r),d=n.GeometryUtil.interpolateOnLine(a,u,h);if(r==h){var p=n.GeometryUtil.interpolateOnLine(a,u,h);return[p.latLng]}f.predecessor==-1&&(f.predecessor=0),d.predecessor==-1&&(d.predecessor=0);var g=c.slice(f.predecessor+1,d.predecessor+1);return g.unshift(f.latLng),g.push(d.latLng),g},isBefore:function(a,u){if(!u)return!1;var r=a.getLatLngs(),h=u.getLatLngs();return r[r.length-1].equals(h[0])},isAfter:function(a,u){if(!u)return!1;var r=a.getLatLngs(),h=u.getLatLngs();return r[0].equals(h[h.length-1])},startsAtExtremity:function(a,u){if(!u)return!1;var r=a.getLatLngs(),h=u.getLatLngs(),c=r[0];return c.equals(h[0])||c.equals(h[h.length-1])},computeAngle:function(a,u){return Math.atan2(u.y-a.y,u.x-a.x)*180/Math.PI},computeSlope:function(a,u){var r=(u.y-a.y)/(u.x-a.x),h=a.y-r*a.x;return{a:r,b:h}},rotatePoint:function(a,u,r,h){var c=a.getMaxZoom();c===1/0&&(c=a.getZoom());var f=r*Math.PI/180,d=a.project(u,c),p=a.project(h,c),g=Math.cos(f)*(d.x-p.x)-Math.sin(f)*(d.y-p.y)+p.x,y=Math.sin(f)*(d.x-p.x)+Math.cos(f)*(d.y-p.y)+p.y;return a.unproject(new n.Point(g,y),c)},bearing:function(a,u){var r=Math.PI/180,h=a.lat*r,c=u.lat*r,f=a.lng*r,d=u.lng*r,p=Math.sin(d-f)*Math.cos(c),g=Math.cos(h)*Math.sin(c)-Math.sin(h)*Math.cos(c)*Math.cos(d-f),y=(Math.atan2(p,g)*180/Math.PI+360)%360;return y>=180?y-360:y},destination:function(a,u,r){u=(u+360)%360;var h=Math.PI/180,c=180/Math.PI,f=n.CRS.Earth.R,d=a.lng*h,p=a.lat*h,g=u*h,y=Math.sin(p),v=Math.cos(p),k=Math.cos(r/f),C=Math.sin(r/f),I=Math.asin(y*k+v*C*Math.cos(g)),D=d+Math.atan2(Math.sin(g)*C*v,k-y*Math.sin(I));return D=D*c,D=D>180?D-360:D<-180?D+360:D,n.latLng([I*c,D])},angle:function(a,u,r){var h=a.latLngToContainerPoint(u),c=a.latLngToContainerPoint(r),f=Math.atan2(c.y-h.y,c.x-h.x)*180/Math.PI+90;return f+=f<0?360:0,f},destinationOnSegment:function(a,u,r,h){var c=n.GeometryUtil.angle(a,u,r),f=n.GeometryUtil.destination(u,c,h);return n.GeometryUtil.closestOnSegment(a,f,u,r)}}),n.GeometryUtil})}(Js)),Js.exports}pu();L.Marker.include({_slideToUntil:void 0,_slideToDuration:void 0,_slideToLatLng:void 0,_slideFromLatLng:void 0,_slideKeepAtCenter:void 0,_slideDraggingWasAllowed:void 0,slideTo:function(n,a){if(this._map)return this._slideToDuration=a.duration,this._slideToUntil=performance.now()+a.duration,this._slideFromLatLng=this.getLatLng(),this._slideToLatLng=n,this._slideKeepAtCenter=!!a.keepAtCenter,this._slideDraggingWasAllowed=this._slideDraggingWasAllowed!==void 0?this._slideDraggingWasAllowed:this._map.dragging.enabled(),this._slideKeepAtCenter&&(this._map.dragging.disable(),this._map.doubleClickZoom.disable(),this._map.options.touchZoom="center",this._map.options.scrollWheelZoom="center"),this.fire("movestart"),this._slideTo(),this},slideCancel:function(){L.Util.cancelAnimFrame(this._slideFrame)},_slideTo:function(){if(this._map){var n=this._slideToUntil-performance.now();if(n<0)return this.setLatLng(this._slideToLatLng),this.fire("moveend"),this._slideDraggingWasAllowed&&(this._map.dragging.enable(),this._map.doubleClickZoom.enable(),this._map.options.touchZoom=!0,this._map.options.scrollWheelZoom=!0),this._slideDraggingWasAllowed=void 0,this;var a=this._map.latLngToContainerPoint(this._slideFromLatLng),u=this._map.latLngToContainerPoint(this._slideToLatLng),r=(this._slideToDuration-n)/this._slideToDuration,h=u.multiplyBy(r).add(a.multiplyBy(1-r)),c=this._map.containerPointToLatLng(h);this.setLatLng(c),this._slideKeepAtCenter&&this._map.panTo(c,{animate:!1}),this._slideFrame=L.Util.requestAnimFrame(this._slideTo,this)}}});L.Marker.addInitHook(function(){this.on("move",this.slideCancel,this)});L.CircleMarker.include({slideTo:L.Marker.prototype.slideTo,slideCancel:L.Marker.prototype.slideCancel,_slideTo:L.Marker.prototype._slideTo});L.CircleMarker.addInitHook(function(){this.on("move",this.slideCancel,this)});var en={exports:{}},To;function vu(){return To||(To=1,function(t){(function(n){t.exports=n(dn())})(function(n){var a="polyline-measure-control",u="polyline-measure-unicode-icon",r=navigator.platform==="MacIntel";return n.Control.PolylineMeasure=n.Control.extend({options:{position:"topleft",unit:"kilometres",useSubunits:!0,clearMeasurementsOnStop:!0,showBearings:!1,bearingTextIn:"In",bearingTextOut:"Out",tooltipTextFinish:"Click to <b>finish line</b><br>",tooltipTextDelete:"Press SHIFT-key and click to <b>delete point</b>",tooltipTextMove:"Click and drag to <b>move point</b><br>",tooltipTextResume:"<br>Press "+(r?"⌘":"CTRL-key")+" and click to <b>resume line</b>",tooltipTextAdd:"Press "+(r?"⌘":"CTRL-key")+" and click to <b>add point</b>",measureControlTitleOn:"Turn on PolylineMeasure",measureControlTitleOff:"Turn off PolylineMeasure",measureControlLabel:"&#8614;",measureControlClasses:[],showClearControl:!1,clearControlTitle:"Clear Measurements",clearControlLabel:"&times;",clearControlClasses:[],showUnitControl:!1,unitControlUnits:["kilometres","landmiles","nauticalmiles"],unitControlTitle:{text:"Change Units",kilometres:"kilometres",landmiles:"land miles",nauticalmiles:"nautical miles"},unitControlLabel:{metres:"m",kilometres:"km",feet:"ft",landmiles:"mi",nauticalmiles:"nm"},unitControlClasses:[],tempLine:{color:"#00f",weight:2},fixedLine:{color:"#006",weight:2},arrow:{color:"#000"},startCircle:{color:"#000",weight:1,fillColor:"#0f0",fillOpacity:1,radius:3},intermedCircle:{color:"#000",weight:1,fillColor:"#ff0",fillOpacity:1,radius:3},currentCircle:{color:"#000",weight:1,fillColor:"#f0f",fillOpacity:1,radius:6},endCircle:{color:"#000",weight:1,fillColor:"#f00",fillOpacity:1,radius:3}},_arcpoints:99,_circleNr:-1,_lineNr:-1,_createControl:function(h,c,f,d,p,g){var y=document.createElement("a");return y.innerHTML=h,y.setAttribute("title",c),f.forEach(function(v){y.classList.add(v)}),n.DomEvent.on(y,"click",p,g),d.appendChild(y),y},onAdd:function(h){var c=this;h.on("movestart ",function(){c._mapdragging=!0}),this._container=document.createElement("div"),this._container.classList.add("leaflet-bar"),n.DomEvent.disableClickPropagation(this._container);var f=this.options.measureControlTitleOn,d=this.options.measureControlLabel,p=this.options.measureControlClasses;if(d.indexOf("&")!=-1&&p.push(u),this._arrPolylines=[],this._measureControl=this._createControl(d,f,p,this._container,this._toggleMeasure,this),this._defaultControlBgColor=this._measureControl.style.backgroundColor,this._measureControl.setAttribute("id",a),this.options.showClearControl){var f=this.options.clearControlTitle,d=this.options.clearControlLabel,p=this.options.clearControlClasses;d.indexOf("&")!=-1&&p.push(u),this._clearMeasureControl=this._createControl(d,f,p,this._container,this._clearAllMeasurements,this),this._clearMeasureControl.classList.add("polyline-measure-clearControl")}if(this.options.showUnitControl&&this.options.unitControlUnits.length>1){var d=this.options.unitControlLabel[this.options.unit],f=this.options.unitControlTitle.text+" ["+this.options.unitControlTitle[this.options.unit]+"]",p=this.options.unitControlClasses;this._unitControl=this._createControl(d,f,p,this._container,this._changeUnit,this),this._unitControl.setAttribute("id","unitControlId")}return this._container},onRemove:function(){this._measuring&&this._toggleMeasure()},_saveNonpolylineEvents:function(){this._nonpolylineTargets=this._map._targets,typeof this._polylineTargets<"u"?this._map._targets=this._polylineTargets:this._map._targets={}},_savePolylineEvents:function(){this._polylineTargets=this._map._targets,this._map._targets=this._nonpolylineTargets},_toggleMeasure:function(){this._measuring=!this._measuring,this._measuring?(this._mapdragging=!1,this._saveNonpolylineEvents(),this._measureControl.classList.add("polyline-measure-controlOnBgColor"),this._measureControl.style.backgroundColor=this.options.backgroundColor,this._measureControl.title=this.options.measureControlTitleOff,this._oldCursor=this._map._container.style.cursor,this._map._container.style.cursor="crosshair",this._doubleClickZoom=this._map.doubleClickZoom.enabled(),this._map.doubleClickZoom.disable(),this._layerPaint||(this._layerPaint=n.layerGroup().addTo(this._map)),this._map.on("mousemove",this._mouseMove,this),this._map.on("click",this._mouseClick,this),n.DomEvent.on(document,"keydown",this._onKeyDown,this),this._resetPathVariables()):(this._savePolylineEvents(),this._measureControl.classList.remove("polyline-measure-controlOnBgColor"),this._measureControl.style.backgroundColor=this._defaultControlBgColor,this._measureControl.title=this.options.measureControlTitleOn,this._map._container.style.cursor=this._oldCursor,this._map.off("mousemove",this._mouseMove,this),this._map.off("click",this._mouseClick,this),this._map.off("mousemove",this._resumeFirstpointMousemove,this),this._map.off("click",this._resumeFirstpointClick,this),this._map.off("mousemove",this._dragCircleMousemove,this),this._map.off("mouseup",this._dragCircleMouseup,this),n.DomEvent.off(document,"keydown",this._onKeyDown,this),this._doubleClickZoom&&this._map.doubleClickZoom.enable(),this.options.clearMeasurementsOnStop&&this._layerPaint&&this._clearAllMeasurements(),this._cntCircle!==0&&this._finishPolylinePath()),this._map.fire("polylinemeasure:toggle",{status:this._measuring})},_clearAllMeasurements:function(){this._cntCircle!==void 0&&this._cntCircle!==0&&this._finishPolylinePath(),this._layerPaint&&this._layerPaint.clearLayers(),this._arrPolylines=[],this._map.fire("polylinemeasure:clear")},_changeUnit:function(){let c=(this.options.unitControlUnits.indexOf(this.options.unit)+1)%this.options.unitControlUnits.length;this.options.unit=this.options.unitControlUnits[c],this._unitControl.innerHTML=this.options.unitControlLabel[this.options.unit],this._unitControl.title=this.options.unitControlTitle.text+" ["+this.options.unitControlTitle[this.options.unit]+"]",this._currentLine&&this._computeDistance(this._currentLine),this._arrPolylines.map(this._computeDistance.bind(this))},_computeDistance:function(h){var c=0;h.circleCoords.map((function(f,d){if(d>=1){var p=h.circleCoords[d-1].distanceTo(h.circleCoords[d]);c+=p,this._updateTooltip(h.tooltips[d],h.tooltips[d-1],c,p,h.circleCoords[d-1],h.circleCoords[d])}}).bind(this))},_onKeyDown:function(h){if(h.keyCode===27){if(this._resumeFirstpointFlag===!0){this._resumeFirstpointFlag=!1;var c=this._lineNr;this._map.off("mousemove",this._resumeFirstpointMousemove,this),this._map.off("click",this._resumeFirstpointClick,this),this._layerPaint.removeLayer(this._rubberlinePath2),this._layerPaint.removeLayer(this._tooltipNew),this._arrPolylines[c].circleMarkers[0].setStyle(this.options.startCircle);var f="",d=0;this.options.showBearings===!0&&(f=this.options.bearingTextIn+":---°<br>"+this.options.bearingTextOut+":---°"),f=f+'<div class="polyline-measure-tooltip-difference">+0</div>',f=f+'<div class="polyline-measure-tooltip-total">0</div>',this._arrPolylines[c].tooltips[0]._icon.innerHTML=f,this._arrPolylines[c].tooltips.map((function(p,g){if(g>=1){var y=this._arrPolylines[c].circleCoords[g-1].distanceTo(this._arrPolylines[c].circleCoords[g]),v=this._arrPolylines[c].circleCoords[g-1],k=this._arrPolylines[c].circleCoords[g];d+=y;var C=this._arrPolylines[c].tooltips[g-1];this._updateTooltip(p,C,d,y,v,k)}}).bind(this)),this._map.on("mousemove",this._mouseMove,this);return}this._currentLine?this._finishPolylinePath(h):this._toggleMeasure()}},_getDistance:function(h){var c=h,f;return this.options.unit==="nauticalmiles"?(f=this.options.unitControlLabel.nauticalmiles,c>=185200?c=(c/1852).toFixed(0):c>=18520?c=(c/1852).toFixed(1):c>=1852?c=(c/1852).toFixed(2):c=(c/1852).toFixed(3)):this.options.unit==="landmiles"?(f=this.options.unitControlLabel.landmiles,c>=160934.4?c=(c/1609.344).toFixed(0):c>=16093.44?c=(c/1609.344).toFixed(1):c>=1609.344?c=(c/1609.344).toFixed(2):this.options.useSubunits?(c=(c/.3048).toFixed(0),f=this.options.unitControlLabel.feet):c=(c/1609.344).toFixed(4)):(f=this.options.unitControlLabel.kilometres,c>=1e5?c=(c/1e3).toFixed(0):c>=1e4?c=(c/1e3).toFixed(1):c>=1e3?c=(c/1e3).toFixed(2):this.options.useSubunits?(c=c.toFixed(1),f=this.options.unitControlLabel.metres):c=(c/1e3).toFixed(4)),{value:c,unit:f}},_polylineArc:function(h,c){function f(I){var D=Math.sin((1-I)*k)/Math.sin(k),A=Math.sin(I*k)/Math.sin(k),q=D*Math.cos(p)*Math.cos(g)+A*Math.cos(y)*Math.cos(v),z=D*Math.cos(p)*Math.sin(g)+A*Math.cos(y)*Math.sin(v),B=D*Math.sin(p)+A*Math.sin(y),G=180/Math.PI*Math.atan2(B,Math.sqrt(Math.pow(q,2)+Math.pow(z,2))),ee=180/Math.PI*Math.atan2(z,q),re=ee-g*180/Math.PI;function fe(Le){return Math[Le>0?"floor":"ceil"](Le)}return re<0?ee=ee-fe((re-180)/360)*360:ee=ee-fe((re+180)/360)*360,[G,ee]}function d(I){for(var D=[],A=1/(I-1),q=0;q<I;q++){var z=A*q,B=f(z);D.push(B)}return D}var p=h.lat,g=h.lng,y=c.lat,v=c.lng;p=p*Math.PI/180,g=g*Math.PI/180,y=y*Math.PI/180,v=v*Math.PI/180;var k=2*Math.asin(Math.sqrt(Math.pow(Math.sin((p-y)/2),2)+Math.cos(p)*Math.cos(y)*Math.pow(Math.sin((g-v)/2),2))),C;return k===0?C=[[p,g]]:C=d(this._arcpoints),C},_updateTooltip:function(h,c,f,d,p,g){var y=function(B,G,ee){var re=B.lat/180*Math.PI,fe=G.lat/180*Math.PI,Le=B.lng/180*Math.PI,xe=G.lng/180*Math.PI,le=Math.sin(xe-Le)*Math.cos(fe),F=Math.cos(re)*Math.sin(fe)-Math.sin(re)*Math.cos(fe)*Math.cos(xe-Le);if(ee==="inbound")var K=(Math.atan2(le,F)*180/Math.PI+180).toFixed(0);else var K=(Math.atan2(le,F)*180/Math.PI+360).toFixed(0);return K%360},v=y(g,p,"inbound"),k=y(p,g,"outbound"),C=this._getDistance(f),I=this._getDistance(d),D="";if(I.value>0&&(this.options.showBearings===!0&&(D=this.options.bearingTextIn+": "+v+"°<br>"+this.options.bearingTextOut+":---°"),D+='<div class="polyline-measure-tooltip-difference">+'+I.value+"&nbsp;"+I.unit+"</div>"),D+='<div class="polyline-measure-tooltip-total">'+C.value+"&nbsp;"+C.unit+"</div>",h._icon.innerHTML=D,this.options.showBearings===!0&&c){var A=c._icon.innerHTML,q=new RegExp(this.options.bearingTextOut+".*°"),z=A.replace(q,this.options.bearingTextOut+": "+k+"°");c._icon.innerHTML=z}},_drawArrow:function(h){var c=Math.trunc(h.length/2);if(h.length%2==0)var f=h[c-1],d=h[c],p=d[1]-f[1],g=d[0]-f[0],y=[f[0]+g/2,f[1]+p/2];else var f=h[c-1],d=h[c+1],p=d[1]-f[1],g=d[0]-f[0],y=h[c];var v=-Math.atan2(g,p)*57.29578,k=n.divIcon({className:"",iconSize:[16,16],iconAnchor:[8,8],html:"<div style = 'color:"+this.options.arrow.color+"; font-size: 16px; line-height: 16px; vertical-align:top; transform: rotate("+v+"deg)'>&#x27a4;</div>"}),C=n.marker(y,{icon:k,zIndexOffset:-50}).addTo(this._layerPaint);return this._currentLine||C.bindTooltip(this.options.tooltipTextAdd,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),C.on("click",this._clickedArrow,this),C},_mouseMove:function(h){var c=h.latlng;if(this._map.on("click",this._mouseClick,this),!(!c||!this._currentLine)){var f=this._currentLine.circleCoords.last();this._rubberlinePath.setLatLngs(this._polylineArc(f,c));var d=this._currentLine.tooltips.last(),p=this._currentLine.tooltips.slice(-2,-1)[0];d.setLatLng(c);var g=c.distanceTo(f);this._updateTooltip(d,p,this._currentLine.distance+g,g,f,c)}},_startLine:function(h){var c=n.divIcon({className:"polyline-measure-tooltip",iconAnchor:[-4,-4]}),f=function(){return this.slice(-1)[0]};this._rubberlinePath=n.polyline([],{color:this.options.tempLine.color,weight:this.options.tempLine.weight,interactive:!1,dashArray:"8,8"}).addTo(this._layerPaint).bringToBack();var d=this;this._currentLine={id:0,circleCoords:[],circleMarkers:[],arrowMarkers:[],tooltips:[],distance:0,polylinePath:n.polyline([],{color:this.options.fixedLine.color,weight:this.options.fixedLine.weight,interactive:!1}).addTo(this._layerPaint).bringToBack(),handleMarkers:function(y){var v=this.circleMarkers.last();v&&(v.bindTooltip(d.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),v.off("click",d._finishPolylinePath,d),this.circleMarkers.length===1?v.setStyle(d.options.startCircle):v.setStyle(d.options.intermedCircle));var k=new n.CircleMarker(y,d.options.currentCircle).addTo(d._layerPaint);k.bindTooltip(d.options.tooltipTextFinish+d.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),k.cntLine=d._currentLine.id,k.cntCircle=d._cntCircle,d._cntCircle++,k.on("mousedown",d._dragCircle,d),k.on("click",d._finishPolylinePath,d),this.circleMarkers.push(k)},getNewToolTip:function(y){return n.marker(y,{icon:c,interactive:!1})},addPoint:function(y){var v=this.circleCoords.last();if(!(v&&v.equals(y))){if(this.circleCoords.push(y),this.circleCoords.length>1){var k=d._polylineArc(v,y),C=d._drawArrow(k);this.circleCoords.length>2&&k.shift(),this.polylinePath.setLatLngs(this.polylinePath.getLatLngs().concat(k)),C.cntLine=d._currentLine.id,C.cntArrow=d._cntCircle-1,d._currentLine.arrowMarkers.push(C);var I=v.distanceTo(y);this.distance+=I;var D=d._currentLine.tooltips.last(),A=d._currentLine.tooltips.slice(-1,-2)[0];d._updateTooltip(D,A,this.distance,I,v,y)}D&&D.setLatLng(y);var q=this.getNewToolTip(y);q.addTo(d._layerPaint),this.tooltips.push(q),this.handleMarkers(y)}},finalize:function(){if(d._layerPaint.removeLayer(this.tooltips.last()),this.tooltips.pop(),d._layerPaint.removeLayer(d._rubberlinePath),this.circleCoords.length>1){this.tooltips.last()._icon.classList.add("polyline-measure-tooltip-end");var y=this.circleMarkers.last();y.setStyle(d.options.endCircle),y.unbindTooltip(),d._currentLine.circleMarkers.map(function(v){v.bindTooltip(d.options.tooltipTextMove+d.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"})}),d._currentLine.circleMarkers[0].bindTooltip(d.options.tooltipTextMove+d.options.tooltipTextDelete+d.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),y.bindTooltip(d.options.tooltipTextMove+d.options.tooltipTextDelete+d.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),d._currentLine.arrowMarkers.map(function(v){v.bindTooltip(d.options.tooltipTextAdd,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"})}),y.off("click",d._finishPolylinePath,d),y.on("click",d._resumePolylinePath,d),d._arrPolylines[this.id]=this}else d._layerPaint.removeLayer(this.circleMarkers.last()),d._layerPaint.removeLayer(this.tooltips.last());d._resetPathVariables()}};var p=n.marker(h,{icon:c,interactive:!1});p.addTo(this._layerPaint);var g="";this.options.showBearings===!0&&(g=this.options.bearingTextIn+":---°<br>"+this.options.bearingTextOut+":---°"),g=g+'<div class="polyline-measure-tooltip-difference">+0</div>',g=g+'<div class="polyline-measure-tooltip-total">0</div>',p._icon.innerHTML=g,this._currentLine.tooltips.push(p),this._currentLine.circleCoords.last=f,this._currentLine.tooltips.last=f,this._currentLine.circleMarkers.last=f,this._currentLine.id=this._arrPolylines.length},_mouseClick:function(h){!h.latlng||this._finishCircleScreencoords&&this._finishCircleScreencoords.equals(h.containerPoint)||(!this._currentLine&&!this._mapdragging&&(this._startLine(h.latlng),this._map.fire("polylinemeasure:start",this._currentLine)),this._mapdragging?this._mapdragging=!1:(this._currentLine.addPoint(h.latlng),this._map.fire("polylinemeasure:add",h),this._map.fire("polylinemeasure:change",this._currentLine)))},_finishPolylinePath:function(h){this._map.fire("polylinemeasure:finish",this._currentLine),this._currentLine.finalize(),h&&(this._finishCircleScreencoords=h.containerPoint)},_resumePolylinePath:function(h){if(h.originalEvent.ctrlKey===!0||h.originalEvent.metaKey===!0){this._currentLine=this._arrPolylines[h.target.cntLine],this._rubberlinePath=n.polyline([],{color:this.options.tempLine.color,weight:this.options.tempLine.weight,interactive:!1,dashArray:"8,8"}).addTo(this._layerPaint).bringToBack(),this._currentLine.tooltips.last()._icon.classList.remove("polyline-measure-tooltip-end");var c=this._currentLine.getNewToolTip(h.latlng);c.addTo(this._layerPaint),this._currentLine.tooltips.push(c),this._currentLine.circleMarkers.last().unbindTooltip(),this._currentLine.circleMarkers.last().bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._currentLine.circleMarkers.last().setStyle(this.options.currentCircle),this._cntCircle=this._currentLine.circleCoords.length,this._map.fire("polylinemeasure:resume",this._currentLine)}},_resetPathVariables:function(){this._cntCircle=0,this._currentLine=null},_clickedArrow:function(h){if(h.originalEvent.ctrlKey||h.originalEvent.metaKey){var c=h.target.cntLine,f=h.target.cntArrow;this._arrPolylines[c].arrowMarkers[f].removeFrom(this._layerPaint);var d=new n.CircleMarker(h.latlng,this.options.intermedCircle).addTo(this._layerPaint);d.cntLine=c,d.on("mousedown",this._dragCircle,this),d.bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._arrPolylines[c].circleMarkers.splice(f+1,0,d),this._arrPolylines[c].circleMarkers.map(function(C,I){C.cntCircle=I}),this._arrPolylines[c].circleCoords.splice(f+1,0,h.latlng);var p=this._arrPolylines[c].polylinePath.getLatLngs(),g=this._polylineArc(this._arrPolylines[c].circleCoords[f],h.latlng);g.pop();var y=this._polylineArc(h.latlng,this._arrPolylines[c].circleCoords[f+2]);Array.prototype.splice.apply(p,[f*(this._arcpoints-1),this._arcpoints].concat(g,y)),this._arrPolylines[c].polylinePath.setLatLngs(p);var v=this._drawArrow(g);this._arrPolylines[c].arrowMarkers[f]=v,v=this._drawArrow(y),this._arrPolylines[c].arrowMarkers.splice(f+1,0,v),this._arrPolylines[c].arrowMarkers.map(function(C,I){C.cntLine=c,C.cntArrow=I}),this._tooltipNew=n.marker(h.latlng,{icon:n.divIcon({className:"polyline-measure-tooltip",iconAnchor:[-4,-4]}),interactive:!1}),this._tooltipNew.addTo(this._layerPaint),this._arrPolylines[c].tooltips.splice(f+1,0,this._tooltipNew);var k=0;this._arrPolylines[c].tooltips.map((function(C,I){if(I>=1){var D=this._arrPolylines[c].circleCoords[I-1].distanceTo(this._arrPolylines[c].circleCoords[I]),A=this._arrPolylines[c].circleCoords[I-1],q=this._arrPolylines[c].circleCoords[I];k+=D;var z=this._arrPolylines[c].tooltips[I-1];this._updateTooltip(C,z,k,D,A,q)}}).bind(this)),this._map.fire("polylinemeasure:insert",h),this._map.fire("polylinemeasure:change",this._arrPolylines[this._lineNr])}},_dragCircleMouseup:function(){this._circleNr===0||this._circleNr===this._arrPolylines[this._lineNr].circleCoords.length-1?this._e1.target.bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}):this._e1.target.bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._resetPathVariables(),this._map.off("mousemove",this._dragCircleMousemove,this),this._map.dragging.enable(),this._map.on("mousemove",this._mouseMove,this),this._map.off("mouseup",this._dragCircleMouseup,this),this._map.fire("polylinemeasure:move",this._e1),this._map.fire("polylinemeasure:change",this._arrPolylines[this._lineNr])},_dragCircleMousemove:function(h){var c=h.latlng.lat,f=h.latlng.lng,d=c-this._mouseStartingLat,p=f-this._mouseStartingLng,g=n.latLng(this._circleStartingLat+d,this._circleStartingLng+p),y=this._arcpoints,v=this._e1.target.cntLine;this._lineNr=v;var k=this._e1.target.cntCircle;this._circleNr=k,this._e1.target.setLatLng(g),this._e1.target.unbindTooltip(),this._arrPolylines[v].circleCoords[k]=g;var C=this._arrPolylines[v].polylinePath.getLatLngs();if(k>=1){var I=this._polylineArc(this._arrPolylines[v].circleCoords[k-1],g);Array.prototype.splice.apply(C,[(k-1)*(y-1),y].concat(I));var D=this._drawArrow(I);D.cntLine=v,D.cntArrow=k-1,this._arrPolylines[v].arrowMarkers[k-1].removeFrom(this._layerPaint),this._arrPolylines[v].arrowMarkers[k-1]=D}if(k<this._arrPolylines[v].circleCoords.length-1){var A=this._polylineArc(g,this._arrPolylines[v].circleCoords[k+1]);Array.prototype.splice.apply(C,[k*(y-1),y].concat(A)),D=this._drawArrow(A),D.cntLine=v,D.cntArrow=k,this._arrPolylines[v].arrowMarkers[k].removeFrom(this._layerPaint),this._arrPolylines[v].arrowMarkers[k]=D}this._arrPolylines[v].polylinePath.setLatLngs(C),k>=0&&this._arrPolylines[v].tooltips[k].setLatLng(g);var q=0;this._arrPolylines[v].tooltips.map((function(z,B){if(B>=1){var G=this._arrPolylines[v].circleCoords[B-1].distanceTo(this._arrPolylines[v].circleCoords[B]),ee=this._arrPolylines[v].circleCoords[B-1],re=this._arrPolylines[v].circleCoords[B];q+=G,this._arrPolylines[v].distance=q;var fe=this._arrPolylines[v].tooltips[B-1];this._updateTooltip(z,fe,q,G,ee,re)}}).bind(this)),this._map.on("mouseup",this._dragCircleMouseup,this)},_resumeFirstpointMousemove:function(h){var c=this._lineNr;this._map.on("click",this._resumeFirstpointClick,this);var f=h.latlng;this._rubberlinePath2.setLatLngs(this._polylineArc(f,currentCircleCoords)),this._tooltipNew.setLatLng(f);var d=0,p=f.distanceTo(this._arrPolylines[c].circleCoords[0]),g=f,y=this._arrPolylines[c].circleCoords[0];d+=p;var v=this._tooltipNew,k=this._arrPolylines[c].tooltips[0];this._updateTooltip(k,v,d,p,g,y),this._arrPolylines[c].tooltips.map((function(C,I){if(I>=1){var D=this._arrPolylines[c].circleCoords[I-1].distanceTo(this._arrPolylines[c].circleCoords[I]),A=this._arrPolylines[c].circleCoords[I-1],q=this._arrPolylines[c].circleCoords[I];d+=D;var z=this._arrPolylines[c].tooltips[I-1];this._updateTooltip(C,z,d,D,A,q)}}).bind(this))},_resumeFirstpointClick:function(h){var c=this._lineNr;this._resumeFirstpointFlag=!1,this._map.off("mousemove",this._resumeFirstpointMousemove,this),this._map.off("click",this._resumeFirstpointClick,this),this._layerPaint.removeLayer(this._rubberlinePath2),this._arrPolylines[c].circleMarkers[0].setStyle(this.options.intermedCircle),this._arrPolylines[c].circleMarkers[0].unbindTooltip(),this._arrPolylines[c].circleMarkers[0].bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"});var f=new n.CircleMarker(h.latlng,this.options.startCircle).addTo(this._layerPaint);f.cntLine=c,f.cntCircle=0,f.on("mousedown",this._dragCircle,this),f.bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._arrPolylines[c].circleMarkers.unshift(f),this._arrPolylines[c].circleMarkers.map(function(g,y){g.cntCircle=y}),this._arrPolylines[c].circleCoords.unshift(h.latlng);var d=this._polylineArc(h.latlng,currentCircleCoords),p=this._drawArrow(d);this._arrPolylines[c].arrowMarkers.unshift(p),this._arrPolylines[c].arrowMarkers.map(function(g,y){g.cntLine=c,g.cntArrow=y}),d.pop(),this._arrPolylines[c].polylinePath.setLatLngs(d.concat(this._arrPolylines[c].polylinePath.getLatLngs())),this._arrPolylines[c].tooltips.unshift(this._tooltipNew),this._map.on("mousemove",this._mouseMove,this)},_dragCircle:function(h){var c=this._arcpoints;if(h.originalEvent.ctrlKey||h.originalEvent.metaKey){if(this._map.off("click",this._mouseClick,this),h.target.cntCircle===0){this._resumeFirstpointFlag=!0,this._lineNr=h.target.cntLine;var f=this._lineNr;this._circleNr=h.target.cntCircle,currentCircleCoords=h.latlng,this._arrPolylines[f].circleMarkers[0].setStyle(this.options.currentCircle),this._rubberlinePath2=n.polyline([],{color:this.options.tempLine.color,weight:this.options.tempLine.weight,interactive:!1,dashArray:"8,8"}).addTo(this._layerPaint).bringToBack(),this._tooltipNew=n.marker(currentCircleCoords,{icon:n.divIcon({className:"polyline-measure-tooltip",iconAnchor:[-4,-4]}),interactive:!1}),this._tooltipNew.addTo(this._layerPaint);var d="";this.options.showBearings===!0&&(d=d+this.options.bearingTextIn+":---°<br>"+this.options.bearingTextOut+":---°"),d=d+'<div class="polyline-measure-tooltip-difference">+0</div>',d=d+'<div class="polyline-measure-tooltip-total">0</div>',this._tooltipNew._icon.innerHTML=d,this._map.off("mousemove",this._mouseMove,this),this._map.on("mousemove",this._resumeFirstpointMousemove,this)}return}if(h.originalEvent.shiftKey){this._lineNr=h.target.cntLine;var f=this._lineNr;this._circleNr=h.target.cntCircle;var p=this._circleNr;if(this._layerPaint.hasLayer(this._rubberlinePath)&&f===this._currentLine.id){if(this._cntCircle--,this._currentLine.circleMarkers.length===1){this._currentLine.finalize();return}if(this._currentLine.circleCoords.splice(p,1),this._currentLine.circleMarkers[p].removeFrom(this._layerPaint),this._currentLine.circleMarkers.splice(p,1),this._currentLine.circleMarkers.map(function(D,A){D.cntCircle=A}),y=this._currentLine.polylinePath.getLatLngs(),this._currentLine.tooltips[p].removeFrom(this._layerPaint),this._currentLine.tooltips.splice(p,1),p===0){this._currentLine.circleMarkers.length===1?this._currentLine.circleMarkers[0].setStyle(this.options.currentCircle):this._currentLine.circleMarkers[0].setStyle(this.options.startCircle),y.splice(0,c-1),this._currentLine.circleMarkers[0].bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._currentLine.arrowMarkers[p].removeFrom(this._layerPaint),this._currentLine.arrowMarkers.splice(0,1);var d="";this.options.showBearings===!0&&(d=this.options.bearingTextIn+":---°<br>"+this.options.bearingTextOut+":---°"),d=d+'<div class="polyline-measure-tooltip-difference">+0</div>',d=d+'<div class="polyline-measure-tooltip-total">0</div>',this._currentLine.tooltips[0]._icon.innerHTML=d}else p===this._currentLine.circleCoords.length?(this._currentLine.circleMarkers[p-1].on("click",this._resumePolylinePath,this),this._currentLine.circleMarkers[p-1].bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._currentLine.circleMarkers.slice(-1)[0].setStyle(this.options.currentCircle),y.splice(-(c-1),c-1),this._currentLine.arrowMarkers[p-1].removeFrom(this._layerPaint),this._currentLine.arrowMarkers.splice(-1,1)):(v=this._polylineArc(this._currentLine.circleCoords[p-1],this._currentLine.circleCoords[p]),Array.prototype.splice.apply(y,[(p-1)*(c-1),2*c-1].concat(v)),this._currentLine.arrowMarkers[p-1].removeFrom(this._layerPaint),this._currentLine.arrowMarkers[p].removeFrom(this._layerPaint),k=this._drawArrow(v),this._currentLine.arrowMarkers.splice(p-1,2,k));this._currentLine.polylinePath.setLatLngs(y),this._currentLine.arrowMarkers.map(function(D,A){D.cntLine=f,D.cntArrow=A});var g=0;this._currentLine.tooltips.map((function(D,A,q){if(A>=1){var z,B,G=this._currentLine.tooltips[A-1],ee=this._currentLine.circleCoords[A-1];A===q.length-1?(z=this._currentLine.circleCoords[A-1].distanceTo(h.latlng),B=h.latlng,this._updateTooltip(D,G,g+z,z,ee,B)):(z=this._currentLine.circleCoords[A-1].distanceTo(this._currentLine.circleCoords[A]),B=this._currentLine.circleCoords[A],g+=z,this._updateTooltip(D,G,g,z,ee,B))}}).bind(this)),this._currentLine.distance=g}else{if(this._arrPolylines[f].circleMarkers.length===2){this._layerPaint.removeLayer(this._arrPolylines[f].circleMarkers[1]),this._layerPaint.removeLayer(this._arrPolylines[f].tooltips[1]),this._layerPaint.removeLayer(this._arrPolylines[f].circleMarkers[0]),this._layerPaint.removeLayer(this._arrPolylines[f].tooltips[0]),this._layerPaint.removeLayer(this._arrPolylines[f].arrowMarkers[0]),this._layerPaint.removeLayer(this._arrPolylines[f].polylinePath),this._map.fire("polylinemeasure:remove",h),this._map.fire("polylinemeasure:change",this._arrPolylines[this._lineNr]);return}this._arrPolylines[f].circleCoords.splice(p,1),this._arrPolylines[f].circleMarkers[p].removeFrom(this._layerPaint),this._arrPolylines[f].circleMarkers.splice(p,1),this._arrPolylines[f].circleMarkers.map(function(D,A){D.cntCircle=A});var y=this._arrPolylines[f].polylinePath.getLatLngs();if(this._arrPolylines[f].tooltips[p].removeFrom(this._layerPaint),this._arrPolylines[f].tooltips.splice(p,1),!this._arrPolylines[f].circleMarkers.length){this._arrPolylines.splice(f,1),this._arrPolylines.forEach(function(D,A){D.circleMarkers.map(function(q){q.cntLine=A}),D.arrowMarkers.map(function(q){q.cntLine=A})});return}if(p===0){this._arrPolylines[f].circleMarkers[0].setStyle(this.options.startCircle),y.splice(0,c-1),this._arrPolylines[f].circleMarkers[0].bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._arrPolylines[f].arrowMarkers[p].removeFrom(this._layerPaint),this._arrPolylines[f].arrowMarkers.splice(0,1);var d="";this.options.showBearings===!0&&(d=this.options.bearingTextIn+":---°<br>"+this.options.bearingTextOut+":---°"),d=d+'<div class="polyline-measure-tooltip-difference">+0</div>',d=d+'<div class="polyline-measure-tooltip-total">0</div>',this._arrPolylines[f].tooltips[0]._icon.innerHTML=d}else if(p===this._arrPolylines[f].circleCoords.length)this._arrPolylines[f].circleMarkers[p-1].on("click",this._resumePolylinePath,this),this._arrPolylines[f].circleMarkers[p-1].bindTooltip(this.options.tooltipTextMove+this.options.tooltipTextDelete+this.options.tooltipTextResume,{direction:"top",opacity:.7,className:"polyline-measure-popupTooltip"}),this._arrPolylines[f].circleMarkers.slice(-1)[0].setStyle(this.options.endCircle),this._arrPolylines[f].tooltips.slice(-1)[0]._icon.classList.add("polyline-measure-tooltip-end"),y.splice(-(c-1),c-1),this._arrPolylines[f].arrowMarkers[p-1].removeFrom(this._layerPaint),this._arrPolylines[f].arrowMarkers.splice(-1,1);else{var v=this._polylineArc(this._arrPolylines[f].circleCoords[p-1],this._arrPolylines[f].circleCoords[p]);Array.prototype.splice.apply(y,[(p-1)*(c-1),2*c-1].concat(v)),this._arrPolylines[f].arrowMarkers[p-1].removeFrom(this._layerPaint),this._arrPolylines[f].arrowMarkers[p].removeFrom(this._layerPaint);var k=this._drawArrow(v);this._arrPolylines[f].arrowMarkers.splice(p-1,2,k)}this._arrPolylines[f].polylinePath.setLatLngs(y),this._arrPolylines[f].arrowMarkers.map(function(D,A){D.cntLine=f,D.cntArrow=A});var C=0;this._arrPolylines[f].tooltips.map((function(D,A){if(A>=1){var q=this._arrPolylines[f].circleCoords[A-1].distanceTo(this._arrPolylines[f].circleCoords[A]),z=this._arrPolylines[f].circleCoords[A-1],B=this._arrPolylines[f].circleCoords[A];C+=q,this._arrPolylines[f].distance=C;var G=this._arrPolylines[f].tooltips[A-1];this._updateTooltip(D,G,C,q,z,B)}}).bind(this))}this._map.fire("polylinemeasure:remove",h),this._map.fire("polylinemeasure:change",this._arrPolylines[this._lineNr]);return}this._e1=h,this._measuring&&this._cntCircle===0&&(this._map.dragging.disable(),this._map.off("mousemove",this._mouseMove,this),this._map.off("click",this._mouseClick,this),this._mouseStartingLat=h.latlng.lat,this._mouseStartingLng=h.latlng.lng,this._circleStartingLat=h.target._latlng.lat,this._circleStartingLng=h.target._latlng.lng,this._map.on("mousemove",this._dragCircleMousemove,this))},seed:function(h){h.forEach(c=>{this._toggleMeasure(),this._startLine(c[0]),c.forEach((f,d)=>{const p=n.latLng(f);this._mouseMove({latLng:p}),this._currentLine.addPoint(p),d===c.length-1&&(this._finishPolylinePath(),this._toggleMeasure())})})}}),n.Map.mergeOptions({PolylineMeasureControl:!1}),n.Map.addInitHook(function(){this.options.polylineMeasureControl&&(this.PMControl=new n.Control.PolylineMeasure,this.addControl(this.PMControl))}),n.control.polylineMeasure=function(h){return new n.Control.PolylineMeasure(h)},n.Control.PolylineMeasure})}(en)),en.exports}vu();function gu(t){t.Polyline.include({_snakingTimestamp:0,_snakingRings:0,_snakingTailRings:0,_snakingVertices:0,_snakingTailVertices:0,_snakingDistance:0,_snakingTailDistance:0,_snakingIn:!1,_snakingOut:!1,_snakingPaused:!1,_snakingPauseTime:0,snakeIn:function(){if(!(this._snakingIn||this._snakingOut)&&!(!("performance"in window)||!("now"in window.performance)||!this._map))return this._snakingIn=!0,this._snakingTime=performance.now(),this._snakingVertices=this._snakingRings=this._snakingDistance=0,this._snakeLatLngs||(this._snakeLatLngs=t.LineUtil.isFlat(this._latlngs)?[this._latlngs]:this._latlngs),this._latlngs=[[this._snakeLatLngs[0][0],this._snakeLatLngs[0][0]]],this._update(),this._snake(),this.fire("snakestart"),this.fire("snakeInStart"),this},snakeOut:function(){if(!this._snakingOut&&!(!("performance"in window)||!("now"in window.performance)||!this._map)){if(this._snakingOut=!0,this._snakingTime=performance.now(),this._snakingTailVertices=this._snakingTailRings=this._snakingTailDistance=0,this._snakeLatLngs||(this._snakeLatLngs=t.LineUtil.isFlat(this._latlngs)?[this._latlngs]:this._latlngs),!this._snakingIn){const n=[];Object.keys(this._snakeLatLngs).forEach(()=>{n.push([]),this._snakeLatLngs[n.length-1].forEach(function(u){n[n.length-1].push([u.lat,u.lng])})}),this._latlngs=n}return this._update(),this._snakingIn||this._snake(),this.fire("snakeOutStart"),this}},_snake:function(){if(!this._map||this._snakingPaused)return;const n=performance.now();let a=n-this._snakingTime;a=a===0?.001:a;const u=a*this.options.snakingSpeed/1e3;return this._snakingTime=n,this._snakingIn&&this._latlngs[this._snakingRings].pop(),this._snakingOut&&this._latlngs[this._snakingTailRings].shift(),this._snakingIn&&this._snakeHeadForward(u),this._snakingOut&&this._snakeTailForward(u),this.setLatLngs(this._latlngs),(this._snakingIn||this._snakingOut)&&(this.fire("snake"),t.Util.requestAnimFrame(this._snake,this)),this},_snakeHeadForward:function(n){let a=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingRings][this._snakingVertices]),u=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingRings][this._snakingVertices+1]),r=a.distanceTo(u);for(;this._snakingDistance+n>r;){if(this._snakingVertices++,this._latlngs[this._snakingRings].push(this._snakeLatLngs[this._snakingRings][this._snakingVertices]),this._snakingVertices>=this._snakeLatLngs[this._snakingRings].length-1){if(this._snakingRings>=this._snakeLatLngs.length-1)return this._snakeInEnd();this._snakingVertices=0,this._snakingRings++,this._latlngs[this._snakingRings]=[this._snakeLatLngs[this._snakingRings][this._snakingVertices]]}this._snakingDistance-=r,a=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingRings][this._snakingVertices]),u=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingRings][this._snakingVertices+1]),r=a.distanceTo(u)}this._snakingDistance+=n;const h=this._snakingDistance/r,c=u.multiplyBy(h).add(a.multiplyBy(1-h)),f=this._map.containerPointToLatLng(c);return this._latlngs[this._snakingRings].push(f),this.options.followHead&&this._map.setView(f),this},_snakeTailForward:function(n){let a=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingTailRings][this._snakingTailVertices]),u=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingTailRings][this._snakingTailVertices+1]),r=a.distanceTo(u);for(;this._snakingTailDistance+n>r;){if(this._snakingTailVertices++,this._latlngs[this._snakingTailRings].shift(),this._snakingTailVertices>=this._snakeLatLngs[this._snakingTailRings].length-1){if(this._snakingTailRings>=this._snakeLatLngs.length-1)return this._snakeOutEnd();this._snakingTailVertices=0,this._latlngs[this._snakingTailRings]=[],this._snakingTailRings++,this._latlngs[this._snakingTailRings].shift()}this._snakingTailDistance-=r,a=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingTailRings][this._snakingTailVertices]),u=this._map.latLngToContainerPoint(this._snakeLatLngs[this._snakingTailRings][this._snakingTailVertices+1]),r=a.distanceTo(u)}this._snakingTailDistance+=n;const h=this._snakingTailDistance/r,c=u.multiplyBy(h).add(a.multiplyBy(1-h)),f=this._map.containerPointToLatLng(c);return this._latlngs[this._snakingTailRings].unshift(f),this},_snakeInEnd:function(){return this._snakingIn=!1,this._snakingOut||this.setLatLngs(this._snakeLatLngs),this.fire("snakeend"),this.fire("snakeInEnd"),this},_snakeOutEnd:function(){return this._snakingOut=!1,this.fire("snakeOutEnd"),this},snakeReset:function(){return this._snakingIn=this._snakingOut=!1,this._snakeLatLngs&&this.setLatLngs(this._snakeLatLngs),this},snakePause:function(){this._snakingPaused=!0,this._snakingPauseTime=performance.now()},snakeUnpause:function(){if(!this._snakingPaused)return;this._snakingPaused=!1;const a=performance.now()-this._snakingPauseTime;this._snakingPauseTime=0,this._snakingTime+=a,t.Util.requestAnimFrame(this._snake,this)}}),t.Polyline.mergeOptions({snakingSpeed:200,followHead:!1}),t.LayerGroup.include({_snakingLayers:[],_snakingLayersDone:0,_snakingTailLayersDone:0,_snakingIn:!1,_snakingOut:!1,_snakeTimeoutsId:[],snakeIn:function(){if(!(!("performance"in window)||!("now"in window.performance)||!this._map||this._snakingIn||this._snakingOut)){if(this._snakingIn=!0,this._snakingLayersDone=0,this._snakingLayers.length===0&&this._initSnakingLayers(),this.options.snakeRemoveLayers)this.clearLayers();else for(const n in this._snakingLayers)this._snakingLayers[n]instanceof t.Polyline&&this.removeLayer(this._snakingLayers[n]);return this.fire("snakestart"),this.fire("snakeInStart"),this._snakeHeadNext()}},snakeOut:function(){if(!(!("performance"in window)||!("now"in window.performance)||!this._map||this._snakingOut))return this._snakingOut=!0,this._snakingTailLayersDone=0,this.fire("snakeOutStart"),this._snakeTailNext()},_initSnakingLayers:function(){const n=Object.keys(this._layers);for(const a in n){const u=n[a];this._snakingLayers.push(this._layers[u])}return this},_snakeHeadNext:function(){if(!this._snakingIn)return this;if(this._snakingLayersDone>=this._snakingLayers.length){this.fire("snakeend"),this.fire("snakeInEnd"),this._snakingIn=!1;return}const n=this._snakingLayers[this._snakingLayersDone];return this._snakingLayersDone++,this.getLayer(n)||this.addLayer(n),"snakeIn"in n?(n.once("snakeInEnd",function(){this._snakeTimeoutsId.push(setTimeout(this._snakeHeadNext.bind(this),this.options.snakingPause))},this),n.snakeIn()):this._snakeTimeoutsId.push(setTimeout(this._snakeHeadNext.bind(this),this.options.snakingPause)),this.fire("snake"),this},_snakeTailNext:function(){if(!this._snakingOut)return this;if(this.options.snakeRemoveLayers&&this.removeLayer(this._snakingLayers[this._snakingTailLayersDone-1]),this._snakingTailLayersDone>=this._snakingLayers.length){this.fire("snakeOutEnd"),this._snakingOut=!1;return}const n=this._snakingLayers[this._snakingTailLayersDone];return this._snakingTailLayersDone++,"snakeOut"in n?(n.once("snakeOutEnd",function(){this._snakeTimeoutsId.push(setTimeout(this._snakeTailNext.bind(this),this.options.snakingPause))},this),n.snakeOut()):this._snakeTimeoutsId.push(setTimeout(this._snakeTailNext.bind(this),this.options.snakingPause)),this.fire("snake"),this},snakeReset:function(){this._snakingIn=!1,this._snakingOut=!1,this._snakingLayers.length===0&&this._initSnakingLayers();for(const n in this._snakeTimeoutsId)clearTimeout(n);this._snakeTimeoutsId=[];for(const n in this._snakingLayers)this._snakingLayers[n]instanceof t.Polyline&&this._snakingLayers[n].snakeReset(),this.getLayer(this._snakingLayers[n])||this.addLayer(this._snakingLayers[n]);return this}}),t.LayerGroup.mergeOptions({snakingPause:200,snakeRemoveLayers:!0})}function _u(t,n,a){return`
    <div class="my-div-icon__inner">${`
    <svg
      xmlns="http://www.w3.org/2000/svg" version="1.0" width="20" height="35" viewBox="0 0 322.41 644.26"
      preserveAspectRatio="xMidYMid meet" id="svg24">
    <g transform="scale(.1 -.1) rotate(39.9 10895.45 -1796.96)" id="g22" style="fill:#000;stroke:none">
      <path style="fill:${n};fill-opacity:1;stroke:none;stroke-width:7.5px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="M90.2 1440.33l700.66-772.42L1810.08 25.48l862.86 683.33 1051.22 1347.75 444.64 531.73 179-120.54 69.53 145.88-83.22 221.15 513.31 509.29 543.23 600.84 96.12 630.8-152.93 477.63-261.24 330.67-360.5 295.62-284.29 161.95-308.89 90.7-252.9 14.74-207.63-43.52-353.46-170.4-309.83-301.5-239.28-362.56-272.9-369.48-178.18-210.64-231.28 63.55-110.64-68.23-7.01-78.63 152.75-164.84-655.94-756.08-407.52-433.12-501.68-572.84-377.55-662.23-122.76-290.99z" id="path841"/><path style="fill:#000;stroke:none;stroke-width:1" d="M3746.75 5933.68c-306-61-565-242-847-592-85-106-140-197-169-281-15-42-64-108-229-306l-211-253-84 29c-46 15-100 28-120 28-55-1-115-33-143-78-24-36-47-101-47-129 0-7 41-33 91-59l91-45-19-22c-11-12-132-157-270-322-293-352-302-362-622-699-434-458-552-591-666-751-131-183-290-469-427-768-65-143-69-156-66-212 4-71 40-136 142-262 264-325 979-925 1351-1135 122-69 204-98 273-98 57 0 64 3 158 67 312 211 582 430 760 615 126 131 222 254 659 843 98 132 205 274 239 315 69 86 530 636 556 663 16 18 20 15 75-62 32-45 64-81 72-81 48 0 156 93 169 145 13 51-3 119-45 194-34 61-39 76-28 90 6 10 101 123 209 252 138 163 211 241 240 258 110 62 198 146 345 329 108 134 151 198 211 317 58 115 97 226 118 333 19 98 18 299-2 402-58 307-250 598-577 872-269 225-515 353-776 402-100 19-318 20-411 1zm415-21c297-56 614-250 910-555 107-110 158-175 224-283l41-67-39-65c-47-77-58-135-43-216 16-85 58-161 135-244l68-72-17-79c-44-220-133-392-319-623-115-143-232-256-307-295-49-26-85-64-280-296-123-145-228-272-235-280-10-12-2-33 42-114 66-118 70-153 24-196-17-16-35-29-39-29s-38 43-76 95-72 94-76 92c-10-3-559-657-671-800-57-73-209-274-337-447s-276-369-329-435c-222-279-475-505-889-794-131-92-134-93-182-89-162 16-624 337-1120 780-346 309-550 548-550 646 0 80 285 635 447 872 126 183 222 293 617 710 355 375 415 441 758 852l298 358-110 55-110 55 15 30c19 37 52 60 85 60 14 0 72-16 128-34l103-35 233 280c189 227 238 291 251 332 26 80 76 162 170 280 370 460 741 633 1180 551z" id="path4"/><path style="fill:#000;stroke:none;stroke-width:1" d="M3831.75 5895.68c-54-4-103-11-107-15-11-11 91-85 167-122 148-73 275-64 389 27l59 47-30 13c-50 20-222 51-303 55-41 2-120 0-175-5z" id="path6"/><path style="fill:#000;stroke:none;stroke-width:1" d="M4128.75 5673.68c-170-48-408-178-602-329-180-140-397-340-547-505-111-123-129-153-97-165 12-5 39 18 97 81 44 49 148 154 231 235 120 117 155 146 172 142 15-4 55 18 144 80 176 122 283 157 374 122 37-14 87-61 74-70-2-1-39-24-83-51s-189-120-322-208c-178-116-243-164-243-178 0-11 7-22 15-25 10-4 113 58 273 163 141 93 280 183 307 200 59 36 374 210 558 307 109 58 128 71 125 90-4 25-54 52-173 91-99 34-225 42-303 20zm223-56c66-17 155-51 155-59 0-4-39-28-87-53-49-25-158-84-243-131l-154-85-21 37c-28 51-73 74-142 73-86-1-142-25-291-125-193-130-200-133-82-35 189 158 404 287 600 360 82 31 190 38 265 18z" id="path8"/><path style="fill:#000;stroke:none;stroke-width:1" d="M5007.75 5219.68c-7-5-63-161-125-347-127-381-135-400-288-751-60-139-108-260-106-270s11-19 21-21c20-4 33 22 194 398 68 157 145 363 215 573l110 328 25-37c68-100 109-233 99-322-40-336-266-793-623-1260-93-121-106-152-65-152 38 0 282 338 443 612 189 322 302 641 300 846-1 91-32 185-98 294-55 91-82 121-102 109z" id="path10"/><path style="fill:#000;stroke:none;stroke-width:1" d="M2934.75 4659.68c-131-42-177-93-321-351-64-113-123-232-132-264-24-81-18-180 14-224 13-18 277-246 587-506 605-508 603-507 695-492 85 14 162 61 355 219 126 102 202 172 223 204 115 174 75 432-110 705-79 115-298 337-429 435-194 144-394 243-560 278-98 21-250 19-322-4z" id="path12"/><path style="fill:#000;stroke:none;stroke-width:1" d="M2175.75 4015.68c-254-317-401-491-606-720-310-347-397-482-410-639-4-49-1-87 12-134l18-66 104 104c523 517 976 1183 1124 1653 22 72 23 81 5 88-8 3-96-98-247-286z" id="path14"/><path style="fill:#000;stroke:none;stroke-width:1" d="M4047.75 2817.68c-352-192-817-615-1186-1079-155-194-307-412-297-422 15-15 146-11 204 6 143 42 259 151 558 531 190 240 282 350 574 684 141 162 255 300 253 305-7 21-33 15-106-25z" id="path16"/><path style="fill:#000;stroke:none;stroke-width:1" d="M1140.75 2242.68c-18-9-41-25-52-37-24-27-278-454-298-502-42-102 4-275 121-449 143-214 343-369 595-461 60-22 98-28 190-32 112-5 116-4 167 23 77 42 450 370 474 416 39 76 20 155-52 224-60 57-926 782-968 811-41 28-128 31-177 7z" id="path18"/><path style="fill:#000;stroke:none;stroke-width:1" d="M889.75 2238.68c-23-9-47-41-57-76-6-18 4-28 64-64l71-43 25 24c14 14 27 41 31 61 5 36 4 38-50 72-31 20-57 36-59 35-2 0-13-4-25-9z" id="path20"/></g>
    </svg>
  `}</div>
    ${a?`<div class="my-div-icon__name">${t}</div>`:""}
  `}gu(mu);const yu=Pt({name:"MapContainer",components:{ColorModal:Zo,Queue:cu},emits:["change-need-show-messages","update-telemetry-device-id"],props:["activeDevices","isSelectedDeviceFollowed","params","selectedDeviceId"],data(){return{activeDevicesIDs:[],colorDeviceId:0,colorModel:"#fff",devicesStates:{},mapFlyToZoom:15,mapIsFlying:null,messagesStores:{},player:{currentMsgIndex:null,mode:"time",tailInterval:0,speed:10,status:"stop"}}},computed:{...Rt(fs,{socketConnected:t=>t.socketConnected}),...Rt(dt,{devicesColors:t=>t.devicesColors}),...Rt(yt,{date:t=>t.date}),...Rt(cn,{telemetry:t=>t.telemetry,telemetryKeys:t=>t.telemetryKeys}),mapHeight(){let t="100%";return this.activeDevices.length&&this.params.needShowPlayer&&(t="calc(100% - 48px)"),t},messages(){return this.activeDevicesIDs.reduce((t,n)=>(t[n]=this.messagesStores[n].messages.reduce((a,u,r)=>(u["position.latitude"]&&u["position.longitude"]&&(this.params.needShowInvalidPositionMessages||!u["position.valid"]||u["position.valid"]&&u["position.valid"]===!0)&&a.push(u),a),[]),t),{})}},methods:{..._t(dt,["getInitDataByDeviceId","updateDeviceColor"]),..._t(yt,["getMessagesStore"]),addFlags(t){if(!this.markers[t])return!1;if(this.markers[t].flags||(this.markers[t].flags={start:{},stop:{}}),this.messages[t].length){const n=[this.messages[t][0]["position.latitude"],this.messages[t][0]["position.longitude"]],a=[this.messages[t][this.messages[t].length-1]["position.latitude"],this.messages[t][this.messages[t].length-1]["position.longitude"]];this.markers[t].flags.start=te.marker(n,{icon:this.generateFlag({id:t,status:"start"})}),this.markers[t].flags.start.addTo(this.map),this.markers[t].flags.stop=te.marker(a,{icon:this.generateFlag({id:t,status:"stop"})}),this.messages[t].timestampTo<=Date.now()&&this.markers[t].flags.stop.addTo(this.map)}},centerOnDevice(t,n){let a=dt().getDeviceById(t)&&[];a&&(this.messages[t]&&this.messages[t].length&&(a=[this.messages[t][this.messages[t].length-1]["position.latitude"],this.messages[t][this.messages[t].length-1]["position.longitude"]]),a.length?this.map.setView(a,n||14,{animation:!1}):this.$q.notify({message:"No Position!",color:"warning",timeout:this.params.needShowMessages?500:2e3}))},flyToDevice(t){let n=dt().getDeviceById(t)&&[];n&&(this.messages[t]&&this.messages[t].length&&(n=[this.messages[t][this.messages[t].length-1]["position.latitude"],this.messages[t][this.messages[t].length-1]["position.longitude"]]),n.length?this.flyToWithHideTracks(n,this.mapFlyToZoom):this.$q.notify({message:"No Position!",color:"warning",timeout:this.params.needShowMessages?500:2e3}))},flyToWithHideTracks(t,n){const a=[];let u=!1;this.map.once("zoomstart",r=>{this.mapIsFlying=!0,r.target._zoom!==n&&(u=!0,Object.keys(this.tracks).forEach(c=>{const f=this.tracks[c];f instanceof te.Polyline&&(f.tail&&f.tail instanceof te.Polyline&&this.map.hasLayer(f.tail)&&(this.map.removeLayer(f.tail),a.push(f.tail)),f.overview&&f.overview instanceof te.Polyline&&this.map.hasLayer(f.overview)&&(this.map.removeLayer(f.overview),a.push(f.overview)),f.overview&&this.map.hasLayer(f.overview)&&(this.map.removeLayer(f),a.push(f)))}))}),this.map.once("zoomend",r=>{this.mapIsFlying=!1,u&&a.forEach(h=>{this.map.addLayer(h)})}),this.map.flyTo(t,n)},generateFlag(t){let{id:n,status:a}=t||{},u=n&&this.devicesColors[n]?this.devicesColors[n]:"#e53935",r="mdi-map-marker-star-outline";return a==="start"?(u=wo("primary"),r="mdi-map-marker-outline"):a==="stop"&&(u=wo("positive"),r="mdi-map-marker-check"),te.divIcon({className:`my-flag-icon flag-${a}-${n}`,iconSize:new te.Point(35,35),html:`<i aria-hidden="true" style="color: ${u};" class="my-flag-icon__inner mdi ${r}"></i>`})},generateIcon(t,n,a){return te.divIcon({className:`my-div-icon icon-${t}`,iconSize:new te.Point(20,35),html:_u(n,a,this.params.needShowNamesOnMap)})},getAccuracyParams(t){const n=[t["position.latitude"],t["position.longitude"]],a=t["position.hdop"]||t["position.pdop"]||0;return{position:n,accuracy:a,circleStyle:{stroke:!0,color:"#444",weight:3,opacity:.5,fillOpacity:.15,fillColor:"#444",clickable:!1}}},async getDeviceData(t){if(!t)return;const n=this.messagesStores[t];n.realtimeEnabled&&await n.unsubscribePooling(),n.clearMessages();const a=this.date[0],u=this.date[1];if(n.setTimestampFrom(a),n.setTimestampTo(u),await n.get(),u>Date.now()&&(await n.pollingGet())(),this.addFlags(t),!n.messages.length)try{this.devicesStates[t].telemetryAccess=!0,await this.getInitDataByDeviceId([t,this.params.needShowInvalidPositionMessages])}catch(r){r.response&&r.response.status&&r.response.status===403&&(this.devicesStates[t].telemetryAccess=!1)}if(this.devicesStates[t].initStatus=!0,this.devicesStates[t].messagesAccess===!1){const r=dt().getDeviceById(t);Object.defineProperty(r,this.devicesStates[t].telemetryAccess===!1?"x-flespi-no-access":"x-flespi-telemetry-access",{value:!0,enumerable:!1})}},getLatLngArrByDevice(t){return this.messages[t]?this.messages[t].reduce((n,a)=>(n.push([a["position.latitude"],a["position.longitude"]]),n),[]):[]},async initDevice(t){if(!t)return;this.$q.loading.show();const n=this.messagesStores[t];await n.getCols({actions:!0,etc:!0}),await this.getDeviceData(t),this.$connector.socket.on("offline",()=>{n.setOffline()}),this.$connector.socket.on("connect",()=>{n.offline&&(n.setReconnected(),n.getMissedMessages())}),t===this.selectedDeviceId&&this.devicesStates[t].initStatus===!0&&(this.$emit("update-telemetry-device-id",parseInt(t)),this.centerOnDevice(t)),this.$q.loading.hide()},initMarker(t,n,a){const u=this.messages[t][this.messages[t].length-1]["position.direction"]?this.messages[t][this.messages[t].length-1]["position.direction"]:0,r=this.tracks[t]&&this.tracks[t].options?this.tracks[t].options.color:this.markers[t]?this.markers[t].color:this.devicesColors[t];this.markers[t]=te.marker(a,{icon:this.generateIcon(t,n,r),draggable:!1,title:n}),this.markers[t].id=t,this.markers[t].color=r;const{position:h,accuracy:c,circleStyle:f}=this.getAccuracyParams(this.messages[t][this.messages[t].length-1]);this.markers[t].accuracy=te.circle(h,c,f),this.markers[t].accuracy.addTo(this.map),this.markers[t].addEventListener("add",d=>{this.updateMarkerDirection(t,u),this.messages[t]&&this.messages[t].length&&(this.selectedDeviceId,parseInt(t))}),this.markers[t].addEventListener("click",d=>{this.$emit("update-telemetry-device-id",parseInt(t))}),this.markers[t].addEventListener("move",d=>{this.player.status==="stop"&&this.updateMarkerDirection(t,this.messages[t][this.messages[t].length-1]["position.direction"])}),this.markers[t].addEventListener("contextmenu",d=>{this.colorDeviceId=t,this.colorModel=this.devicesColors[t]||"#909090",this.$refs.colorModal.show()}),this.markers[t].addTo(this.map)},initMessagesStoreForDevice(t){if(!this.messagesStores[t]){if(this.messagesStores[t]=this.getMessagesStore(t,(n,a)=>{n.response&&n.response.status&&n.response.status===403&&(this.devicesStates[a].messagesAccess=!1)}),this.messagesStores[t].setSortBy("timestamp"),this.messagesStores[t].setLimit(0),!this.devicesStates[t]){this.devicesStates[t]={messagesAccess:!0,initStatus:!1};return}this.devicesStates[t].messagesAccess=!0,this.devicesStates[t].initStatus=!1}},initMap(){if(!this.map){let n=te.tileLayer("//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:2,maxZoom:19,noWrap:!0});this.map=te.map("map",{center:[51.50853,-.12574],zoom:3,maxBounds:[[90,-180],[-90,180]],layers:[n]}),this.map.addEventListener("zoom",h=>{h.flyTo||(this.mapFlyToZoom=h.target.getZoom())}),this.map.addEventListener("click",this.mapClickHandler);let a=te.tileLayer("//server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{minZoom:2,maxZoom:19,noWrap:!0,attribution:"© ArcGIS"}),u=te.tileLayer("//{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{minZoom:2,maxZoom:16,attribution:"Map data: © OpenStreetMap contributors, SRTM | Map style: © OpenTopoMap (CC-BY-SA)",noWrap:!0}),r=te.tileLayer.wms("//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{layers:"semitransparent",transparent:"true",format:"image/png",maxZoom:19,opacity:.5});var t={OpenStreetMap:n,Satellite:a,OpenTopoMap:u};te.control.layers(t,{"OpenStreetMaps (0.5)":r}).addTo(this.map),te.control.polylineMeasure({position:"topleft",showBearings:!1,clearMeasurementsOnStop:!1,showUnitControl:!1,showClearControl:!0,measureControlTitleOn:"Turn on ruler",measureControlTitleOff:"Turn off ruler",tooltipTextFinish:"Click to <b>finish line</b><br>",tooltipTextDelete:"Press SHIFT-key and click to <b>delete point</b>",tooltipTextMove:"Click and drag to <b>move point</b><br>",tooltipTextResume:"<br>Press CTRL-key and click to <b>resume line</b>",tooltipTextAdd:"Press CTRL-key and click to <b>add point</b>"}).addTo(this.map)}},mapClickHandler(t){this.map.messagePoint&&this.map.messagePoint.remove(),this.activeDevicesIDs.forEach(n=>{this.messagesStores[n].clearSelected()})},onResize(){this.map&&this.map.invalidateSize()},playerDataPause({id:t}){this.player.status!=="stop"&&(this.player.status="pause",this.tracks[t].overview.snakePause())},playerDataPlay({id:t}){if(this.player.status==="pause"){this.tracks[t].overview.snakeUnpause(),this.player.status="play";return}this.player.status="play",this.tracks[t].remove();const n=this.messages[t].map((u,r)=>({lat:u["position.latitude"],lng:u["position.longitude"],dir:u["position.direction"],index:r}));if(n.length<2){this.tracks[t].addTo(this.map),this.player.status="stop",this.player.currentMsgIndex=null;return}this.map.setView([n[0].lat,n[0].lng],this.map.getZoom(),{animation:!1});const a=te.polyline(n,{snakingSpeed:20*this.player.speed,color:this.tracks[t].options.color});this.tracks[t].overview=a,this.tracks[t].overview.addEventListener("click",u=>this.showMessageByTrackClick(u,t,this.tracks[t].overview)),a.addTo(this.map).snakeIn(),a.on("snake",()=>{const u=a.getLatLngs(),h=u.slice(-1)[0].slice(-1)[0],c=n[u[0].length-1];this.updateMarker(t,h,c.dir),this.player.currentMsgIndex!==c.index&&(this.player.currentMsgIndex=c.index)}),a.on("snakeInEnd",()=>{this.playerDataStop({id:t})})},playerDataStop({id:t}){this.player.status="stop",this.tracks[t].overview&&(this.tracks[t].overview.remove(),delete this.tracks[t].overview),this.tracks[t]&&this.tracks[t]instanceof te.Polyline&&(this.tracks[t].addTo(this.map),this.tracks[t].addEventListener("click",a=>this.showMessageByTrackClick(a,t,this.tracks[t])));const n=this.messages[t].slice(-1)[0];if(this.player.currentMsgIndex=null,n){const a=[n["position.latitude"],n["position.longitude"]];this.updateMarker(t,a,n["position.direction"])}},playerDataValue({id:t}){},playerModeChange({id:t,mode:n}){this.player.status!=="stop"&&(n==="data"?this.playerTimeStop({id:t}):this.playerDataStop({id:t})),this.player.mode=n},playerSpeedChangeHandler({speed:t,id:n}){this.player.speed=t,this.player.mode==="data"&&this.player.status!=="stop"&&this.tracks[n].overview.setStyle({snakingSpeed:20*t})},playProcess(t,n){const a=this.player.mode==="data"?0:1;switch(n){case"value":{a?this.playerTimeValue(t):this.playerDataValue(t);break}case"play":{if(this.player.status==="play")return;a?this.playerTimePlay(t):this.playerDataPlay(t);break}case"stop":{if(this.player.status==="stop")return;a?this.playerTimeStop(t):this.playerDataStop(t);break}case"pause":{if(this.player.status==="pause")return;a?this.playerTimePause(t):this.playerDataPause(t);break}}},playerTimePause({id:t}){this.player.status="pause"},playerTimePlay({id:t}){this.tracks[t]&&this.tracks[t]instanceof te.Polyline&&(this.tracks[t].remove(),this.player.status="play",this.map.setView([this.messages[t][0]["position.latitude"],this.messages[t][0]["position.longitude"]],this.map.getZoom(),{animation:!1}))},playerTimeStop({id:t}){if(this.tracks[t]&&this.tracks[t]instanceof te.Polyline){this.tracks[t].tail&&(this.tracks[t].tail.remove(),delete this.tracks[t].tail);const a=this.messagesStores[t].realtimeEnabled?this.messages[t].length-1:0,u=this.messages[t][a];this.$nextTick(()=>{this.player.currentMsgIndex=a?null:0}),this.player.status="stop",this.tracks[t].addTo(this.map);const r=[u["position.latitude"],u["position.longitude"]];this.updateMarker(t,r,u["position.direction"])}},playerTimeValue({id:t,messagesIndexes:n}){if(!this.messages[t]||!n||this.player.status!=="play"&&this.player.status!=="pause")return!1;let a=0,u=null;const r=n[n.length-1],h=0,c=this.messages[t].slice(h,r+1),f=c.reduce((d,p,g)=>(typeof p["position.latitude"]=="number"&&typeof p["position.longitude"]=="number"&&(u=g,d.push([p["position.latitude"],p["position.longitude"]])),d),[]);if(n.forEach(d=>{if(this.markers[t]&&this.markers[t]instanceof te.Marker){const p=this.messages[t][d],g=p&&typeof p["position.latitude"]=="number"&&typeof p["position.longitude"]=="number";if(this.player.currentMsgIndex=d,g){const y=[p["position.latitude"],p["position.longitude"]];if(this.player.status==="play"&&n[0]!==0){let v=1e3/this.player.speed/n.length;if(d!==0){const k=this.messages[t][d-1].timestamp,C=p.timestamp,I=C-k;v=I*1e3/this.player.speed,a=I}v=v-50,v?this.markers[t].slideTo(y,{duration:v}):this.markers[t].setLatLng(y).update(),this.updateMarkerDirection(t,p["position.direction"])}else this.markers[t].setLatLng(y).update(),this.updateMarker(t,y,p["position.direction"]);this.markers[t].accuracy.setRadius(this.getAccuracyParams(p).accuracy),this.markers[t].accuracy.setLatLng(y)}else{const y=this.messages[t][u],v=f[f.length-1];this.markers[t].setLatLng(v).update(),this.updateMarker(t,v,y["position.direction"]),this.markers[t].accuracy.setRadius(this.getAccuracyParams(y).accuracy),this.markers[t].accuracy.setLatLng(v)}}}),this.tracks[t]&&this.tracks[t]instanceof te.Polyline&&f.length){if(!this.tracks[t].tail||!(this.tracks[t].tail instanceof te.Polyline))return this.tracks[t].tail=te.polyline(f,this.tracks[t].options),this.tracks[t].tail.addTo(this.map),this.tracks[t].tail.addEventListener("click",d=>this.showMessageByTrackClick(d,t,this.tracks[t].tail)),!0;this.player.tailInterval&&clearTimeout(this.player.tailInterval),this.player.tailInterval=setTimeout(()=>{this.tracks[t].tail&&this.tracks[t].tail.setLatLngs(f)},a*700/this.player.speed)}},removeFlags(t){if(!this.markers[t]||!this.markers[t].flags||!(this.markers[t].flags.start instanceof te.Marker)||!(this.markers[t].flags.stop instanceof te.Marker))return!1;this.markers[t].flags.start.remove(),this.markers[t].flags.stop.remove(),this.markers[t].flags=void 0},removeMarker(t){this.markers[t]&&this.markers[t]instanceof te.Marker&&(this.removeFlags(t),this.map.removeLayer(this.markers[t].accuracy),this.markers[t].remove(),this.tracks[t].tail&&this.tracks[t].tail instanceof te.Polyline&&this.tracks[t].tail.remove(),this.tracks[t].overview&&this.tracks[t].overview instanceof te.Polyline&&this.tracks[t].overview.remove(),this.tracks[t].remove()),delete this.markers[t],delete this.tracks[t]},showMessageByTrackClick(t,n,a){t.originalEvent.view.L.DomEvent.stopPropagation(t);const u=this.messages[n],r=te.GeometryUtil.closest(this.map,a,t.latlng),h=u.reduce((f,d,p)=>{const g=d["position.latitude"],y=d["position.longitude"],v=u[p+1];if(!v)return f;const k=v["position.latitude"],C=v["position.longitude"],I=g>=r.lat&&k<=r.lat||g<=r.lat&&k>=r.lat,D=y>=r.lng&&C<=r.lng||y<=r.lng&&C>=r.lng;if(I&&D){const A=te.GeometryUtil.distance(this.map,r,{lat:g,lng:y}),q=te.GeometryUtil.distance(this.map,r,{lat:k,lng:C}),z=A>q?p+1:p;f.push(z)}return f},[]),c=u[h.slice(-1)[0]]||{};this.viewOnMapHandler(c),this.messagesStores[n].setSelected(h)},updateDeviceColorOnMap(t,n){if(!this.tracks[t]||!(this.tracks[t]instanceof te.Polyline)||!this.markers[t]||!(this.markers[t]instanceof te.Marker))return!1;this.tracks[t].setStyle({color:n}),this.tracks[t].tail&&this.tracks[t].tail.setStyle({color:n}),this.tracks[t].overview&&this.tracks[t].overview.setStyle({color:n}),this.markers[t].color=n,this.markers[t].setIcon(this.generateIcon(t,this.markers[t].options.title,n)),this.messages[t][this.messages[t].length-1]["position.direction"]&&this.updateMarkerDirection(t,this.messages[t][this.messages[t].length-1]["position.direction"])},updateMarker(t,n,a){this.updateMarkerDirection(t,a),this.markers[t].setLatLng(n).update()},updateMarkerDirection(t,n){if(n){const a=document.querySelector(`.icon-${t} .my-div-icon__inner`);a&&(a.style.transform=`rotate(${n||0}deg)`)}},updateOrInitDevice(t){if(!this.messages[t]||!this.messages[t].length)return this.markers[t]||(this.markers[t]={},this.markers[t].id=t,this.markers[t].color=this.devicesColors[t]||"#e53935",this.tracks[t]={}),!1;if(!(this.markers[t]instanceof te.Marker)&&!(this.tracks[t]instanceof te.Polyline)){const a=this.activeDevices.filter(r=>r.id===parseInt(t))[0].name||`#${t}`,u=[this.messages[t][this.messages[t].length-1]["position.latitude"],this.messages[t][this.messages[t].length-1]["position.longitude"]];if(this.initMarker(t,a,u),this.tracks[t]=te.polyline(this.getLatLngArrByDevice(t),{weight:4,color:this.markers[t]?this.markers[t].color:this.getColorById(t)}).addTo(this.map),this.tracks[t].addEventListener("click",r=>this.showMessageByTrackClick(r,t,this.tracks[t])),Number.parseInt(t)===this.selectedDeviceId)if(this.messages[t].length>1){const r=this.tracks[t].getBounds();this.map.fitBounds(r)}else this.map.setView(u,14,{animation:!1})}if(!this.devicesStates[t].messagesAccess)return!1;const n=this.getLatLngArrByDevice(t);if(this.selectedDeviceId&&this.selectedDeviceId==t&&this.isSelectedDeviceFollowed){const a=this.markers[t]&&this.markers[t]instanceof te.Marker?this.markers[t].getLatLng():{},u={lat:this.messages[t][this.messages[t].length-1]["position.latitude"],lng:this.messages[t][this.messages[t].length-1]["position.longitude"]};a&&a.lat&&a.lng&&u&&u.lat&&u.lng&&(a.lat!==u.lat||a.lng!==u.lng)&&n[n.length-1]&&this.centerOnDevice(this.selectedDeviceId,this.map.getZoom())}n.length?(this.markers[t].setLatLng(n[n.length-1]).update(),this.markers[t].accuracy.setRadius(this.getAccuracyParams(this.messages[t][this.messages[t].length-1]).accuracy),this.markers[t].accuracy.setLatLng(n[n.length-1]),this.markers[t].setOpacity(1),this.tracks[t].setLatLngs(n)):(this.removeFlags(t),this.tracks[t].tail&&this.tracks[t].tail instanceof te.Polyline&&this.tracks[t].tail.remove(),this.tracks[t].overview&&this.tracks[t].overview instanceof te.Polyline&&this.tracks[t].overview.remove(),this.markers[t].accuracy&&this.map.removeLayer(this.markers[t].accuracy),this.map.removeLayer(this.tracks[t]),this.map.removeLayer(this.markers[t]),this.tracks[t]={},this.markers[t]={color:this.markers[t].color||void 0,id:t})},updateStateByMessages(t){if(this.player.status==="play"||this.player.status==="pause")return!1;const n=Object.keys(t),a=Object.keys(this.markers);if(!n.length)return a.forEach(u=>{this.removeMarker(u)}),!1;if(n.length<a.length){const u=a.filter(r=>!n.includes(r))[0];return this.removeMarker(u),!1}n.forEach(u=>this.updateOrInitDevice(u))},updateStateByTelemetry(t){if(!this.telemetryKeys.length||!this.devicesStates[t].telemetryAccess||!this.messages||!this.messages[t]||!this.messages[t][0]||this.messages[t].lenth>1||!this.messages[t][0]["x-flespi-inited-by-telemetry"])return!1;const n=Number.parseFloat(this.telemetry["position.latitude"].value),a=Number.parseFloat(this.telemetry["position.latitude"].ts),u=Number.parseFloat(this.telemetry["position.longitude"].value),r=Number.parseFloat(this.telemetry["position.longitude"].ts);if(Math.round(a*1e3)!==Math.round(r*1e3))return console.error("Wrong telemetry"),!1;if(!this.params.needShowInvalidPositionMessages&&this.telemetry["position.valid"]&&this.telemetry["position.valid"].value===!1&&Math.abs(Number.parseFloat(this.telemetry["position.valid"].ts-a)<.1))return!1;const h={ident:this.messages[t][0].ident,"position.latitude":n,"position.longitude":u,timestamp:a},c=["direction","speed","altitude","valid","satellites","hdop","pdop"],f=["number","number","number","boolean","number","number","number"];for(let d=0;d<c.length;d++){const p="position."+c[d],g=f[d];if(this.telemetry[p]&&Math.abs(Number.parseFloat(this.telemetry[p].ts)-a)<.1)switch(g){case"number":h[p]=Number.parseFloat(this.telemetry[p].value);break;default:h[p]=this.telemetry[p].value;break}}if(Object.defineProperty(h,"x-flespi-inited-by-telemetry",{value:!0,enumerable:!1}),this.messagesStores[t].setHistoryMessages([h]),this.devicesStates[t].telemetryTail?this.devicesStates[t].telemetryTail.length>50&&this.devicesStates[t].telemetryTail.shift():this.devicesStates[t].telemetryTail=[],this.devicesStates[t].telemetryTail.push([n,u]),this.markers[t]instanceof te.Marker){const d=this.telemetry["position.direction"]&&Math.abs(Number.parseFloat(this.telemetry["position.direction"].ts))-a<.1?Number.parseInt(this.telemetry["position.direction"].value):0;this.updateMarkerDirection(t,d),this.markers[t].setLatLng([n,u]).update()}this.tracks[t]instanceof te.Polyline&&this.tracks[t].setLatLngs(this.devicesStates[t].telemetryTail),this.isSelectedDeviceFollowed&&this.centerOnDevice(this.selectedDeviceId,this.map.getZoom())},viewOnMapHandler(t){if(t["position.latitude"]&&t["position.longitude"]){const n=[t["position.latitude"],t["position.longitude"]],a=this.map.getZoom();this.map.messagePoint&&this.map.messagePoint.remove(),this.map.messagePoint=te.marker(n,{icon:te.divIcon({className:"my-round-marker-wrapper",iconSize:new te.Point(10,10),html:'<div class="my-round-marker"></div>'})}),this.map.messagePoint.addTo(this.map),this.map.setView(n,a>12?a:12,{animation:!1})}else this.$q.notify({message:"No position",color:"warning",position:"bottom-left",icon:"mdi-alert-outline"})}},watch:{activeDevices(t){const n=t.map(r=>r.id),a=Object.keys(this.messagesStores).map(r=>parseInt(r)),u=a.length>n.length?"remove":"add";switch(n.forEach(r=>this.initMessagesStoreForDevice(r)),this.activeDevicesIDs=n,u){case"remove":{a.filter(h=>!n.includes(h)).forEach(async h=>{await this.messagesStores[h].clear(),delete this.messagesStores[h],this.devicesStates[h].initStatus=null});break}case"add":{const r=n.filter(h=>!a.includes(h));r&&r.forEach(h=>{this.devicesStates[h].initStatus=!1,this.initDevice(h)});break}}this.map&&te.DomUtil.hasClass(this.map._container,"crosshair-cursor-enabled")&&te.DomUtil.removeClass(this.map._container,"crosshair-cursor-enabled")},date(){this.player.status="stop",this.player.currentMsgIndex=null,this.activeDevicesIDs.forEach(async t=>{this.devicesStates[t].initStatus===!0&&await this.getDeviceData(t)})},colorModel(t){this.updateDeviceColor(this.colorDeviceId,t)},devicesColors:{deep:!0,handler(t){this.activeDevicesIDs.forEach(n=>{this.markers[n]&&this.markers[n].color&&t[n]!==this.markers[n].color&&this.updateDeviceColorOnMap(n,t[n])})}},isSelectedDeviceFollowed(t){t===!0&&this.devicesStates[this.selectedDeviceId]&&this.devicesStates[this.selectedDeviceId].initStatus===!0&&this.centerOnDevice(this.selectedDeviceId,this.map.getZoom())},messages:{deep:!0,handler(t){this.debouncedUpdateStateByMessages(t)}},"params.needShowNamesOnMap":function(){Object.keys(this.markers).forEach(t=>{const n=this.activeDevices.filter(r=>r.id===parseInt(t))[0],a=this.messages[t]&&this.messages[t].length?[this.messages[t][this.messages[t].length-1]["position.latitude"],this.messages[t][this.messages[t].length-1]["position.longitude"]]:[],u=n.name||`#${t}`;this.markers[t]instanceof te.Marker&&(this.markers[t].remove(),this.map.removeLayer(this.markers[t].accuracy),this.initMarker(t,u,a))})},"params.needShowInvalidPositionMessages":function(){this.activeDevicesIDs.forEach(async t=>{this.devicesStates[t].initStatus===!0&&(await this.getDeviceData(t),t===this.selectedDeviceId&&this.centerOnDevice(t))})},selectedDeviceId(t){if(!this.mapIsFlying&&this.tracks[t]&&this.tracks[t]instanceof te.Polyline){const n=this.tracks[t].getBounds();this.map.fitBounds(n)}t&&this.devicesStates[t]&&this.devicesStates[t].telemetryTail&&this.devicesStates[t].telemetryTail.length>0&&(this.devicesStates[t].telemetryTail=[]),t&&this.devicesStates[t]&&this.devicesStates[t].initStatus===!0&&this.flyToDevice(t)},telemetry:{deep:!0,handler(){if(this.telemetryKeys.length===0)return;const t=parseInt(this.telemetry["device.id"].value);if(this.devicesStates[t]&&this.devicesStates[t].messagesAccess)return!1;this.debouncedUpdateStateByTelemetry(t)}}},created(){this.map=null,this.markers={},this.tracks={},this.debouncedUpdateStateByMessages=ps(this.updateStateByMessages,100),this.debouncedUpdateStateByTelemetry=ps(this.updateStateByTelemetry,5),this.activeDevicesIDs=this.activeDevices.map(t=>t.id),this.activeDevicesIDs.forEach(t=>this.initMessagesStoreForDevice(t))},mounted(){this.initMap()},unmounted(){this.$connector.socket.off("offline"),this.$connector.socket.off("connect"),this.activeDevicesIDs.forEach(async t=>{this.socketConnected===!0?await this.messagesStores[t].clear():this.messagesStores[t].resetState(),delete this.messagesStores[t],this.devicesStates[t].initStatus=null})}}),bu={class:"map-wrapper absolute-top-left absolute-bottom-right"};function wu(t,n,a,u,r,h){const c=ft("queue"),f=ft("color-modal");return N(),Re("div",bu,[ve("div",{id:"map",style:it({height:t.mapHeight})},[S(wi,{onResize:t.onResize},null,8,["onResize"])],4),S(c,{needShowMessages:t.params.needShowMessages,needShowPlayer:t.params.needShowPlayer,player:t.player,selectedDeviceId:t.selectedDeviceId,onChangeNeedShowMessages:n[0]||(n[0]=d=>{t.$emit("change-need-show-messages",d)}),onPlayerPause:n[1]||(n[1]=d=>t.playProcess(d,"pause")),onPlayerPlay:n[2]||(n[2]=d=>t.playProcess(d,"play")),onPlayerStop:n[3]||(n[3]=d=>t.playProcess(d,"stop")),onPlayerMode:t.playerModeChange,onPlayerSpeed:t.playerSpeedChangeHandler,onPlayerValue:n[4]||(n[4]=d=>t.playProcess(d,"value")),onViewOnMap:t.viewOnMapHandler},null,8,["needShowMessages","needShowPlayer","player","selectedDeviceId","onPlayerMode","onPlayerSpeed","onViewOnMap"]),S(f,{ref:"colorModal",modelValue:t.colorModel,"onUpdate:modelValue":n[5]||(n[5]=d=>t.colorModel=d)},null,8,["modelValue"])])}const ku=kt(yu,[["render",wu]]),Pu='<g transform="translate(-20,-20)"><path d="M79.9,52.6C80,51.8,80,50.9,80,50s0-1.8-0.1-2.6l-5.1-0.4c-0.3-2.4-0.9-4.6-1.8-6.7l4.2-2.9c-0.7-1.6-1.6-3.1-2.6-4.5 L70,35c-1.4-1.9-3.1-3.5-4.9-4.9l2.2-4.6c-1.4-1-2.9-1.9-4.5-2.6L59.8,27c-2.1-0.9-4.4-1.5-6.7-1.8l-0.4-5.1C51.8,20,50.9,20,50,20 s-1.8,0-2.6,0.1l-0.4,5.1c-2.4,0.3-4.6,0.9-6.7,1.8l-2.9-4.1c-1.6,0.7-3.1,1.6-4.5,2.6l2.1,4.6c-1.9,1.4-3.5,3.1-5,4.9l-4.5-2.1 c-1,1.4-1.9,2.9-2.6,4.5l4.1,2.9c-0.9,2.1-1.5,4.4-1.8,6.8l-5,0.4C20,48.2,20,49.1,20,50s0,1.8,0.1,2.6l5,0.4 c0.3,2.4,0.9,4.7,1.8,6.8l-4.1,2.9c0.7,1.6,1.6,3.1,2.6,4.5l4.5-2.1c1.4,1.9,3.1,3.5,5,4.9l-2.1,4.6c1.4,1,2.9,1.9,4.5,2.6l2.9-4.1 c2.1,0.9,4.4,1.5,6.7,1.8l0.4,5.1C48.2,80,49.1,80,50,80s1.8,0,2.6-0.1l0.4-5.1c2.3-0.3,4.6-0.9,6.7-1.8l2.9,4.2 c1.6-0.7,3.1-1.6,4.5-2.6L65,69.9c1.9-1.4,3.5-3,4.9-4.9l4.6,2.2c1-1.4,1.9-2.9,2.6-4.5L73,59.8c0.9-2.1,1.5-4.4,1.8-6.7L79.9,52.6 z M50,65c-8.3,0-15-6.7-15-15c0-8.3,6.7-15,15-15s15,6.7,15,15C65,58.3,58.3,65,50,65z" fill="currentColor"><animateTransform attributeName="transform" type="rotate" from="90 50 50" to="0 50 50" dur="1s" repeatCount="indefinite"></animateTransform></path></g><g transform="translate(20,20) rotate(15 50 50)"><path d="M79.9,52.6C80,51.8,80,50.9,80,50s0-1.8-0.1-2.6l-5.1-0.4c-0.3-2.4-0.9-4.6-1.8-6.7l4.2-2.9c-0.7-1.6-1.6-3.1-2.6-4.5 L70,35c-1.4-1.9-3.1-3.5-4.9-4.9l2.2-4.6c-1.4-1-2.9-1.9-4.5-2.6L59.8,27c-2.1-0.9-4.4-1.5-6.7-1.8l-0.4-5.1C51.8,20,50.9,20,50,20 s-1.8,0-2.6,0.1l-0.4,5.1c-2.4,0.3-4.6,0.9-6.7,1.8l-2.9-4.1c-1.6,0.7-3.1,1.6-4.5,2.6l2.1,4.6c-1.9,1.4-3.5,3.1-5,4.9l-4.5-2.1 c-1,1.4-1.9,2.9-2.6,4.5l4.1,2.9c-0.9,2.1-1.5,4.4-1.8,6.8l-5,0.4C20,48.2,20,49.1,20,50s0,1.8,0.1,2.6l5,0.4 c0.3,2.4,0.9,4.7,1.8,6.8l-4.1,2.9c0.7,1.6,1.6,3.1,2.6,4.5l4.5-2.1c1.4,1.9,3.1,3.5,5,4.9l-2.1,4.6c1.4,1,2.9,1.9,4.5,2.6l2.9-4.1 c2.1,0.9,4.4,1.5,6.7,1.8l0.4,5.1C48.2,80,49.1,80,50,80s1.8,0,2.6-0.1l0.4-5.1c2.3-0.3,4.6-0.9,6.7-1.8l2.9,4.2 c1.6-0.7,3.1-1.6,4.5-2.6L65,69.9c1.9-1.4,3.5-3,4.9-4.9l4.6,2.2c1-1.4,1.9-2.9,2.6-4.5L73,59.8c0.9-2.1,1.5-4.4,1.8-6.7L79.9,52.6 z M50,65c-8.3,0-15-6.7-15-15c0-8.3,6.7-15,15-15s15,6.7,15,15C65,58.3,58.3,65,50,65z" fill="currentColor"><animateTransform attributeName="transform" type="rotate" from="0 50 50" to="90 50 50" dur="1s" repeatCount="indefinite"></animateTransform></path></g>',Tu=bt({name:"QSpinnerGears",props:Ar,setup(t){const{cSize:n,classes:a}=Or(t);return()=>E("svg",{class:a.value,width:n.value,height:n.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg",innerHTML:Pu})}}),Lu=Pt({name:"DeviceTelemetry",emits:["diff"],props:{deviceId:{type:Number,default:0},inverted:Boolean},data(){return{filter:"",filteredTelemetry:{},history:{},prevTelemetry:{},prevTelemetryTimeout:0,showSpinner:!1}},computed:{...Rt(cn,{isLoading:t=>t.isLoading,telemetry:t=>t.telemetry,telemetryKeys:t=>t.telemetryKeys}),cls(){return this.inverted?{text:"text-white",bg:"bg-grey-9",highlight:"bg-grey-7"}:{text:"text-black",bg:"",highlight:"bg-grey-3"}},device(){const t=dt().getDeviceById(this.deviceId);return t===null?{}:t},filteredTelemetryKeys(){return Object.keys(this.filteredTelemetry)}},methods:{..._t(yt,["formatTimestampToDate","fromNow"]),copyValueHandler(t){zo(t).then(n=>{this.$q.notify({color:"positive",icon:"content_copy",message:"Value copied",timeout:1e3,position:"bottom-right"})},n=>{this.$q.notify({color:"negative",icon:"content_copy",message:"Error coping value",timeout:1e3,position:"bottom-right"})})},getDiff(){return Object.keys(this.telemetry).reduce((t,n)=>((!this.prevTelemetry[n]||this.prevTelemetry[n].value!==this.telemetry[n].value)&&(t[n]=this.telemetry[n]),t),{})},makeHistory(t){Object.keys(t).forEach(n=>{this.history[n]||(this.history[n]=[t[n]]),this.history[n].length&&this.history[n][0].value!==t[n].value&&(this.history[n].unshift(t[n]),this.history[n].length>10&&this.history[n].pop())})},setFilteredTelemetry(){if(this.filter.length===0){this.filteredTelemetry={...this.telemetry};return}if(this.filter.length<3)return;let t={...this.telemetry};const n=this.filter.toLowerCase();this.telemetryKeys.forEach(a=>{a.indexOf(n)!==-1?t[a]=this.telemetry[a]:t[a]&&delete t[a]}),this.filteredTelemetry=t},telemetryDiffHistoryProcessing(t){const n=this.getDiff();Object.keys(n).length?this.$emit("diff",n):this.$emit("diff",{...t}),this.prevTelemetryTimeout&&clearTimeout(this.prevTelemetryTimeout),this.prevTelemetryTimeout=setTimeout(()=>{this.prevTelemetry={...t},this.makeHistory(t),this.prevTelemetryTimeout=0},1e3)},telemetryProcessing(t){this.setFilteredTelemetry(),this.telemetryDiffHistoryProcessing(t)}},watch:{deviceId(){this.filteredTelemetry={},this.history={},clearTimeout(this.prevTelemetryTimeout),this.prevTelemetry={}},telemetry:{deep:!0,handler(t){this.filteredTelemetryKeys.length===0&&(this.filteredTelemetry={...this.telemetry}),this.debouncedTelemetryProcessing(t)}}},created(){this.debouncedTelemetryProcessing=ps(this.telemetryProcessing,3e3),this.telemetryKeys.length>0&&this.filteredTelemetryKeys.length===0&&this.telemetryKeys.length>0&&(this.showSpinner=!0,setTimeout(()=>{this.setFilteredTelemetry(),this.showSpinner=!1},500))}}),Cu={class:"text-center absolute-top-left bg-grey-4 text-bold text-grey-9",style:{"font-size":"10px","min-width":"55px",padding:"0 3px","z-index":"1","border-radius":"0 0 3px 0"}},Mu={key:2,style:{"text-align":"center","margin-top":"10%"}};function Su(t,n,a,u,r,h){return N(),Re(Ut,null,[t.deviceId?(N(),ae(Je,{key:0,style:{"border-top":"1px solid #ddd","min-height":"71px"}},{default:P(()=>[ve("div",Cu," #"+Be(t.deviceId),1),S(ze,{side:"",class:Oe({"text-grey-4":t.inverted})},{default:P(()=>[S(ot,{size:"1.7rem",name:"mdi-developer-board"})]),_:1},8,["class"]),S(ze,null,{default:P(()=>[S(Xe,{header:"",class:Oe(["ellipsis q-pa-none",{"text-grey-4":t.inverted}])},{default:P(()=>[X(Be(t.device.name||"<noname>")+" ",1),S(De,null,{default:P(()=>[X(Be(t.device.name||"<noname>"),1)]),_:1})]),_:1},8,["class"]),S(Xe,{caption:"",class:Oe(["ellipsis",{"text-grey-4":t.inverted}])},{default:P(()=>[S(ot,{name:"mdi-label-outline"}),X(" "+Be(t.device.configuration&&t.device.configuration.ident?t.device.configuration.ident:"<no ident>"),1)]),_:1},8,["class"]),t.device.configuration&&t.device.configuration.phone?(N(),ae(Xe,{key:0,caption:"",class:Oe({"text-grey-4":t.inverted})},{default:P(()=>[S(ot,{name:"mdi-phone"}),X(" "+Be(t.device.configuration&&t.device.configuration.phone?t.device.configuration.phone:"<no phone>"),1)]),_:1},8,["class"])):Pe("",!0)]),_:1})]),_:1})):Pe("",!0),S(Je,null,{default:P(()=>[S(ze,null,{default:P(()=>[S(Ao,{dense:"",outlined:"","hide-bottom-space":"",autocapitalize:"none",type:"text",label:"Search",modelValue:t.filter,"onUpdate:modelValue":[n[0]||(n[0]=c=>t.filter=c),t.setFilteredTelemetry],dark:t.inverted,color:t.inverted?"white":"grey",class:"q-mb-xs"},null,8,["modelValue","dark","color","onUpdate:modelValue"])]),_:1})]),_:1}),S(Hi,{separator:"","no-border":"",class:"no-padding scroll scrollable",style:{"min-height":"30vh",height:"calc(100% - 128px)"}},{default:P(()=>[t.isLoading===!1&&t.telemetryKeys.length===0?(N(),ae(Je,{key:0,class:Oe([t.cls.bg])},{default:P(()=>[S(ze,null,{default:P(()=>[S(Xe,{class:Oe(["ellipsis text-bold text-center",[t.cls.text]])},{default:P(()=>n[1]||(n[1]=[X("Telemetry is empty")])),_:1,__:[1]},8,["class"]),S(Xe,{class:Oe(["ellipsis text-center",[t.cls.text]])},{default:P(()=>n[2]||(n[2]=[X("or no access to telemetry provided")])),_:1,__:[2]},8,["class"])]),_:1})]),_:1},8,["class"])):Pe("",!0),t.isLoading===!1&&t.filteredTelemetryKeys.length===0&&this.filter?(N(),ae(Je,{key:1,class:Oe([t.cls.bg])},{default:P(()=>[S(ze,null,{default:P(()=>[S(Xe,{class:Oe(["ellipsis text-center",[t.cls.text]])},{default:P(()=>n[3]||(n[3]=[X("Nothing found on your search")])),_:1,__:[3]},8,["class"])]),_:1})]),_:1},8,["class"])):Pe("",!0),t.isLoading===!0||t.showSpinner===!0?(N(),Re("div",Mu,[S(Tu,{size:"70px",color:"white"})])):Pe("",!0),t.filteredTelemetryKeys.length?(N(),ae(Oo,{key:3,items:t.filteredTelemetryKeys,"virtual-scroll-item-size":"55","virtual-scroll-slice-ratio-after":"2","virtual-scroll-slice-ratio-before":"2"},{default:P(({item:c})=>[S(Je,{style:{transition:"all 0.5s ease-in-out"},class:Oe([!t.prevTelemetry[c]||t.prevTelemetry[c].value!==t.telemetry[c].value?t.cls.highlight:t.cls.bg])},{default:P(()=>[S(ze,null,{default:P(()=>[S(Xe,{class:Oe(["ellipsis text-bold",[t.cls.text]])},{default:P(()=>[X(Be(c)+" ",1),S(De,null,{default:P(()=>[X(Be(c),1)]),_:2},1024)]),_:2},1032,["class"]),S(Xe,{class:Oe(["ellipsis",[t.cls.text]])},{default:P(()=>[S(ot,{name:"mdi-content-copy",style:{"padding-right":"1px",cursor:"pointer"},onClick:Qt(f=>t.copyValueHandler(t.telemetry[c].value),["stop"])},{default:P(()=>[S(De,null,{default:P(()=>n[4]||(n[4]=[X("copy")])),_:1,__:[4]})]),_:2},1032,["onClick"]),ve("span",null,[X(Be(t.telemetry[c].value)+" ",1),S(De,null,{default:P(()=>[X(Be(t.telemetry[c].value),1)]),_:2},1024)])]),_:2},1032,["class"])]),_:2},1024),S(ze,{side:"",right:""},{default:P(()=>[ve("div",{class:Oe([[t.cls.text],"text-caption text-italic"])},Be(t.fromNow(t.telemetry[c].ts*1e3)),3),S(De,null,{default:P(()=>[X(Be(t.formatTimestampToDate(t.telemetry[c].ts)),1)]),_:2},1024)]),_:2},1024),S(ms,{class:"shadow-1",ref:"popovers"},{default:P(()=>[t.history[c]&&t.history[c].length?(N(),ae(Hi,{key:0,separator:"","no-border":""},{default:P(()=>[S(Je,null,{default:P(()=>[S(ze,{avatar:""},{default:P(()=>[S(ot,{size:"1.5rem",name:"history"})]),_:1}),S(ze,null,{default:P(()=>[S(Xe,{class:"ellipsis"},{default:P(()=>n[5]||(n[5]=[X("History")])),_:1,__:[5]})]),_:1})]),_:1}),(N(!0),Re(Ut,null,ni(t.history[c],(f,d)=>(N(),ae(Je,{key:d},{default:P(()=>[S(ze,null,{default:P(()=>[S(Xe,{class:"ellipsis"},{default:P(()=>[X(Be(f.value),1)]),_:2},1024)]),_:2},1024),S(ze,{side:"",class:"text-caption"},{default:P(()=>[X(Be(t.formatTimestampToDate(f.ts)),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)):Pe("",!0)]),_:2},1536)]),_:2},1032,["class"])]),_:1},8,["items"])):Pe("",!0)]),_:1})],64)}const xu=kt(Lu,[["render",Su]]),Iu=Pt({name:"MainLayout",components:{DateRangeModal:$r,DevicesList:Dl,MapContainer:ku,Telemetry:xu},data(){return{dateTheme:{color:"grey",button:{closeModal:!0,icon:"mdi-map-clock-outline",tooltip:"Reinit time by devices position"}},deviceIdForTelemetryDrawer:0,deviceIdForTelemetrySubscription:0,devicesListSettings:{opened:!1,pinned:!1},needShowList:!0,needShowTelemetry:!0,needShowDaterange:!0,needHideNamesInMenu:!1,needHidePlayerInMenu:!1,needHideMessagesInMenu:!1,needHideInvalidInMenu:!1,params:{needShowMessages:!1,needShowInvalidPositionMessages:!1,needShowNamesOnMap:!0,needShowPlayer:!0},selectedDevice:{id:null,follow:!1},telemetrySettings:{inverted:!0,opened:!1},unsubscribeDevices:()=>{},version:Br.version}},computed:{...Rt(fs,{token:t=>t.token,socketConnected:t=>t.socketConnected}),...Rt(yt,{dateInitialized:t=>t.dateInitialized,errors:t=>t.errors,newErrorsCounter:t=>t.newErrorsCounter}),...Rt(dt,{activeDevices:t=>t.devices.filter(n=>t.activeDevicesIDs.includes(n.id)),activeDevicesIDs:t=>t.activeDevicesIDs,devices:t=>t.devices,devicesColors:t=>t.devicesColors,devicesInitialized:t=>t.devicesInitialized}),dateRange:{get(){return yt().date},set(t){this.setDate(t)}}},methods:{..._t(fs,["clearToken","setToken"]),..._t(dt,["getLatestPositionTimestamp","poolDevices","setActiveDevicesIDs","unsetDevicesInitialized"]),..._t(yt,["clearErrors","getFromStore","setDate","setDateInitialized","setToStore","resetNewErrorsCounter"]),..._t(cn,["subscribeDeviceTelemetry","unsubscribeDeviceTelemetry"]),devicesListOpenedHandler(t){this.devicesListSettings.opened=t,this.setToStore({store:this.$q.localStorage,name:"devicesListSettings",value:this.devicesListSettings})},deviceInListClickHandler(){(this.$q.platform.is.mobile||!this.devicesListSettings.pinned)&&this.devicesListOpenedHandler(!1)},devicesListPinnedHandler(t){this.devicesListSettings.pinned=t,this.setToStore({store:this.$q.localStorage,name:"devicesListSettings",value:this.devicesListSettings})},exitHandler(){this.$connector.socket.off("error"),this.unsetDevicesInitialized(),this.clearToken(),this.$router.push("/login")},followSelectedDeviceHandler(t){this.updateSelectedDevice(this.selectedDevice.id,t)},initDateFromTelemetry(){this.getLatestPositionTimestamp().then(t=>{this.setDate(t),this.setDateInitialized()})},initUserSelectionsFromLS(){const t=this.getFromStore({store:this.$q.localStorage,name:"params"});t&&(this.params=t);const n=this.getFromStore({store:this.$q.localStorage,name:"telemetrySettings"});n&&(this.telemetrySettings=n);const a=this.getFromStore({store:this.$q.localStorage,name:"devicesListSettings"});a&&(this.devicesListSettings=a)},layoutCkickHandler(t){this.devicesListSettings.opened&&!t.target.closest("#left-drawer")&&!this.devicesListSettings.pinned&&this.devicesListOpenedHandler(!1)},loadActiveDevices(){const t=this.$route.params.devices;if(t){this.setActiveDevicesIDs(t.split(",").map(a=>+a));return}const n=this.getFromStore({store:this.$q.localStorage,name:"active"});n&&n.length&&this.setActiveDevicesIDs(n)},processRouteParams(){const t=this.$route.query.from,n=this.$route.query.to,a=this.$route.query.hidelist||this.getFromStore({store:this.$q.sessionStorage,name:"hidelist"}),u=this.$route.query.names||this.getFromStore({store:this.$q.sessionStorage,name:"names"}),r=this.$route.query.player||this.getFromStore({store:this.$q.sessionStorage,name:"player"}),h=this.$route.query.messages||this.getFromStore({store:this.$q.sessionStorage,name:"messages"}),c=this.$route.query.invalid||this.getFromStore({store:this.$q.sessionStorage,name:"invalid"}),f=this.$route.query.telemetry||this.getFromStore({store:this.$q.sessionStorage,name:"telemetry"}),d=this.$route.query.daterange||this.getFromStore({store:this.$q.sessionStorage,name:"daterange"});t&&n&&(this.setDate([t*1e3,n*1e3]),this.setDateInitialized()),a&&(this.setToStore({store:this.$q.sessionStorage,name:"hidelist",value:a}),this.needShowList=a!=="true"),d&&(this.setToStore({store:this.$q.sessionStorage,name:"daterange",value:d}),this.needShowDaterange=d!=="false"),f&&(this.setToStore({store:this.$q.sessionStorage,name:"telemetry",value:f}),this.needShowTelemetry=f!=="false"),u&&(this.needHideNamesInMenu=!0,this.setToStore({store:this.$q.sessionStorage,name:"names",value:u}),u==="true"?this.params.needShowNamesOnMap=!0:u==="false"&&(this.params.needShowNamesOnMap=!1),this.paramsChangeHandler()),r&&(this.needHidePlayerInMenu=!0,this.setToStore({store:this.$q.sessionStorage,name:"player",value:r}),r==="true"?this.params.needShowPlayer=!0:r==="false"&&(this.params.needShowPlayer=!1),this.paramsChangeHandler()),h&&(this.needHideMessagesInMenu=!0,this.setToStore({store:this.$q.sessionStorage,name:"messages",value:h}),h==="true"?this.params.needShowMessages=!0:h==="false"&&(this.params.needShowMessages=!1),this.paramsChangeHandler()),c&&(this.needHideInvalidInMenu=!0,this.setToStore({store:this.$q.sessionStorage,name:"invalid",value:c}),c==="true"?this.params.needShowInvalidPositionMessages=!0:c==="false"&&(this.params.needShowInvalidPositionMessages=!1),this.paramsChangeHandler())},queueCreatedHandler(){},paramsChangeHandler(){this.setToStore({store:this.$q.localStorage,name:"params",value:this.params})},selectDeviceInListHandler(t){t&&(this.updateTelemetryDeviceId(t),this.updateSelectedDevice(t,!0)),(this.$q.platform.is.mobile||!this.devicesListSettings.pinned)&&this.devicesListOpenedHandler(!1)},telemetryButtonClickHandler(){this.telemetrySettings.opened=!this.telemetrySettings.opened,this.setToStore({store:this.$q.localStorage,name:"telemetrySettings",value:this.telemetrySettings})},telemetryInvertedHandler(){this.telemetrySettings.inverted=!this.telemetrySettings.inverted,this.setToStore({store:this.$q.localStorage,name:"telemetrySettings",value:this.telemetrySettings})},updateSelectedDevice(t,n){if(this.selectedDevice.id=t,n!==void 0){this.selectedDevice.follow=n,this.setToStore({store:this.$q.localStorage,name:"selected",value:this.selectedDevice});return}const a=this.getFromStore({store:this.$q.localStorage,name:"selected"});if(!a||!a.id||a.id!==t||a.follow==null){this.selectedDevice.follow=!1,this.setToStore({store:this.$q.localStorage,name:"selected",value:this.selectedDevice});return}this.selectedDevice.follow=a.follow},manageTelemetrySubscription(t){if(t===null)return;if(t===0){this.deviceIdForTelemetrySubscription!==0&&(this.unsubscribeDeviceTelemetry(this.deviceIdForTelemetrySubscription),this.deviceIdForTelemetrySubscription=0);return}const n=dt().getDeviceById(t);if(n["x-flespi-no-access"]===!0){this.deviceIdForTelemetrySubscription!==0&&(this.unsubscribeDeviceTelemetry(this.deviceIdForTelemetrySubscription),this.deviceIdForTelemetrySubscription=0);return}if(n["x-flespi-telemetry-access"]===!0){this.deviceIdForTelemetrySubscription!==t&&(this.deviceIdForTelemetrySubscription!==0&&this.unsubscribeDeviceTelemetry(this.deviceIdForTelemetrySubscription),this.deviceIdForTelemetrySubscription=t,this.subscribeDeviceTelemetry(this.deviceIdForTelemetrySubscription));return}if(this.telemetrySettings.opened===!0){this.deviceIdForTelemetrySubscription!==t&&(this.deviceIdForTelemetrySubscription!==0&&this.unsubscribeDeviceTelemetry(this.deviceIdForTelemetrySubscription),this.deviceIdForTelemetrySubscription=t,this.subscribeDeviceTelemetry(this.deviceIdForTelemetrySubscription));return}this.deviceIdForTelemetrySubscription!==0&&(this.unsubscribeDeviceTelemetry(this.deviceIdForTelemetrySubscription),this.deviceIdForTelemetrySubscription=0)},updateTelemetryDeviceId(t,n){t!==null&&(this.manageTelemetrySubscription(t),this.deviceIdForTelemetryDrawer=this.telemetrySettings.opened?t:0,this.updateSelectedDevice(t,n))}},watch:{activeDevicesIDs:{deep:!0,handler(t){if(this.devicesInitialized){if(!t.length)this.updateTelemetryDeviceId(0);else if(!t.includes(this.selectedDevice.id)){const n=t.toSorted((r,h)=>r-h);let a=n.length-1;const u=n.findIndex(r=>r>this.selectedDevice.id);u>0&&(a=u),this.updateTelemetryDeviceId(n[a])}}}},devicesInitialized(t){if(!t)return;this.$q.loading.hide(),this.dateInitialized===!1&&this.initDateFromTelemetry();const n=this.getFromStore({store:this.$q.localStorage,name:"selected"});n&&n.id&&this.activeDevicesIDs.length&&this.activeDevicesIDs.includes(n.id)?(this.selectedDevice.id=n.id,this.selectedDevice.follow=n.follow?n.follow:!1):this.activeDevicesIDs.length&&this.updateSelectedDevice(this.activeDevicesIDs[0],!1)},devices:{deep:!0,handler(t){t.length||(this.telemetrySettings.opened=!1)}},socketConnected:{once:!0,handler(){this.socketConnected===!0&&this.devicesInitialized===!1&&this.poolDevices().then(t=>{this.unsubscribeDevices=t})}},"telemetrySettings.opened":{immediate:!0,handler(){this.updateTelemetryDeviceId(this.selectedDevice.id)}},token(t){t||(this.$q.loading.hide(),this.$router.push("/login"))}},created(){if(this.resetNewErrorsCounter(),this.clearErrors(),this.processRouteParams(),this.loadActiveDevices(),!this.token)return this.$route.params.token?this.$router.push(`/login/${this.$route.params.token}`):this.$router.push("/login"),!1;this.devicesInitialized||this.$q.loading.show(),this.initUserSelectionsFromLS(),this.socketConnected===!0&&this.poolDevices().then(t=>{this.unsubscribeDevices=t})},unmounted(){this.socketConnected===!0&&this.unsubscribeDevices&&this.unsubscribeDevices(),this.unsetDevicesInitialized(),this.socketConnected===!0&&this.deviceIdForTelemetrySubscription!==0&&(this.unsubscribeDeviceTelemetry(this.deviceIdForTelemetrySubscription),this.deviceIdForTelemetrySubscription=0),this.$connector.socket.off("connect")}}),Du={style:{position:"relative",height:"100dvh",overflow:"hidden"}},Au={class:"floated label"},Ou={class:"q-toolbar-title",style:{color:"rgb(51, 51, 51)",display:"inline-block"}},zu={key:2,class:"floated date"},Eu={key:3,class:"floated no-devices"},$u={style:{"margin-top":"15px"}},Bu={key:4,class:"floated no-devices"},Ru={class:"q-mt-sm text-bg-grey-9",style:{"font-size":"1.3rem"}},Fu={key:5,href:"https://github.com/flespi-software/TrackIt/",target:"_blank"};function qu(t,n,a,u,r,h){const c=ft("devices-list"),f=ft("telemetry"),d=ft("date-range-modal"),p=ft("map-container");return N(),ae(Kr,{ref:"layout",view:"hHh LpR lFf",onClick:Qt(t.layoutCkickHandler,["stop"])},{default:P(()=>[t.needShowList&&t.devicesInitialized&&t.devices.length?(N(),ae(fo,{key:0,persistent:"",id:"left-drawer",modelValue:t.devicesListSettings.opened,"onUpdate:modelValue":n[1]||(n[1]=g=>t.devicesListSettings.opened=g),side:"left","no-swipe-open":t.$q.platform.is.desktop,"no-swipe-close":t.$q.platform.is.desktop,breakpoint:576,overlay:!t.devicesListSettings.pinned},{default:P(()=>[bi(S(c,{activeDevicesIDs:t.activeDevicesIDs,devices:t.devices,devicesColors:t.devicesColors,devicesListPinned:t.devicesListSettings.pinned,isFollowed:t.selectedDevice.follow,selectedDeviceId:t.selectedDevice.id,onDevicesListPinned:t.devicesListPinnedHandler,onDeviceInListClicked:t.deviceInListClickHandler,onFollowSelectedDevice:t.followSelectedDeviceHandler,onSelectDevice:t.selectDeviceInListHandler,onClickHide:n[0]||(n[0]=g=>t.devicesListOpenedHandler(!1))},null,8,["activeDevicesIDs","devices","devicesColors","devicesListPinned","isFollowed","selectedDeviceId","onDevicesListPinned","onDeviceInListClicked","onFollowSelectedDevice","onSelectDevice"]),[[zr,t.devices.length]])]),_:1},8,["modelValue","no-swipe-open","no-swipe-close","overlay"])):Pe("",!0),t.needShowTelemetry?(N(),ae(fo,{key:1,"no-swipe-open":"","no-swipe-close":"",modelValue:t.telemetrySettings.opened,"onUpdate:modelValue":n[2]||(n[2]=g=>t.telemetrySettings.opened=g),side:"right",class:Oe({"bg-grey-9":t.telemetrySettings.inverted})},{default:P(()=>[ve("div",Du,[S(Je,null,{default:P(()=>[S(ze,{avatar:""},{default:P(()=>[S(je,{flat:"",round:"",small:"",icon:"mdi-chevron-right",color:t.telemetrySettings.inverted?"white":"",onClick:t.telemetryButtonClickHandler},null,8,["color","onClick"])]),_:1}),S(ze,null,{default:P(()=>[S(Xe,{header:"",class:Oe(["ellipsis text-bold q-pa-none",{"text-white":t.telemetrySettings.inverted}]),style:{"font-size":"1.3rem"}},{default:P(()=>n[12]||(n[12]=[X(" Telemetry ")])),_:1,__:[12]},8,["class"])]),_:1}),S(ze,{side:""},{default:P(()=>[S(je,{round:"",flat:"",icon:"mdi-image-filter-black-white",class:"text-grey",color:t.telemetrySettings.inverted?"white":"grey",onClick:t.telemetryInvertedHandler},{default:P(()=>[S(De,null,{default:P(()=>n[13]||(n[13]=[X("Inverted")])),_:1,__:[13]})]),_:1},8,["color","onClick"])]),_:1})]),_:1}),t.deviceIdForTelemetryDrawer?(N(),ae(f,{key:0,deviceId:t.deviceIdForTelemetryDrawer,inverted:t.telemetrySettings.inverted},null,8,["deviceId","inverted"])):(N(),ae(Je,{key:1},{default:P(()=>[S(Xe,{header:"",class:Oe(["ellipsis text-bold",{"text-white":t.telemetrySettings.inverted}]),style:{width:"100%","text-align":"center"}},{default:P(()=>n[14]||(n[14]=[X(" No selected device ")])),_:1,__:[14]},8,["class"])]),_:1}))])]),_:1},8,["modelValue","class"])):Pe("",!0),S(jr,null,{default:P(()=>[S(Gr,null,{default:P(()=>[t.devices.length&&t.needShowList?(N(),ae(je,{key:0,small:"",round:"",flat:"",color:"bg-grey-9",size:"md",class:"floated menu white-background",icon:"mdi-menu",onClick:n[3]||(n[3]=Qt(g=>t.devicesListOpenedHandler(!t.devicesListSettings.opened),["stop"]))})):Pe("",!0),ve("div",Au,[n[17]||(n[17]=ve("img",{src:"track-it-logo.png",alt:"Track it!",style:{height:"40px","margin-top":"3px",display:"inline-block"}},null,-1)),ve("div",Ou,[n[15]||(n[15]=X(" Track it! ")),ve("sup",null,Be(t.version),1),n[16]||(n[16]=ve("div",{class:"q-toolbar-subtitle"},"Find yourself",-1))])]),t.errors.length?(N(),ae(je,{key:1,small:"",flat:"",round:"",color:"bg-grey-9",size:"md",icon:"mdi-bell",class:"floated notifications white-background",onClick:t.resetNewErrorsCounter},{default:P(()=>[t.newErrorsCounter?(N(),ae(Er,{key:0,color:"red",class:"absolute-top-right q-pa-xs text-white",style:{"font-size":"0.6rem"}},{default:P(()=>[X(Be(t.newErrorsCounter),1)]),_:1})):Pe("",!0),S(ms,{fit:""},{default:P(()=>[S(Hi,{"no-border":"",link:"",separator:"",style:{"max-height":"200px"},class:"scroll"},{default:P(()=>[(N(!0),Re(Ut,null,ni(t.errors,(g,y)=>(N(),ae(Je,{key:y,style:{cursor:"default"}},{default:P(()=>[S(ze,null,{default:P(()=>[S(Xe,null,{default:P(()=>[X(Be(g),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["onClick"])):Pe("",!0),t.devices.length?(N(),Re("div",zu,[t.needShowDaterange?(N(),ae(d,{key:0,class:"on-left",modelValue:t.dateRange,"onUpdate:modelValue":n[4]||(n[4]=g=>t.dateRange=g),theme:t.dateTheme,"onClick:customButton":t.initDateFromTelemetry},null,8,["modelValue","theme","onClick:customButton"])):Pe("",!0)])):Pe("",!0),!t.activeDevicesIDs.length&&t.devices.length?(N(),Re("div",Eu,[n[19]||(n[19]=ve("span",{class:"no-devices__message"},"You have no selected devices",-1)),ve("div",$u,[S(je,{icon:"mdi-menu",style:{"pointer-events":"auto"},color:"black",size:"md",onClick:n[5]||(n[5]=Qt(g=>t.devicesListOpenedHandler(!t.devicesListSettings.opened),["stop"]))},{default:P(()=>n[18]||(n[18]=[X(" select devices ")])),_:1,__:[18]})])])):!t.devices.length&&t.devicesInitialized?(N(),Re("div",Bu,[n[21]||(n[21]=ve("span",{class:"no-devices__message"},"You have no devices",-1)),ve("div",Ru,[n[20]||(n[20]=X(" Create one on ")),S(je,{dense:"",style:{"pointer-events":"auto"},onClick:n[6]||(n[6]=g=>t.openURL("https://flespi.io")),color:"red-5",label:"flespi.io"})])])):Pe("",!0),t.$q.platform.is.desktop?(N(),Re("a",Fu,[S(je,{flat:"",round:"",color:"bg-grey-9",class:Oe([[t.needShowTelemetry?"github":"telemetry"],"floated white-background"])},{default:P(()=>[n[23]||(n[23]=ve("img",{style:{height:"30px"},src:"GitHub-Mark-32px.png",alt:"GitHub"},null,-1)),S(De,null,{default:P(()=>n[22]||(n[22]=[X("Show on GitHub")])),_:1,__:[22]})]),_:1,__:[23]},8,["class"])])):Pe("",!0),t.needShowTelemetry?(N(),ae(je,{key:6,small:"",round:"",flat:"",size:"md",icon:"mdi-list-box-outline",class:"floated telemetry white-background",onClick:t.telemetryButtonClickHandler},{default:P(()=>[S(De,null,{default:P(()=>n[24]||(n[24]=[X("Device telemetry")])),_:1,__:[24]})]),_:1},8,["onClick"])):Pe("",!0),S(je,{small:"",round:"",flat:"",size:"md",icon:"mdi-dots-vertical",class:"floated options white-background",color:"bg-grey-9"},{default:P(()=>[S(ms,null,{default:P(()=>[S(Hi,{link:"",separator:"",class:"scroll",style:{"min-width":"200px"}},{default:P(()=>[t.needHideMessagesInMenu?Pe("",!0):(N(),ae(Je,{key:0,dense:""},{default:P(()=>[S(us,{modelValue:t.params.needShowMessages,"onUpdate:modelValue":[n[7]||(n[7]=g=>t.params.needShowMessages=g),t.paramsChangeHandler],icon:"mdi-mail",label:"Messages",disable:!t.devices.length},{default:P(()=>[S(De,null,{default:P(()=>n[25]||(n[25]=[X("Show messages grid")])),_:1,__:[25]})]),_:1},8,["modelValue","disable","onUpdate:modelValue"])]),_:1})),t.needHidePlayerInMenu?Pe("",!0):(N(),ae(Je,{key:1,dense:""},{default:P(()=>[S(us,{modelValue:t.params.needShowPlayer,"onUpdate:modelValue":[n[8]||(n[8]=g=>t.params.needShowPlayer=g),t.paramsChangeHandler],icon:"mdi-play",label:"Player",disable:!t.devices.length},{default:P(()=>[S(De,null,{default:P(()=>n[26]||(n[26]=[X("Show track player")])),_:1,__:[26]})]),_:1},8,["modelValue","disable","onUpdate:modelValue"])]),_:1})),t.needHideNamesInMenu?Pe("",!0):(N(),ae(Je,{key:2,dense:""},{default:P(()=>[S(us,{modelValue:t.params.needShowNamesOnMap,"onUpdate:modelValue":[n[9]||(n[9]=g=>t.params.needShowNamesOnMap=g),t.paramsChangeHandler],icon:"mdi-map-marker-radius-outline",label:"Names",disable:!t.devices.length},{default:P(()=>[S(De,null,{default:P(()=>n[27]||(n[27]=[X("Display cars' names on the map")])),_:1,__:[27]})]),_:1},8,["modelValue","disable","onUpdate:modelValue"])]),_:1})),t.needHideInvalidInMenu?Pe("",!0):(N(),ae(Je,{key:3,dense:""},{default:P(()=>[S(us,{modelValue:t.params.needShowInvalidPositionMessages,"onUpdate:modelValue":[n[10]||(n[10]=g=>t.params.needShowInvalidPositionMessages=g),t.paramsChangeHandler],icon:"mdi-map-marker-off",label:"Draw invalid",disable:!t.devices.length},{default:P(()=>[S(De,null,{default:P(()=>n[28]||(n[28]=[X("Use messages with position.valid=false to display cars' positions on the map")])),_:1,__:[28]})]),_:1},8,["modelValue","disable","onUpdate:modelValue"])]),_:1})),S(Je,{class:"within-iframe-hide",onClick:t.exitHandler,clickable:""},{default:P(()=>[S(ze,{avatar:"",class:"q-pl-md"},{default:P(()=>[S(ot,{name:"mdi-exit-to-app"})]),_:1}),S(ze,null,{default:P(()=>[S(Xe,null,{default:P(()=>n[29]||(n[29]=[X("Exit")])),_:1,__:[29]})]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),S(p,{activeDevices:t.activeDevices,params:t.params,selectedDeviceId:t.selectedDevice.id,isSelectedDeviceFollowed:t.selectedDevice.follow,onChangeNeedShowMessages:n[11]||(n[11]=g=>{t.params.needShowMessages=g}),onUpdateTelemetryDeviceId:t.updateTelemetryDeviceId},null,8,["activeDevices","params","selectedDeviceId","isSelectedDeviceFollowed","onUpdateTelemetryDeviceId"])]),_:1})]),_:1})]),_:1},8,["onClick"])}const Vu=kt(Iu,[["render",qu]]);export{Vu as default};

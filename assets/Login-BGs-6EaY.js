import{V as L,B as q,g as N,W as z,c as a,O as W,h as d,b1 as E,an as F,d as P,aK as g,ap as f,aA as H,ar as i,f as p,as as V,aJ as S,aX as A,aw as j,ay as b}from"./index-BlREz4v3.js";const M={...L,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},k=50,x=2*k,C=x*Math.PI,O=Math.round(C*1e3)/1e3,I=q({name:"QCircularProgress",props:{...M,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:t}){const{proxy:{$q:o}}=N(),r=z(e),h=a(()=>{const n=(o.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(o.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-n}deg)`:`rotate3d(0, 0, 1, ${n-90}deg)`}}),m=a(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),s=a(()=>x/(1-e.thickness/2)),w=a(()=>`${s.value/2} ${s.value/2} ${s.value} ${s.value}`),l=a(()=>W(e.value,e.min,e.max)),v=a(()=>e.max-e.min),c=a(()=>e.thickness/2*s.value),_=a(()=>{const n=(e.max-l.value)/v.value,u=e.rounded===!0&&l.value<e.max&&n<.25?c.value/2*(1-n/.25):0;return C*n+u});function $({thickness:n,offset:u,color:y,cls:T,rounded:B}){return d("circle",{class:"q-circular-progress__"+T+(y!==void 0?` text-${y}`:""),style:m.value,fill:"transparent",stroke:"currentColor","stroke-width":n,"stroke-dasharray":O,"stroke-dashoffset":u,"stroke-linecap":B,cx:s.value,cy:s.value,r:k})}return()=>{const n=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&n.push(d("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:k-c.value/2,cx:s.value,cy:s.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&n.push($({cls:"track",thickness:c.value,offset:0,color:e.trackColor})),n.push($({cls:"circle",thickness:c.value,offset:_.value,color:e.color,rounded:e.rounded===!0?"round":void 0}));const u=[d("svg",{class:"q-circular-progress__svg",style:h.value,viewBox:w.value,"aria-hidden":"true"},n)];return e.showValue===!0&&u.push(d("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},t.default!==void 0?t.default():[d("div",l.value)])),d("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:r.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:l.value},E(t.internal,u))}}}),Q=P({name:"LoginPage",data(){return{}},computed:{...A(b,{host:function(e){return e.$region&&e.$region.rest?e.$region.rest:window.location.hostname==="localhost"?"https://localhost:9005":"https://flespi.io"},token:e=>e.token})},methods:{...S(b,["initConnection","setToken"]),...S(j,["getFromStore"]),openLoginRegisterWindow(e,t){t=t||"auth";const o=500,r=600,h=window.screenLeft!==void 0?window.screenLeft:screen.left,m=window.screenTop!==void 0?window.screenTop:screen.top,s=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,w=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,l=s/2-o/2+h,v=w/2-r/2+m,c=window.open(e,t,"toolbar=no,location=no,status=yes,resizable=yes,scrollbars=yes, width="+o+", height="+r+", top="+v+", left="+l);window.focus&&c.focus()}},watch:{$route(e){e.params&&e.params.token&&(console.log("[watch route]: token"),this.setToken(this.$route.params.token).then(()=>{this.$nextTick(()=>{this.$router.push("/")})}))}},created(){if(this.$route.params&&this.$route.params.token){console.log("[login]: route params token");const o=this.$route.params.devices?"/devices/"+this.$route.params.devices:"/";return this.setToken(this.$route.params.token).then(()=>{this.$nextTick(()=>{this.$router.push(o)})}),!0}const e=this.getFromStore({store:this.$q.sessionStorage,name:"token"});if(e)return console.log("[login]: session storage token"),this.setToken(e).then(()=>{this.$nextTick(()=>{this.$router.push("/")})}),!0;const t=o=>{if(typeof o.data=="string"&&~o.data.indexOf("FlespiLogin|token:")){let r=o.data;r=r.replace("FlespiLogin|token:",""),r=JSON.parse(r),console.log("[login]: token from login/register window"),this.setToken(r.token).then(()=>{this.$nextTick(()=>{this.$router.push("/")})}),window.removeEventListener("message",t)}};window.addEventListener("message",t)}}),R={class:"login-page window-height window-width bg-light column items-center no-wrap"},D={key:0,href:"https://github.com/flespi-software/TrackIt/",target:"_blank"},G={key:1,style:{position:"absolute",top:"50%"}},J={class:"login-card shadow-4 bg-white column items-center justify-center no-wrap"},K={class:"row full-width"},X={class:"col-12 text-center"},U={key:2},Y={class:"login-card shadow-4 bg-white column items-center justify-center no-wrap"};function Z(e,t,o,r,h,m){return f(),g("div",R,[!e.$q.platform.is.mobile||!e.$q.platform.within.iframe?(f(),g("a",D,t[1]||(t[1]=[i("img",{class:"login-github-link",src:"right-graphite@2x.png",alt:"Fork me on GitHub"},null,-1)]))):H("",!0),t[3]||(t[3]=i("div",{class:"login-back flex items-center justify-center"},[i("div",{class:"login-code flex items-center justify-center"},"Track it!")],-1)),t[4]||(t[4]=i("div",{style:{width:"100%",height:"50vh","background-color":"white"}},null,-1)),e.$route.params.token?(f(),g("div",U,[i("div",Y,[p(I,{indeterminate:"",color:"positive",style:{width:"100%",height:"45px"}})])])):(f(),g("div",G,[i("div",J,[t[2]||(t[2]=i("p",{class:"text-center"},"Track your devices on the map.",-1)),i("div",K,[i("div",X,[p(V,{rounded:"",icon:"mdi-account-circle",label:"login / register",color:"red-7",size:"lg",onClick:t[0]||(t[0]=s=>e.openLoginRegisterWindow(`${e.host}/login/#/providers`))})])])])]))])}const te=F(Q,[["render",Z]]);export{te as default};

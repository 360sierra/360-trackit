(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app"],{0:function(e,t,n){e.exports=n("2f39")},"034f":function(e,t,n){"use strict";var i=n("fb1c"),a=n.n(i);a.a},"1e5d":function(e,t,n){},"2f39":function(e,t,n){"use strict";n.r(t);n("ac6a"),n("4a91"),n("a114"),n("d14b"),n("113c"),n("1e5d"),n("7e6d");var i=n("2b0e"),a=n("e84f"),r=n("7051"),o=n("cf12"),s=n("46a9"),c=n("32a1"),l=n("f30c"),u=n("ce67"),f=n("482e"),d=n("52b5"),p=n("1180"),v=n("1e55"),h=n("506f"),g=n("b8d9"),m=n("7d43"),b=n("9541"),w=n("03d8"),k=n("363b"),y=n("0952"),D=n("5931"),I=n("5d8b"),Q=n("db18"),x=n("525b"),S=n("2a70"),C=n("ef81"),O=n("c563"),T=n("db7b"),E=n("c081"),M=n("bc9b"),q=n("b5b8"),R=n("d3e7"),j=n("895f"),_=n("cc4a"),A=n("3d5b"),L=n("6186"),N=n("94e3"),F=n("79e9"),P=n("fe4f"),$=n("4bf4"),J=n("f6fb"),V=n("f62b"),B=n("b032"),z=n("2bd2"),H=n("133b"),G=n("a9a0"),K=n("f9d8"),U=n("37c5"),W=n("6780");i["default"].use(a["a"],{config:{},components:{QLayout:r["a"],QLayoutDrawer:o["a"],QPageContainer:s["a"],QPage:c["a"],QToolbar:l["a"],QToolbarTitle:u["a"],QBtn:f["a"],QIcon:d["a"],QList:p["a"],QListHeader:v["a"],QItem:h["a"],QItemMain:g["a"],QItemSide:m["a"],QItemTile:b["a"],QTooltip:w["a"],QResizeObservable:k["a"],QModal:y["a"],QSelect:D["a"],QInput:I["a"],QKnob:Q["a"],QCheckbox:x["a"],QModalLayout:S["a"],QAlert:C["a"],QTabs:O["a"],QTab:T["a"],QTabPane:E["a"],QToggle:M["a"],QPopover:q["a"],QProgress:R["a"],QSpinnerGears:j["a"],QWindowResizeObservable:_["a"],QDatetime:A["a"],QSearch:L["a"],QSlider:N["a"],QField:F["a"],QRange:P["a"],QChip:$["a"],QColorPicker:J["a"]},directives:{TouchPan:V["a"],TouchHold:B["a"],CloseOverlay:z["a"]},plugins:{Notify:H["a"],Loading:G["a"],LocalStorage:K["a"],SessionStorage:U["a"],Dialog:W["a"]}});var X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view"),n("offline",{attrs:{logo:"../statics/trackit.png"}})],1)},Y=[],Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.$store.state.offline||e.$store.state.socketOffline?n("div",{staticClass:"offline-page window-height window-width bg-light column items-center no-wrap"},[n("div",{staticClass:"offline-back"},[n("div",{staticClass:"offline-code"}),n("div",{staticClass:"offline-line"},e._l(Array(20),function(t){return n("span",{key:t},[e._v("offline")])}))])]):e._e()},ee=[],te={name:"offline",data:function(){return{intervalId:0}},created:function(){var e=this;this.intervalId=setInterval(function(){e.$store.dispatch("checkConnection")},5e3)}},ne=te,ie=(n("85c2"),n("2877")),ae=Object(ie["a"])(ne,Z,ee,!1,null,null,null);ae.options.__file="Offline.vue";var re=ae.exports,oe={name:"App",components:{Offline:re}},se=oe,ce=(n("034f"),Object(ie["a"])(se,X,Y,!1,null,null,null));ce.options.__file="App.vue";var le=ce.exports,ue=n("2f62"),fe=(n("cadf"),n("456d"),n("448a")),de=n.n(fe),pe=(n("96cf"),n("c973")),ve=n.n(pe);function he(e){return ge.apply(this,arguments)}function ge(){return ge=ve()(regeneratorRuntime.mark(function e(t){var n,a,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.state,a=t.commit,a("reqStart"),e.prev=2,!n.token){e.next=8;break}return e.next=6,i["default"].connector.poolDevices(function(e){a("setDevices",e)},function(e,t){a("updateDevices",{type:e,device:t})});case 6:return r=e.sent,e.abrupt("return",ve()(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["default"].connector.poolDevicesStop(r);case 2:case"end":return e.stop()}},e)})));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),a("reqFailed",e.t0);case 13:case"end":return e.stop()}},e,null,[[2,10]])})),ge.apply(this,arguments)}function me(e,t){return be.apply(this,arguments)}function be(){return be=ve()(regeneratorRuntime.mark(function e(t,n){var a,r,o,s,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.state,a=t.commit,r=n.data,o=n.id,a("reqStart"),e.prev=3,e.next=6,i["default"].connector.gw.postDevicesMessages(o,r);case 6:s=e.sent,c=s.data,c.errors&&c.errors.forEach(function(e){a("addError",e.reason)}),a("reqSuccessful",{type:"postMessage",payload:c}),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](3),a("reqFailed",e.t0);case 15:case"end":return e.stop()}},e,null,[[3,12]])})),be.apply(this,arguments)}function we(e){return ke.apply(this,arguments)}function ke(){return ke=ve()(regeneratorRuntime.mark(function e(t){var n,a,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.state,a=t.commit,e.prev=1,e.next=4,i["default"].connector.http.external.get("./statics/icons/favicon-16x16.png?_=".concat((new Date).getTime()));case 4:r=e.sent,200===r.status&&n.offline&&a("setOfflineFlag",!1),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),n.offline||a("setOfflineFlag",!0);case 12:case"end":return e.stop()}},e,null,[[1,8]])})),ke.apply(this,arguments)}function ye(e,t){return De.apply(this,arguments)}function De(){return De=ve()(regeneratorRuntime.mark(function e(t,n){var a,r,o,s,c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.commit,r=t.state,o=n||r.activeDevicesID.join(","),!o){e.next=12;break}return e.next=5,i["default"].connector.gw.getDevicesTelemetry(o);case 5:return s=e.sent,c=s.data,c.errors&&me.errors.forEach(function(e){a("addError",e.reason)}),l=Math.max.apply(Math,de()(c.result.reduce(function(e,t){return e.push(t.telemetry&&t.telemetry["position.latitude"]?Math.floor(1e3*t.telemetry["position.latitude"].ts):0),e.push(t.telemetry&&t.telemetry["position.longitude"]?Math.floor(1e3*t.telemetry["position.longitude"].ts):0),e},[]))),e.abrupt("return",l-l%864e5);case 12:return e.abrupt("return",Date.now());case 13:case"end":return e.stop()}},e)})),De.apply(this,arguments)}function Ie(e,t){return Qe.apply(this,arguments)}function Qe(){return Qe=ve()(regeneratorRuntime.mark(function e(t,n){var a,r,o,s,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.commit,t.state,e.next=3,i["default"].connector.gw.getDevicesTelemetry(n);case 3:r=e.sent,o=r.data,o.errors&&me.errors.forEach(function(e){a("addError",e.reason)}),s=o&&o.result[0]&&o.result[0].telemetry?o.result[0].telemetry:{},c=Object.keys(s).reduce(function(e,t){return"position"===t?e:(e[t]=s[t].value,e)},{}),c["x-flespi-inited-by-telemetry"]=!0,a("messages/".concat(n,"/setMessages"),[c]);case 10:case"end":return e.stop()}},e)})),Qe.apply(this,arguments)}var xe={poolDevices:he,postMessage:me,checkConnection:we,getLastUpdatePosition:ye,getInitDataByDeviceId:Ie},Se=(n("4917"),n("a481"),n("f751"),n("8c4f")),Ce=[{path:"/",component:function(){return n.e("7db2bf38").then(n.bind(null,"b831"))},children:[{path:"devices/:devices",component:function(){return n.e("7db2bf38").then(n.bind(null,"b831"))}}]},{path:"/login",component:function(){return n.e("0a37bb42").then(n.bind(null,"013f"))}},{path:"/login/:token",component:function(){return n.e("0a37bb42").then(n.bind(null,"013f"))}},{path:"/login/:token/flespi",component:function(){return n.e("0a37bb42").then(n.bind(null,"013f"))}},{path:"/login/:token/devices/:devices",component:function(){return n.e("7db2bf38").then(n.bind(null,"b831"))}},{path:"*",component:function(){return n.e("4b4818b8").then(n.bind(null,"ee5d"))}}];i["default"].use(Se["a"]);var Oe=new Se["a"]({mode:"hash",base:"",scrollBehavior:function(){return{y:0}},routes:Ce}),Te=Oe;function Ee(e){0}function Me(e,t){var n=t.type,a=t.payload,r=a.result;switch(n){case"postMessage":H["a"].create({message:"Post message to devices with IDs ".concat(r," success"),type:"positive",icon:"alarm_add",timeout:2500,bgColor:"white"});break;default:JSON.stringify(e[n])!==JSON.stringify(r)&&i["default"].set(e,n,r)}}function qe(e,t){if(JSON.stringify(e.devices)!==JSON.stringify(t.data.result)&&i["default"].set(e,"devices",t.data.result),!e.hasDevicesInit)if(e.activeDevicesID.length)e.activeDevicesID.forEach(function(n){t.data.result.filter(function(e){return e.id===n}).length||Fe(e,n)}),Pe(e);else{Pe(e);var n=K["a"].get.item("TrackIt Active Devices");n&&n.length&&n.forEach(function(n){t.data.result.filter(function(e){return e.id===n}).length&&Ne(e,n)})}}function Re(e,t){switch(t.type){case"created":e.devices.push(t.device);break;case"updated":e.devices.some(function(n,i){return n.id===t.device.id&&(e.devices[i]=Object.assign(e.devices[i],t.device),!0)});break;case"deleted":e.devices.some(function(n,i){return n.id===t.device.id&&(e.devices.splice(i,1),!0)});break}}function je(e,t){if(t.response&&t.response.status)switch(t.response.status){case 0:_e(e,!0),$e(e),i["default"].set(e,"token","");break;case 401:Le(e);break;default:t.response.data&&t.response.data.errors&&t.response.data.errors.length&&t.response.data.errors.forEach(function(t){Je(e,t.reason)})}else if(t.code&&t.message)switch(t.code){case 2:case 134:case 135:e.token&&Le(e),Je(e,t.message);break}else Je(e,t.message)}function _e(e,t){i["default"].set(e,"offline",t)}function Ae(e,t){var n=t.replace("FlespiToken ","");t&&n.match(/^[a-z0-9]+$/i)?(i["default"].connector.token="FlespiToken ".concat(n),U["a"].set("currentToken",n)):(n="",i["default"].connector.token="",Le(e)),i["default"].set(e,"token",n)}function Le(e){U["a"].remove("currentToken"),i["default"].connector.token="",e.socketOffline&&Ve(e,!1),i["default"].set(e,"token","")}function Ne(e,t){e.hasDevicesInit&&!e.devices.filter(function(e){return e.id===t})[0].messages_ttl||(e.activeDevicesID.push(t),K["a"].set("TrackIt Active Devices",e.activeDevicesID),e.hasDevicesInit&&Te.push("/devices/".concat(e.activeDevicesID.join(","))))}function Fe(e,t){var n=e.activeDevicesID.indexOf(t);e.activeDevicesID.splice(n,1),K["a"].set("TrackIt Active Devices",e.activeDevicesID),e.activeDevicesID.length?Te.push("/devices/".concat(e.activeDevicesID.join(","))):Te.push("/")}function Pe(e){e.hasDevicesInit=!0}function $e(e){e.hasDevicesInit=!1,i["default"].set(e,"devices",[]),i["default"].set(e,"activeDevicesID",[])}function Je(e,t){if(!e.token)return!1;H["a"].create({type:"negative",icon:"warning",message:"".concat(t),timeout:1e3}),e.newNotificationCounter++,e.errors.push(t)}function Ve(e,t){i["default"].set(e,"socketOffline",t)}function Be(e){i["default"].set(e,"errors",[])}function ze(e){e.newNotificationCounter=0}var He={reqStart:Ee,reqSuccessful:Me,reqFailed:je,setToken:Ae,clearToken:Le,setActiveDevice:Ne,unsetActiveDevice:Fe,setDevicesInit:Pe,unsetDevicesInit:$e,setOfflineFlag:_e,updateDevices:Re,setDevices:qe,setSocketOffline:Ve,clearNotificationCounter:ze,addError:Je,clearErrors:Be},Ge={},Ke={namespaced:!0},Ue={messages:Ke};i["default"].use(ue["a"]);var We={token:"",devices:[],activeDevicesID:[],hasDevicesInit:!1,offline:!1,socketOffline:!1,isLoading:!1,newNotificationCounter:0,errors:[]},Xe=new ue["a"].Store({state:We,actions:xe,mutations:He,getters:Ge,modules:Ue}),Ye=Xe,Ze=function(){var e="function"===typeof Ye?Ye():Ye,t="function"===typeof Te?Te({store:e}):Te;e.$router=t;var n={el:"#q-app",router:t,store:e,render:function(e){return e(le)}};return{app:n,store:e,router:t}},et=n("a925"),tt={failed:"Action failed",success:"Action was successful"},nt={en:tt},it=function(e){var t=e.app,n=e.Vue;n.use(et["a"]),t.i18n=new et["a"]({locale:"en",fallbackLocale:"en",messages:nt})},at=(n("28a5"),n("6b54"),n("553c")),rt=n.n(at),ot=n("9224"),st={protocolVersion:5,wsOptions:{objectMode:!1,perMessageDeflate:!0}},ct={socketConfig:{clientId:"trackit-".concat(ot["version"],"-").concat(Math.random().toString(16).substr(2,8)),mqttSettings:st}};-1===window.location.host.indexOf("localhost:9004")&&-1===window.location.host.indexOf("localhost:9005")&&-1===window.location.host.indexOf("localhost:7004")||(ct={httpConfig:{server:"https://localhost",port:9005},socketConfig:{server:"wss://localhost:9017",clientId:"trackit-".concat(ot["version"],"-dev-").concat(Math.random().toString(16).substr(2,8)),mqttSettings:st}}),"flespi"===window.location.hash.split("/").slice(-1)[0]&&(ct={socketConfig:{clientId:"toolbox-".concat(ot["version"],"-").concat(Math.random().toString(16).substr(2,8)),mqttSettings:st}});var lt=function(e){var t=e.Vue,n=e.store;t.prototype.$flespiServer=ct.httpConfig&&ct.httpConfig.server?"".concat(ct.httpConfig.server,":").concat(ct.httpConfig.port):"https://flespi.io",t.use(rt.a,ct),t.connector.socket.on("error",function(e){n.commit("reqFailed",e)}),window&&window.addEventListener("beforeunload",function(){t.connector.socket.close(!0)})},ut=n("4eb5"),ft=n.n(ut),dt=function(e){var t=e.Vue;t.use(ft.a)},pt=Ze(),vt=pt.app,ht=pt.store,gt=pt.router;[it,lt,dt].forEach(function(e){e({app:vt,router:gt,store:ht,Vue:i["default"],ssrContext:null})}),new i["default"](vt)},"4d8e":function(e,t,n){},"7e6d":function(e,t,n){},"85c2":function(e,t,n){"use strict";var i=n("4d8e"),a=n.n(i);a.a},9224:function(e){e.exports={name:"track-it",version:"0.6.3",description:"A simple application based on flespi.io and built with Quasar and Leaflet.js. Allows tracking different devices on the map, viewing telemetry messages for these devices.",productName:"Track it!",cordovaId:"org.cordova.quasar.app",author:"Sergei Buntsevich <sebu@gurtam.com>",private:!0,scripts:{lint:"eslint --ext .js,.vue src",dev:'node ./build.js "dev -m spa" "flespi"',build:'node ./build.js "build -m spa" "flespi"',dev_local:'node ./build.js "dev -m spa" "local"',deploy:"rm -rf dist && npm run build && rm -rf deploy && mkdir deploy && cp -R dist/spa-mat/* misc LICENSE package.json deploy && cp README.md deploy/README.md && node_modules/git-directory-deploy/bin/git-directory-deploy.sh -ddeploy -bgh-pages -rhttps://git.gurtam.net/flespi/frontend/TrackIt.git && rm -rf deploy && git push github gh-pages"},dependencies:{"flespi-io-js":"git+https://github.com/flespi-software/flespi-io-js.git",leaflet:"^1.4.0",moment:"^2.24.0",qtelemetry:"git+https://github.com/flespi-software/QTelemetry.git",qvirtualscroll:"git+https://github.com/flespi-software/QVirtualScroll.git",shelljs:"^0.8.3","vue-clipboard2":"^0.2.1","vue-i18n":"^8.9.0","vue-virtual-scroll-list":"^1.3.1"},devDependencies:{"babel-eslint":"^8.2.6",eslint:"^4.19.1","eslint-config-standard":"^11.0.0","eslint-friendly-formatter":"^3.0.0","eslint-loader":"^2.1.2","eslint-plugin-import":"^2.16.0","eslint-plugin-node":"^6.0.1","eslint-plugin-promise":"^3.8.0","eslint-plugin-standard":"^3.1.0","eslint-plugin-vue":"^4.7.1","git-directory-deploy":"^1.5.1","quasar-cli":"^0.17.24","strip-ansi":"^3.0.1"},engines:{node:">= 8.9.0",npm:">= 5.6.0"},browserslist:["> 1%","last 2 versions","not ie <= 10"]}},fb1c:function(e,t,n){}},[[0,"runtime","vendor"]]]);
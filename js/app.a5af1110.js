(function(e){function t(t){for(var i,r,s=t[0],c=t[1],l=t[2],u=0,d=[];u<s.length;u++)r=s[u],o[r]&&d.push(o[r][0]),o[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);f&&f(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,r=1;r<n.length;r++){var s=n[r];0!==o[s]&&(i=!1)}i&&(a.splice(t--,1),e=c(c.s=n[0]))}return e}var i={},r={app:0},o={app:0},a=[];function s(e){return c.p+"js/"+({}[e]||e)+"."+{"0a37bb42":"f88019aa","4b4818b8":"7631b99b","62f2253e":"40d9812b"}[e]+".js"}function c(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"0a37bb42":1,"62f2253e":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise(function(t,n){for(var i="css/"+({}[e]||e)+"."+{"0a37bb42":"65b8d6f5","4b4818b8":"31d6cfe0","62f2253e":"eb92a3ff"}[e]+".css",r=c.p+i,o=document.getElementsByTagName("link"),a=0;a<o.length;a++){var s=o[a],l=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(l===i||l===r))return t()}var u=document.getElementsByTagName("style");for(a=0;a<u.length;a++){s=u[a],l=s.getAttribute("data-href");if(l===i||l===r)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var i=t&&t.target&&t.target.src||r,o=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");o.request=i,n(o)},d.href=r;var f=document.getElementsByTagName("head")[0];f.appendChild(d)}).then(function(){r[e]=0}));var i=o[e];if(0!==i)if(i)t.push(i[2]);else{var a=new Promise(function(t,n){i=o[e]=[t,n]});t.push(i[2]=a);var l,u=document.getElementsByTagName("head")[0],d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=s(e),l=function(t){d.onerror=d.onload=null,clearTimeout(f);var n=o[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src,a=new Error("Loading chunk "+e+" failed.\n("+i+": "+r+")");a.type=i,a.request=r,n[1](a)}o[e]=void 0}};var f=setTimeout(function(){l({type:"timeout",target:d})},12e4);d.onerror=d.onload=l,u.appendChild(d)}return Promise.all(t)},c.m=e,c.c=i,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)c.d(n,i,function(t){return e[t]}.bind(null,i));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var f=u;a.push([0,"vendor"]),n()})({0:function(e,t,n){e.exports=n("2f39")},"034f":function(e,t,n){"use strict";var i=n("fb1c"),r=n.n(i);r.a},"1e5d":function(e,t,n){},"2f39":function(e,t,n){"use strict";n.r(t);n("ac6a"),n("4a91"),n("a114"),n("d14b"),n("113c"),n("1e5d"),n("7e6d");var i=n("2b0e"),r=n("e84f"),o=n("7051"),a=n("cf12"),s=n("46a9"),c=n("32a1"),l=n("f30c"),u=n("ce67"),d=n("482e"),f=n("52b5"),p=n("1180"),v=n("1e55"),h=n("506f"),g=n("b8d9"),b=n("7d43"),m=n("9541"),w=n("03d8"),y=n("363b"),k=n("0952"),D=n("5931"),q=n("5d8b"),x=n("db18"),Q=n("525b"),I=n("2a70"),T=n("ef81"),S=n("c563"),O=n("db7b"),E=n("c081"),C=n("bc9b"),j=n("b5b8"),A=n("d3e7"),M=n("895f"),_=n("cc4a"),P=n("3d5b"),L=n("6186"),N=n("94e3"),R=n("79e9"),F=n("fe4f"),B=n("4bf4"),$=n("f6fb"),V=n("f62b"),J=n("b032"),z=n("2bd2"),H=n("133b"),G=n("a9a0"),K=n("f9d8"),U=n("37c5"),W=n("6780");i["default"].use(r["a"],{config:{},components:{QLayout:o["a"],QLayoutDrawer:a["a"],QPageContainer:s["a"],QPage:c["a"],QToolbar:l["a"],QToolbarTitle:u["a"],QBtn:d["a"],QIcon:f["a"],QList:p["a"],QListHeader:v["a"],QItem:h["a"],QItemMain:g["a"],QItemSide:b["a"],QItemTile:m["a"],QTooltip:w["a"],QResizeObservable:y["a"],QModal:k["a"],QSelect:D["a"],QInput:q["a"],QKnob:x["a"],QCheckbox:Q["a"],QModalLayout:I["a"],QAlert:T["a"],QTabs:S["a"],QTab:O["a"],QTabPane:E["a"],QToggle:C["a"],QPopover:j["a"],QProgress:A["a"],QSpinnerGears:M["a"],QWindowResizeObservable:_["a"],QDatetime:P["a"],QSearch:L["a"],QSlider:N["a"],QField:R["a"],QRange:F["a"],QChip:B["a"],QColorPicker:$["a"]},directives:{TouchPan:V["a"],TouchHold:J["a"],CloseOverlay:z["a"]},plugins:{Notify:H["a"],Loading:G["a"],LocalStorage:K["a"],SessionStorage:U["a"],Dialog:W["a"]}});var X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view"),n("offline",{attrs:{logo:"../statics/trackit.png"}})],1)},Y=[],Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.$store.state.offline||e.$store.state.socketOffline?n("div",{staticClass:"offline-page window-height window-width bg-light column items-center no-wrap"},[n("div",{staticClass:"offline-back"},[n("div",{staticClass:"offline-code"}),n("div",{staticClass:"offline-line"},e._l(Array(20),function(t){return n("span",{key:t},[e._v("offline")])}))])]):e._e()},ee=[],te={name:"offline",data:function(){return{intervalId:0}},created:function(){var e=this;this.intervalId=setInterval(function(){e.$store.dispatch("checkConnection")},5e3)}},ne=te,ie=(n("85c2"),n("2877")),re=Object(ie["a"])(ne,Z,ee,!1,null,null,null);re.options.__file="Offline.vue";var oe=re.exports,ae={name:"App",components:{Offline:oe}},se=ae,ce=(n("034f"),Object(ie["a"])(se,X,Y,!1,null,null,null));ce.options.__file="App.vue";var le=ce.exports,ue=n("2f62"),de=n("448a"),fe=n.n(de),pe=(n("96cf"),n("c973")),ve=n.n(pe);function he(e){return ge.apply(this,arguments)}function ge(){return ge=ve()(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.state,r=t.commit,r("reqStart"),e.prev=2,!n.token){e.next=8;break}return e.next=6,i["default"].connector.poolDevices(function(e){r("setDevices",e)},function(e,t){r("updateDevices",{type:e,device:t})});case 6:return o=e.sent,e.abrupt("return",ve()(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["default"].connector.poolDevicesStop(o);case 2:case"end":return e.stop()}},e,this)})));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),r("reqFailed",e.t0);case 13:case"end":return e.stop()}},e,this,[[2,10]])})),ge.apply(this,arguments)}function be(e,t){return me.apply(this,arguments)}function me(){return me=ve()(regeneratorRuntime.mark(function e(t,n){var r,o,a,s,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.state,r=t.commit,o=n.data,a=n.id,r("reqStart"),e.prev=3,e.next=6,i["default"].connector.gw.postDevicesMessages(a,o);case 6:s=e.sent,c=s.data,c.errors&&c.errors.forEach(function(e){r("addError",e.reason)}),r("reqSuccessful",{type:"postMessage",payload:c}),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](3),r("reqFailed",e.t0);case 15:case"end":return e.stop()}},e,this,[[3,12]])})),me.apply(this,arguments)}function we(e){return ye.apply(this,arguments)}function ye(){return ye=ve()(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.state,r=t.commit,e.prev=1,e.next=4,i["default"].connector.http.external.get("./statics/icons/favicon-16x16.png?_=".concat((new Date).getTime()));case 4:o=e.sent,200===o.status&&n.offline&&r("setOfflineFlag",!1),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),n.offline||r("setOfflineFlag",!0);case 12:case"end":return e.stop()}},e,this,[[1,8]])})),ye.apply(this,arguments)}function ke(e,t){return De.apply(this,arguments)}function De(){return De=ve()(regeneratorRuntime.mark(function e(t,n){var r,o,a,s,c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.commit,o=t.state,a=n||o.activeDevicesID.join(","),!a){e.next=12;break}return e.next=5,i["default"].connector.gw.getDevicesTelemetry(a);case 5:return s=e.sent,c=s.data,c.errors&&be.errors.forEach(function(e){r("addError",e.reason)}),l=Math.max.apply(Math,fe()(c.result.reduce(function(e,t){return e.push(t.telemetry&&t.telemetry["position.latitude"]?Math.floor(1e3*t.telemetry["position.latitude"].ts):0),e.push(t.telemetry&&t.telemetry["position.longitude"]?Math.floor(1e3*t.telemetry["position.longitude"].ts):0),e},[]))),e.abrupt("return",l-l%864e5);case 12:return e.abrupt("return",Date.now());case 13:case"end":return e.stop()}},e,this)})),De.apply(this,arguments)}var qe={poolDevices:he,postMessage:be,checkConnection:we,getLastUpdatePosition:ke},xe=(n("4917"),n("a481"),n("f751"),n("8c4f")),Qe=[{path:"/",component:function(){return n.e("62f2253e").then(n.bind(null,"b831"))},children:[{path:"devices/:devices",component:function(){return n.e("62f2253e").then(n.bind(null,"b831"))}}]},{path:"/login",component:function(){return n.e("0a37bb42").then(n.bind(null,"013f"))}},{path:"/login/:token",component:function(){return n.e("0a37bb42").then(n.bind(null,"013f"))}},{path:"/login/:token/devices/:devices",component:function(){return n.e("62f2253e").then(n.bind(null,"b831"))}},{path:"*",component:function(){return n.e("4b4818b8").then(n.bind(null,"ee5d"))}}];i["default"].use(xe["a"]);var Ie=new xe["a"]({mode:"hash",base:"",scrollBehavior:function(){return{y:0}},routes:Qe}),Te=Ie;function Se(e){0}function Oe(e,t){var n=t.type,r=t.payload,o=r.result;switch(n){case"postMessage":H["a"].create({message:"Post message to devices with IDs ".concat(o," success"),type:"positive",icon:"alarm_add",timeout:2500,bgColor:"white"});break;default:JSON.stringify(e[n])!==JSON.stringify(o)&&i["default"].set(e,n,o)}}function Ee(e,t){if(JSON.stringify(e.devices)!==JSON.stringify(t.data.result)&&i["default"].set(e,"devices",t.data.result),!e.hasDevicesInit)if(e.activeDevicesID.length)e.activeDevicesID.forEach(function(n){t.data.result.filter(function(e){return e.id===n}).length||Le(e,n)}),Ne(e);else{Ne(e);var n=K["a"].get.item("TrackIt Active Devices");n&&n.length&&n.forEach(function(n){t.data.result.filter(function(e){return e.id===n}).length&&Pe(e,n)})}}function Ce(e,t){switch(t.type){case"created":e.devices.push(t.device);break;case"updated":e.devices.some(function(n,i){return n.id===t.device.id&&(e.devices[i]=Object.assign(e.devices[i],t.device),!0)});break;case"deleted":e.devices.some(function(n,i){return n.id===t.device.id&&(e.devices.splice(i,1),!0)});break}}function je(e,t){if(t.response&&t.response.status)switch(t.response.status){case 0:Ae(e,!0),Re(e),i["default"].set(e,"token","");break;case 401:_e(e);break;default:t.response.data&&t.response.data.errors&&t.response.data.errors.length&&t.response.data.errors.forEach(function(t){Fe(e,t.reason)})}else if(t.code&&t.message)switch(t.code){case 2:e.token&&_e(e),Fe(e,t.message);break}else Fe(e,t.message)}function Ae(e,t){i["default"].set(e,"offline",t)}function Me(e,t){var n=t.replace("FlespiToken ","");t&&n.match(/^[a-z0-9]+$/i)?(i["default"].connector.token="FlespiToken ".concat(n),U["a"].set("currentToken",n)):(n="",i["default"].connector.token="",_e(e)),i["default"].set(e,"token",n)}function _e(e){U["a"].remove("currentToken"),i["default"].connector.token="",e.socketOffline&&Be(e,!1),i["default"].set(e,"token","")}function Pe(e,t){e.hasDevicesInit&&!e.devices.filter(function(e){return e.id===t})[0].messages_ttl||(e.activeDevicesID.push(t),K["a"].set("TrackIt Active Devices",e.activeDevicesID),e.hasDevicesInit&&Te.push("/devices/".concat(e.activeDevicesID.join(","))))}function Le(e,t){var n=e.activeDevicesID.indexOf(t);e.activeDevicesID.splice(n,1),K["a"].set("TrackIt Active Devices",e.activeDevicesID),e.activeDevicesID.length?Te.push("/devices/".concat(e.activeDevicesID.join(","))):Te.push("/")}function Ne(e){e.hasDevicesInit=!0}function Re(e){e.hasDevicesInit=!1,i["default"].set(e,"devices",[]),i["default"].set(e,"activeDevicesID",[])}function Fe(e,t){if(!e.token)return!1;H["a"].create({type:"negative",icon:"warning",message:"".concat(t),timeout:1e3}),e.newNotificationCounter++,e.errors.push(t)}function Be(e,t){i["default"].set(e,"socketOffline",t)}function $e(e){i["default"].set(e,"errors",[])}function Ve(e){e.newNotificationCounter=0}var Je={reqStart:Se,reqSuccessful:Oe,reqFailed:je,setToken:Me,clearToken:_e,setActiveDevice:Pe,unsetActiveDevice:Le,setDevicesInit:Ne,unsetDevicesInit:Re,setOfflineFlag:Ae,updateDevices:Ce,setDevices:Ee,setSocketOffline:Be,clearNotificationCounter:Ve,addError:Fe,clearErrors:$e},ze={},He={namespaced:!0},Ge={messages:He};i["default"].use(ue["a"]);var Ke={token:"",devices:[],activeDevicesID:[],hasDevicesInit:!1,offline:!1,socketOffline:!1,isLoading:!1,newNotificationCounter:0,errors:[]},Ue=new ue["a"].Store({state:Ke,actions:qe,mutations:Je,getters:ze,modules:Ge}),We=Ue,Xe=function(){var e="function"===typeof We?We():We,t="function"===typeof Te?Te({store:e}):Te;e.$router=t;var n={el:"#q-app",router:t,store:e,render:function(e){return e(le)}};return{app:n,store:e,router:t}},Ye=n("9483");Object(Ye["a"])("service-worker.js",{ready:function(){console.log("App is being served from cache by a service worker.")},cached:function(e){console.log("Content has been cached for offline use.")},updated:function(e){var t=document.createElement("div");t.id="sw-notification",t.innerHTML='<div style="z-index: 10000" class="q-notification-list q-notification-list-bottom fixed column items-end absolute">\n                                              <div class="q-notification">\n                                                <div class="q-alert row no-wrap shadow-2 bg-amber-9 text-white">\n                                                  <div class="q-alert-side col-auto row flex-center">\n                                                    <i aria-hidden="true" class="q-icon material-icons">warning</i>\n                                                  </div>\n                                                  <div class="q-alert-content col self-center">\n                                                    <div>The new version of TrackIt! is available. Refresh the page to update?</div>\n                                                  </div>\n                                                  <div class="q-alert-actions col-auto gutter-xs column flex-center">\n                                                    <div class="full-width">\n                                                      <button tabindex="0" class="q-btn inline relative-position q-btn-item non-selectable full-width q-btn-rectangle q-btn-flat q-focusable q-hoverable q-btn-dense">\n                                                        <div class="q-focus-helper"></div>\n                                                        <div class="q-btn-inner row col items-center justify-start">\n                                                          <div>Agree</div>\n                                                        </div>\n                                                      </button>\n                                                    </div>\n                                                    <div class="full-width">\n                                                      <button tabindex="0" class="q-btn inline relative-position q-btn-item non-selectable full-width q-btn-rectangle q-btn-flat q-focusable q-hoverable q-btn-dense">\n                                                        <div class="q-focus-helper"></div>\n                                                        <div class="q-btn-inner row col items-center justify-start">\n                                                          <div>Abort</div>\n                                                        </div>\n                                                      </button>\n                                                    </div>\n                                                  </div>\n                                                </div>\n                                              </div>\n                                            </div>';var n=t.getElementsByTagName("button"),i=document.getElementsByTagName("body")[0];n[0].addEventListener("click",function(e){window.location.reload()}),n[1].addEventListener("click",function(e){t.remove()}),i.appendChild(t)},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var Ze=n("a925"),et={failed:"Action failed",success:"Action was successful"},tt={en:et},nt=function(e){var t=e.app,n=e.Vue;n.use(Ze["a"]),t.i18n=new Ze["a"]({locale:"en",fallbackLocale:"en",messages:tt})},it=(n("6b54"),n("553c")),rt=n.n(it),ot=n("9224"),at={socketConfig:{clientId:"trackit-".concat(ot["version"],"-").concat(Math.random().toString(16).substr(2,8)),mqttSettings:{protocolVersion:5}}};-1===window.location.host.indexOf("localhost:9004")&&-1===window.location.host.indexOf("localhost:9005")&&-1===window.location.host.indexOf("localhost:7004")||(at={httpConfig:{server:"https://localhost",port:9005},socketConfig:{server:"wss://localhost:9017",clientId:"trackit-".concat(ot["version"],"-dev-").concat(Math.random().toString(16).substr(2,8)),mqttSettings:{protocolVersion:5}}});var st=function(e){var t=e.Vue,n=e.store;t.prototype.$flespiServer=at.httpConfig&&at.httpConfig.server?"".concat(at.httpConfig.server,":").concat(at.httpConfig.port):"https://flespi.io",t.use(rt.a,at),t.connector.socket.on("error",function(e){n.commit("reqFailed",e)}),window&&window.addEventListener("beforeunload",function(){t.connector.socket.close(!0)})},ct=n("4eb5"),lt=n.n(ct),ut=function(e){var t=e.Vue;t.use(lt.a)},dt=n("fe3c"),ft=n.n(dt),pt=Xe(),vt=pt.app,ht=pt.store,gt=pt.router;/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&window.navigator.standalone&&document.addEventListener("DOMContentLoaded",function(){ft.a.attach(document.body)},!1),[nt,st,ut].forEach(function(e){e({app:vt,router:gt,store:ht,Vue:i["default"],ssrContext:null})}),new i["default"](vt)},"4d8e":function(e,t,n){},"7e6d":function(e,t,n){},"85c2":function(e,t,n){"use strict";var i=n("4d8e"),r=n.n(i);r.a},9224:function(e){e.exports={name:"track-it",version:"0.5.2",description:"A simple application based on flespi.io and built with Quasar and Leaflet.js. Allows tracking different devices on the map, viewing telemetry messages for these devices.",productName:"Track it!",cordovaId:"org.cordova.quasar.app",author:"Sergei Buntsevich <sebu@gurtam.com>",private:!0,scripts:{lint:"eslint --ext .js,.vue src",dev:'node ./build.js "dev -m pwa" "flespi"',build:'node ./build.js "build -m pwa" "flespi"',dev_local:'node ./build.js "dev -m pwa" "local"',deploy:"rm -rf dist && npm run build && rm -rf deploy && mkdir deploy && cp -R dist/pwa-mat/* misc LICENSE package.json deploy && cp README.md deploy/README.md && node_modules/git-directory-deploy/bin/git-directory-deploy.sh -ddeploy -bgh-pages -rhttps://git.gurtam.net/flespi/frontend/TrackIt.git && rm -rf deploy && git push github gh-pages"},dependencies:{"flespi-io-js":"git+https://github.com/flespi-software/flespi-io-js.git",leaflet:"^1.3.4",moment:"^2.23.0",qtelemetry:"git+https://github.com/flespi-software/QTelemetry.git",qvirtualscroll:"git+https://github.com/flespi-software/QVirtualScroll.git",shelljs:"^0.8.3","vue-clipboard2":"^0.2.1","vue-i18n":"^8.6.0","vue-virtual-scroll-list":"^1.2.8"},devDependencies:{"babel-eslint":"^8.2.6",eslint:"^4.19.1","eslint-config-standard":"^11.0.0","eslint-friendly-formatter":"^3.0.0","eslint-loader":"^2.1.1","eslint-plugin-import":"^2.14.0","eslint-plugin-node":"^6.0.1","eslint-plugin-promise":"^3.8.0","eslint-plugin-standard":"^3.1.0","eslint-plugin-vue":"^4.7.1","git-directory-deploy":"^1.5.1","quasar-cli":"^0.17.22","strip-ansi":"^3.0.1"},engines:{node:">= 8.9.0",npm:">= 5.6.0"},browserslist:["> 1%","last 2 versions","not ie <= 10"]}},fb1c:function(e,t,n){}});
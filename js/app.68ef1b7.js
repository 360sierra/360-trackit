(function(e){function t(t){for(var i,r,s=t[0],c=t[1],l=t[2],u=0,d=[];u<s.length;u++)r=s[u],o[r]&&d.push(o[r][0]),o[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);f&&f(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,r=1;r<n.length;r++){var s=n[r];0!==o[s]&&(i=!1)}i&&(a.splice(t--,1),e=c(c.s=n[0]))}return e}var i={},r={2:0},o={2:0},a=[];function s(e){return c.p+"js/"+({}[e]||e)+"."+{0:"5bf52da",1:"c74f552",3:"bfa014e"}[e]+".js"}function c(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={0:1,1:1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise(function(t,n){for(var i="css/"+({}[e]||e)+"."+{0:"cdae1df4",1:"324bade9",3:"31d6cfe0"}[e]+".css",r=c.p+i,o=document.getElementsByTagName("link"),a=0;a<o.length;a++){var s=o[a],l=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(l===i||l===r))return t()}var u=document.getElementsByTagName("style");for(a=0;a<u.length;a++){s=u[a],l=s.getAttribute("data-href");if(l===i||l===r)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var i=t&&t.target&&t.target.src||r,o=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");o.request=i,n(o)},d.href=r;var f=document.getElementsByTagName("head")[0];f.appendChild(d)}).then(function(){r[e]=0}));var i=o[e];if(0!==i)if(i)t.push(i[2]);else{var a=new Promise(function(t,n){i=o[e]=[t,n]});t.push(i[2]=a);var l,u=document.getElementsByTagName("head")[0],d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=s(e),l=function(t){d.onerror=d.onload=null,clearTimeout(f);var n=o[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src,a=new Error("Loading chunk "+e+" failed.\n("+i+": "+r+")");a.type=i,a.request=r,n[1](a)}o[e]=void 0}};var f=setTimeout(function(){l({type:"timeout",target:d})},12e4);d.onerror=d.onload=l,u.appendChild(d)}return Promise.all(t)},c.m=e,c.c=i,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)c.d(n,i,function(t){return e[t]}.bind(null,i));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var f=u;a.push([0,4]),n()})({0:function(e,t,n){e.exports=n("LzkT")},"A0++":function(e,t,n){"use strict";var i=n("TOJS"),r=n.n(i);r.a},Hl11:function(e,t,n){},LzkT:function(e,t,n){"use strict";n.r(t);n("rGqo"),n("SpHO"),n("oRQL"),n("0UuB"),n("ETwY"),n("Hl11"),n("fm0S");var i=n("Kw5r"),r=n("6E/o"),o=n("cFFF"),a=n("zxLP"),s=n("Rqni"),c=n("MqH6"),l=n("8wy3"),u=n("zmdN"),d=n("SC7v"),f=n("UrUt"),p=n("EYBb"),v=n("HlXa"),h=n("UG+o"),g=n("uNnR"),m=n("fUOT"),b=n("lUGP"),w=n("A9jH"),y=n("NjtJ"),k=n("CVJq"),D=n("WTFv"),T=n("XYut"),q=n("2xiH"),x=n("UlvI"),I=n("KnAT"),S=n("74EC"),Q=n("xWPs"),E=n("23sU"),O=n("wIFj"),C=n("vJud"),j=n("tbgk"),P=n("0+dE"),A=n("iV8l"),L=n("zEqA"),R=n("PVu0"),M=n("YYYh"),F=n("lOO/"),N=n("eelU"),_=n("/k9t"),U=n("S/Rk"),B=n("9vvi"),J=n("9isa"),V=n("sDK6"),z=n("Ezub"),H=n("qaCD"),G=n("+diE"),X=n("dB3m"),$=n("Z4Cl");i["default"].use(r["a"],{config:{},components:{QLayout:o["a"],QLayoutDrawer:a["a"],QPageContainer:s["a"],QPage:c["a"],QToolbar:l["a"],QToolbarTitle:u["a"],QBtn:d["a"],QIcon:f["a"],QList:p["a"],QListHeader:v["a"],QItem:h["a"],QItemMain:g["a"],QItemSide:m["a"],QItemTile:b["a"],QTooltip:w["a"],QResizeObservable:y["a"],QModal:k["a"],QSelect:D["a"],QInput:T["a"],QKnob:q["a"],QCheckbox:x["a"],QModalLayout:I["a"],QAlert:S["a"],QTabs:Q["a"],QTab:E["a"],QTabPane:O["a"],QToggle:C["a"],QPopover:j["a"],QProgress:P["a"],QSpinnerGears:A["a"],QWindowResizeObservable:L["a"],QDatetime:R["a"],QSearch:M["a"],QSlider:F["a"],QField:N["a"],QRange:_["a"],QChip:U["a"],QColorPicker:B["a"]},directives:{TouchPan:J["a"],TouchHold:V["a"]},plugins:{Notify:z["a"],Loading:H["a"],LocalStorage:G["a"],Cookies:X["a"],Dialog:$["a"]}});var Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view"),n("offline",{attrs:{logo:"../statics/trackit.png"}})],1)},K=[],W=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.$store.state.offline||e.$store.state.socketOffline?n("div",{staticClass:"offline-page window-height window-width bg-light column items-center no-wrap"},[n("div",{staticClass:"offline-back"},[n("div",{staticClass:"offline-code"}),n("div",{staticClass:"offline-line"},e._l(Array(20),function(t){return n("span",{key:t},[e._v("offline")])}))])]):e._e()},Z=[],ee={name:"offline",data:function(){return{intervalId:0}},created:function(){var e=this;this.intervalId=setInterval(function(){e.$store.dispatch("checkConnection")},5e3)}},te=ee,ne=(n("hcIe"),n("KHd+")),ie=Object(ne["a"])(te,W,Z,!1,null,null,null),re=ie.exports,oe={name:"App",components:{Offline:re}},ae=oe,se=(n("A0++"),Object(ne["a"])(ae,Y,K,!1,null,null,null)),ce=se.exports,le=n("L2JU"),ue=n("RIqP"),de=n.n(ue),fe=(n("ls82"),n("yXPU")),pe=n.n(fe);function ve(e){return he.apply(this,arguments)}function he(){return he=pe()(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.state,r=t.commit,r("reqStart"),e.prev=2,!n.token){e.next=8;break}return e.next=6,i["default"].connector.poolDevices(function(e){r("setDevices",e)},function(e,t){r("updateDevices",{type:e,device:t})});case 6:return o=e.sent,e.abrupt("return",pe()(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["default"].connector.poolDevicesStop(o);case 2:case"end":return e.stop()}},e,this)})));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),r("reqFailed",e.t0);case 13:case"end":return e.stop()}},e,this,[[2,10]])})),he.apply(this,arguments)}function ge(e,t){return me.apply(this,arguments)}function me(){return me=pe()(regeneratorRuntime.mark(function e(t,n){var r,o,a,s,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.state,r=t.commit,o=n.data,a=n.id,r("reqStart"),e.prev=3,e.next=6,i["default"].connector.gw.postDevicesMessages(a,o);case 6:s=e.sent,c=s.data,c.errors&&c.errors.forEach(function(e){r("addError",e.reason)}),r("reqSuccessful",{type:"postMessage",payload:c}),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](3),r("reqFailed",e.t0);case 15:case"end":return e.stop()}},e,this,[[3,12]])})),me.apply(this,arguments)}function be(e){return we.apply(this,arguments)}function we(){return we=pe()(regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.state,r=t.commit,e.prev=1,e.next=4,i["default"].connector.http.external.get("./statics/icons/favicon-16x16.png?_=".concat((new Date).getTime()));case 4:o=e.sent,200===o.status&&n.offline&&r("setOfflineFlag",!1),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),n.offline||r("setOfflineFlag",!0);case 12:case"end":return e.stop()}},e,this,[[1,8]])})),we.apply(this,arguments)}function ye(e,t){return ke.apply(this,arguments)}function ke(){return ke=pe()(regeneratorRuntime.mark(function e(t,n){var r,o,a,s,c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.commit,o=t.state,a=n||o.activeDevicesID.join(","),!a){e.next=12;break}return e.next=5,i["default"].connector.gw.getDevicesTelemetry(a);case 5:return s=e.sent,c=s.data,c.errors&&ge.errors.forEach(function(e){r("addError",e.reason)}),l=Math.max.apply(Math,de()(c.result.reduce(function(e,t){return e.push(t.telemetry&&t.telemetry["position.latitude"]?Math.floor(1e3*t.telemetry["position.latitude"].ts):0),e.push(t.telemetry&&t.telemetry["position.longitude"]?Math.floor(1e3*t.telemetry["position.longitude"].ts):0),e},[]))),e.abrupt("return",l-l%864e5);case 12:return e.abrupt("return",Date.now());case 13:case"end":return e.stop()}},e,this)})),ke.apply(this,arguments)}var De={poolDevices:ve,postMessage:ge,checkConnection:be,getLastUpdatePosition:ye},Te=(n("SRfc"),n("pIFo"),n("91GP"),n("jE9Z")),qe=[{path:"/",component:function(){return n.e(0).then(n.bind(null,"uDGt"))},children:[{path:"devices/:devices",component:function(){return n.e(0).then(n.bind(null,"uDGt"))}}]},{path:"/login",component:function(){return n.e(1).then(n.bind(null,"AT+L"))}},{path:"/login/:token",component:function(){return n.e(1).then(n.bind(null,"AT+L"))}},{path:"/login/:token/devices/:devices",component:function(){return n.e(0).then(n.bind(null,"uDGt"))}},{path:"*",component:function(){return n.e(3).then(n.bind(null,"7l0S"))}}];i["default"].use(Te["a"]);var xe=new Te["a"]({mode:"hash",base:"",scrollBehavior:function(){return{y:0}},routes:qe}),Ie=xe;function Se(e){0}function Qe(e,t){var n=t.type,r=t.payload,o=r.result;switch(n){case"postMessage":z["a"].create({message:"Post message to devices with IDs ".concat(o," success"),type:"positive",icon:"alarm_add",timeout:2500,bgColor:"white"});break;default:JSON.stringify(e[n])!==JSON.stringify(o)&&i["default"].set(e,n,o)}}function Ee(e,t){if(JSON.stringify(e.devices)!==JSON.stringify(t.data.result)&&i["default"].set(e,"devices",t.data.result),!e.hasDevicesInit)if(e.activeDevicesID.length)e.activeDevicesID.forEach(function(n){t.data.result.filter(function(e){return e.id===n}).length||Re(e,n)}),Me(e);else{Me(e);var n=G["a"].get.item("TrackIt Active Devices");n&&n.length&&n.forEach(function(n){t.data.result.filter(function(e){return e.id===n}).length&&Le(e,n)})}}function Oe(e,t){switch(t.type){case"created":e.devices.push(t.device);break;case"updated":e.devices.some(function(n,i){return n.id===t.device.id&&(e.devices[i]=Object.assign(e.devices[i],t.device),!0)});break;case"deleted":e.devices.some(function(n,i){return n.id===t.device.id&&(e.devices.splice(i,1),!0)});break}}function Ce(e,t){if(t.response&&t.response.status)switch(t.response.status){case 0:je(e,!0),Fe(e),i["default"].set(e,"token","");break;case 401:Ae(e);break;default:t.response.data&&t.response.data.errors&&t.response.data.errors.length&&t.response.data.errors.forEach(function(t){Ne(e,t.reason)})}else if(t.code&&t.message)switch(t.code){case 2:e.token&&Ae(e),Ne(e,t.message);break}else Ne(e,t.message)}function je(e,t){i["default"].set(e,"offline",t)}function Pe(e,t){var n=t.replace("FlespiToken ","");t&&n.match(/^[a-z0-9]+$/i)?(i["default"].connector.token="FlespiToken ".concat(n),G["a"].set("X-Flespi-Token",n)):(n="",i["default"].connector.token="",Ae(e)),i["default"].set(e,"token",n)}function Ae(e){var t=X["a"].get("X-Flespi-Token"),n=G["a"].get.item("X-Flespi-Token");t&&n&&t===n&&X["a"].remove("X-Flespi-Token"),G["a"].remove("X-Flespi-Token"),i["default"].connector.token="",e.socketOffline&&_e(e,!1),i["default"].set(e,"token","")}function Le(e,t){e.hasDevicesInit&&!e.devices.filter(function(e){return e.id===t})[0].messages_ttl||(e.activeDevicesID.push(t),G["a"].set("TrackIt Active Devices",e.activeDevicesID),e.hasDevicesInit&&Ie.push("/devices/".concat(e.activeDevicesID.join(","))))}function Re(e,t){var n=e.activeDevicesID.indexOf(t);e.activeDevicesID.splice(n,1),G["a"].set("TrackIt Active Devices",e.activeDevicesID),e.activeDevicesID.length?Ie.push("/devices/".concat(e.activeDevicesID.join(","))):Ie.push("/")}function Me(e){e.hasDevicesInit=!0}function Fe(e){e.hasDevicesInit=!1,i["default"].set(e,"devices",[]),i["default"].set(e,"activeDevicesID",[])}function Ne(e,t){z["a"].create({type:"negative",icon:"warning",message:"".concat(t),timeout:1e3}),e.newNotificationCounter++,e.errors.push(t)}function _e(e,t){i["default"].set(e,"socketOffline",t)}function Ue(e){i["default"].set(e,"errors",[])}function Be(e){e.newNotificationCounter=0}var Je={reqStart:Se,reqSuccessful:Qe,reqFailed:Ce,setToken:Pe,clearToken:Ae,setActiveDevice:Le,unsetActiveDevice:Re,setDevicesInit:Me,unsetDevicesInit:Fe,setOfflineFlag:je,updateDevices:Oe,setDevices:Ee,setSocketOffline:_e,clearNotificationCounter:Be,addError:Ne,clearErrors:Ue},Ve={},ze={namespaced:!0},He={messages:ze};i["default"].use(le["a"]);var Ge={token:"",devices:[],activeDevicesID:[],hasDevicesInit:!1,offline:!1,socketOffline:!1,isLoading:!1,newNotificationCounter:0,errors:[]},Xe=new le["a"].Store({state:Ge,actions:De,mutations:Je,getters:Ve,modules:He}),$e=Xe,Ye=function(){var e="function"===typeof $e?$e():$e,t="function"===typeof Ie?Ie({store:e}):Ie;e.$router=t;var n={el:"#q-app",router:t,store:e,render:function(e){return e(ce)}};return{app:n,store:e,router:t}},Ke=n("lIOY");Object(Ke["a"])("service-worker.js",{ready:function(){console.log("App is being served from cache by a service worker.")},cached:function(e){console.log("Content has been cached for offline use.")},updated:function(e){var t=document.createElement("div");t.id="sw-notification",t.innerHTML='<div style="z-index: 10000" class="q-notification-list q-notification-list-bottom fixed column items-end absolute">\n                                              <div class="q-notification">\n                                                <div class="q-alert row no-wrap shadow-2 bg-amber-9 text-white">\n                                                  <div class="q-alert-side col-auto row flex-center">\n                                                    <i aria-hidden="true" class="q-icon material-icons">warning</i>\n                                                  </div>\n                                                  <div class="q-alert-content col self-center">\n                                                    <div>The new version of TrackIt! is available. Refresh the page to update?</div>\n                                                  </div>\n                                                  <div class="q-alert-actions col-auto gutter-xs column flex-center">\n                                                    <div class="full-width">\n                                                      <button tabindex="0" class="q-btn inline relative-position q-btn-item non-selectable full-width q-btn-rectangle q-btn-flat q-focusable q-hoverable q-btn-dense">\n                                                        <div class="q-focus-helper"></div>\n                                                        <div class="q-btn-inner row col items-center justify-start">\n                                                          <div>Agree</div>\n                                                        </div>\n                                                      </button>\n                                                    </div>\n                                                    <div class="full-width">\n                                                      <button tabindex="0" class="q-btn inline relative-position q-btn-item non-selectable full-width q-btn-rectangle q-btn-flat q-focusable q-hoverable q-btn-dense">\n                                                        <div class="q-focus-helper"></div>\n                                                        <div class="q-btn-inner row col items-center justify-start">\n                                                          <div>Abort</div>\n                                                        </div>\n                                                      </button>\n                                                    </div>\n                                                  </div>\n                                                </div>\n                                              </div>\n                                            </div>';var n=t.getElementsByTagName("button"),i=document.getElementsByTagName("body")[0];n[0].addEventListener("click",function(e){window.location.reload()}),n[1].addEventListener("click",function(e){t.remove()}),i.appendChild(t)},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var We=n("qSUR"),Ze={failed:"Action failed",success:"Action was successful"},et={en:Ze},tt=function(e){var t=e.app,n=e.Vue;n.use(We["a"]),t.i18n=new We["a"]({locale:"en",fallbackLocale:"en",messages:et})},nt=(n("a1Th"),n("VTyJ")),it=n.n(nt),rt=n("kiQV"),ot={socketConfig:{clientId:"trackit-".concat(rt["version"],"-").concat(Math.random().toString(16).substr(2,8)),mqttSettings:{protocolVersion:5}}};-1===window.location.host.indexOf("localhost:9004")&&-1===window.location.host.indexOf("localhost:9005")&&-1===window.location.host.indexOf("localhost:7004")||(ot={httpConfig:{server:"https://localhost",port:9005},socketConfig:{server:"wss://localhost:9017",clientId:"trackit-".concat(rt["version"],"-dev-").concat(Math.random().toString(16).substr(2,8)),mqttSettings:{protocolVersion:5}}});var at=function(e){var t=e.Vue,n=e.store;t.prototype.$flespiServer=ot.httpConfig&&ot.httpConfig.server?"".concat(ot.httpConfig.server,":").concat(ot.httpConfig.port):"https://flespi.io",t.use(it.a,ot),t.connector.socket.on("error",function(e){n.commit("reqFailed",e)}),window&&window.addEventListener("beforeunload",function(){t.connector.socket.close(!0)})},st=n("TrUB"),ct=n.n(st),lt=function(e){var t=e.Vue;t.use(ct.a)},ut=n("/jzl"),dt=n.n(ut),ft=Ye(),pt=ft.app,vt=ft.store,ht=ft.router;/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&window.navigator.standalone&&document.addEventListener("DOMContentLoaded",function(){dt.a.attach(document.body)},!1),[tt,at,lt].forEach(function(e){e({app:pt,router:ht,store:vt,Vue:i["default"],ssrContext:null})}),new i["default"](pt)},TOJS:function(e,t,n){},fm0S:function(e,t,n){},hcIe:function(e,t,n){"use strict";var i=n("mPPx"),r=n.n(i);r.a},kiQV:function(e){e.exports={name:"track-it",version:"0.4.29",description:"A simple application based on flespi.io and built with Quasar and Leaflet.js. Allows tracking different devices on the map, viewing telemetry messages for these devices.",productName:"Track it!",cordovaId:"org.cordova.quasar.app",author:"Sergei Buntsevich <sebu@gurtam.com>",private:!0,scripts:{lint:"eslint --ext .js,.vue src",dev:'node ./build.js "dev -m pwa" "flespi"',build:'node ./build.js "build -m pwa" "flespi"',dev_local:'node ./build.js "dev -m pwa" "local"',deploy:"rm -rf dist && npm run build && rm -rf deploy && mkdir deploy && cp -R dist/pwa-mat/* misc LICENSE package.json deploy && cp README.md deploy/README.md && node_modules/git-directory-deploy/bin/git-directory-deploy.sh -ddeploy -bgh-pages -rhttps://git.gurtam.net/flespi/frontend/TrackIt.git && rm -rf deploy && git push github gh-pages"},dependencies:{"flespi-io-js":"git+https://github.com/flespi-software/flespi-io-js.git",leaflet:"^1.3.4",moment:"^2.22.2",qtelemetry:"git+https://github.com/flespi-software/QTelemetry.git",qvirtualscroll:"git+https://github.com/flespi-software/QVirtualScroll.git",shelljs:"^0.8.2","vue-clipboard2":"^0.2.1","vue-i18n":"^8.0.0","vue-virtual-scroll-list":"^1.2.8"},devDependencies:{"babel-eslint":"^8.2.6",eslint:"^4.19.1","eslint-config-standard":"^11.0.0","eslint-friendly-formatter":"^3.0.0","eslint-loader":"^2.1.0","eslint-plugin-import":"^2.14.0","eslint-plugin-node":"^6.0.1","eslint-plugin-promise":"^3.8.0","eslint-plugin-standard":"^3.1.0","eslint-plugin-vue":"^4.7.1","git-directory-deploy":"^1.5.1","quasar-cli":"^0.17.13","strip-ansi":"^3.0.1"},engines:{node:">= 8.9.0",npm:">= 5.6.0"},browserslist:["> 1%","last 2 versions","not ie <= 10"]}},mPPx:function(e,t,n){}});